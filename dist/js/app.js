class Ai{constructor(){this.listeners={}}on(e,n){typeof e=="string"&&(e=[e]),e.forEach(a=>{this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(n)})}once(e,n){typeof e=="string"&&(e=[e]);const a=(...r)=>{n(...r),this.off(e,a)};this.on(e,a)}off(e,n){typeof e=="string"&&(e=[e]),e.forEach(a=>{this.listeners[a]&&(this.listeners[a]=this.listeners[a].filter(r=>r!==n))})}emit(e,n){this.listeners[e]&&this.listeners[e].forEach(a=>{try{a(n)}catch(r){console.error(`Error in event listener for '${e}':`,r)}})}listeners(e){return this.listeners[e]||[]}hasListeners(e){return(this.listeners[e]||[]).length>0}flush(e){e?this.listeners[e]=[]:this.listeners={}}}const xe=new Ai;/*!
 * perfect-scrollbar v1.5.6
 * Copyright 2024 Hyunje Jun, MDBootstrap and Contributors
 * Licensed under MIT
 */function Ie(t){return getComputedStyle(t)}function ve(t,e){for(var n in e){var a=e[n];typeof a=="number"&&(a=a+"px"),t.style[n]=a}return t}function Ut(t){var e=document.createElement("div");return e.className=t,e}var Aa=typeof Element<"u"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function Ke(t,e){if(!Aa)throw new Error("No element matching method supported");return Aa.call(t,e)}function pt(t){t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)}function Ca(t,e){return Array.prototype.filter.call(t.children,function(n){return Ke(n,e)})}var ne={main:"ps",rtl:"ps__rtl",element:{thumb:function(t){return"ps__thumb-"+t},rail:function(t){return"ps__rail-"+t},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(t){return"ps--active-"+t},scrolling:function(t){return"ps--scrolling-"+t}}},mr={x:null,y:null};function gr(t,e){var n=t.element.classList,a=ne.state.scrolling(e);n.contains(a)?clearTimeout(mr[e]):n.add(a)}function vr(t,e){mr[e]=setTimeout(function(){return t.isAlive&&t.element.classList.remove(ne.state.scrolling(e))},t.settings.scrollingThreshold)}function Ci(t,e){gr(t,e),vr(t,e)}var Yt=function(e){this.element=e,this.handlers={}},yr={isEmpty:{configurable:!0}};Yt.prototype.bind=function(e,n){typeof this.handlers[e]>"u"&&(this.handlers[e]=[]),this.handlers[e].push(n),this.element.addEventListener(e,n,!1)};Yt.prototype.unbind=function(e,n){var a=this;this.handlers[e]=this.handlers[e].filter(function(r){return n&&r!==n?!0:(a.element.removeEventListener(e,r,!1),!1)})};Yt.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)};yr.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return t.handlers[e].length===0})};Object.defineProperties(Yt.prototype,yr);var St=function(){this.eventElements=[]};St.prototype.eventElement=function(e){var n=this.eventElements.filter(function(a){return a.element===e})[0];return n||(n=new Yt(e),this.eventElements.push(n)),n};St.prototype.bind=function(e,n,a){this.eventElement(e).bind(n,a)};St.prototype.unbind=function(e,n,a){var r=this.eventElement(e);r.unbind(n,a),r.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(r),1)};St.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]};St.prototype.once=function(e,n,a){var r=this.eventElement(e),i=function(o){r.unbind(n,i),a(o)};r.bind(n,i)};function Kt(t){if(typeof window.CustomEvent=="function")return new CustomEvent(t);var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,void 0),e}function cn(t,e,n,a,r){a===void 0&&(a=!0),r===void 0&&(r=!1);var i;if(e==="top")i=["contentHeight","containerHeight","scrollTop","y","up","down"];else if(e==="left")i=["contentWidth","containerWidth","scrollLeft","x","left","right"];else throw new Error("A proper axis should be provided");_i(t,n,i,a,r)}function _i(t,e,n,a,r){var i=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5];a===void 0&&(a=!0),r===void 0&&(r=!1);var d=t.element;t.reach[l]=null,d[s]<1&&(t.reach[l]="start"),d[s]>t[i]-t[o]-1&&(t.reach[l]="end"),e&&(d.dispatchEvent(Kt("ps-scroll-"+l)),e<0?d.dispatchEvent(Kt("ps-scroll-"+c)):e>0&&d.dispatchEvent(Kt("ps-scroll-"+u)),a&&Ci(t,l)),t.reach[l]&&(e||r)&&d.dispatchEvent(Kt("ps-"+l+"-reach-"+t.reach[l]))}function G(t){return parseInt(t,10)||0}function Li(t){return Ke(t,"input,[contenteditable]")||Ke(t,"select,[contenteditable]")||Ke(t,"textarea,[contenteditable]")||Ke(t,"button,[contenteditable]")}function Di(t){var e=Ie(t);return G(e.width)+G(e.paddingLeft)+G(e.paddingRight)+G(e.borderLeftWidth)+G(e.borderRightWidth)}var ft={isWebKit:typeof document<"u"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window<"u"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator<"u"&&navigator.msMaxTouchPoints,isChrome:typeof navigator<"u"&&/Chrome/i.test(navigator&&navigator.userAgent)};function $e(t){var e=t.element,n=Math.floor(e.scrollTop),a=e.getBoundingClientRect();t.containerWidth=Math.floor(a.width),t.containerHeight=Math.floor(a.height),t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,e.contains(t.scrollbarXRail)||(Ca(e,ne.element.rail("x")).forEach(function(r){return pt(r)}),e.appendChild(t.scrollbarXRail)),e.contains(t.scrollbarYRail)||(Ca(e,ne.element.rail("y")).forEach(function(r){return pt(r)}),e.appendChild(t.scrollbarYRail)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=_a(t,G(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=G((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=_a(t,G(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=G(n*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),Mi(e,t),t.scrollbarXActive?e.classList.add(ne.state.active("x")):(e.classList.remove(ne.state.active("x")),t.scrollbarXWidth=0,t.scrollbarXLeft=0,e.scrollLeft=t.isRtl===!0?t.contentWidth:0),t.scrollbarYActive?e.classList.add(ne.state.active("y")):(e.classList.remove(ne.state.active("y")),t.scrollbarYHeight=0,t.scrollbarYTop=0,e.scrollTop=0)}function _a(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}function Mi(t,e){var n={width:e.railXWidth},a=Math.floor(t.scrollTop);e.isRtl?n.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth-e.contentWidth:n.left=t.scrollLeft,e.isScrollbarXUsingBottom?n.bottom=e.scrollbarXBottom-a:n.top=e.scrollbarXTop+a,ve(e.scrollbarXRail,n);var r={top:a,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?r.right=e.contentWidth-(e.negativeScrollAdjustment+t.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth-9:r.right=e.scrollbarYRight-t.scrollLeft:e.isRtl?r.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth*2-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:r.left=e.scrollbarYLeft+t.scrollLeft,ve(e.scrollbarYRail,r),ve(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),ve(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}function Oi(t){t.event.bind(t.scrollbarY,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarYRail,"mousedown",function(e){var n=e.pageY-window.pageYOffset-t.scrollbarYRail.getBoundingClientRect().top,a=n>t.scrollbarYTop?1:-1;t.element.scrollTop+=a*t.containerHeight,$e(t),e.stopPropagation()}),t.event.bind(t.scrollbarX,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarXRail,"mousedown",function(e){var n=e.pageX-window.pageXOffset-t.scrollbarXRail.getBoundingClientRect().left,a=n>t.scrollbarXLeft?1:-1;t.element.scrollLeft+=a*t.containerWidth,$e(t),e.stopPropagation()})}var Vt=null;function Ii(t){La(t,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"]),La(t,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"])}function La(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=t.element,f=null,h=null,m=null;function v(b){b.touches&&b.touches[0]&&(b[r]=b.touches[0]["page"+c.toUpperCase()]),Vt===o&&(d[l]=f+m*(b[r]-h),gr(t,c),$e(t),b.stopPropagation(),b.preventDefault())}function w(){vr(t,c),t[u].classList.remove(ne.state.clicking),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",w),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",w),Vt=null}function _(b){Vt===null&&(Vt=o,f=d[l],b.touches&&(b[r]=b.touches[0]["page"+c.toUpperCase()]),h=b[r],m=(t[a]-t[n])/(t[i]-t[s]),b.touches?(document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",w)):(document.addEventListener("mousemove",v),document.addEventListener("mouseup",w)),t[u].classList.add(ne.state.clicking)),b.stopPropagation(),b.cancelable&&b.preventDefault()}t[o].addEventListener("mousedown",_),t[o].addEventListener("touchstart",_)}function ki(t){var e=t.element,n=function(){return Ke(e,":hover")},a=function(){return Ke(t.scrollbarX,":focus")||Ke(t.scrollbarY,":focus")};function r(i,o){var s=Math.floor(e.scrollTop);if(i===0){if(!t.scrollbarYActive)return!1;if(s===0&&o>0||s>=t.contentHeight-t.containerHeight&&o<0)return!t.settings.wheelPropagation}var l=e.scrollLeft;if(o===0){if(!t.scrollbarXActive)return!1;if(l===0&&i<0||l>=t.contentWidth-t.containerWidth&&i>0)return!t.settings.wheelPropagation}return!0}t.event.bind(t.ownerDocument,"keydown",function(i){if(!(i.isDefaultPrevented&&i.isDefaultPrevented()||i.defaultPrevented)&&!(!n()&&!a())){var o=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(o){if(o.tagName==="IFRAME")o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(Li(o))return}var s=0,l=0;switch(i.which){case 37:i.metaKey?s=-t.contentWidth:i.altKey?s=-t.containerWidth:s=-30;break;case 38:i.metaKey?l=t.contentHeight:i.altKey?l=t.containerHeight:l=30;break;case 39:i.metaKey?s=t.contentWidth:i.altKey?s=t.containerWidth:s=30;break;case 40:i.metaKey?l=-t.contentHeight:i.altKey?l=-t.containerHeight:l=-30;break;case 32:i.shiftKey?l=t.containerHeight:l=-t.containerHeight;break;case 33:l=t.containerHeight;break;case 34:l=-t.containerHeight;break;case 36:l=t.contentHeight;break;case 35:l=-t.contentHeight;break;default:return}t.settings.suppressScrollX&&s!==0||t.settings.suppressScrollY&&l!==0||(e.scrollTop-=l,e.scrollLeft+=s,$e(t),r(s,l)&&i.preventDefault())}})}function qi(t){var e=t.element;function n(o,s){var l=Math.floor(e.scrollTop),c=e.scrollTop===0,u=l+e.offsetHeight===e.scrollHeight,d=e.scrollLeft===0,f=e.scrollLeft+e.offsetWidth===e.scrollWidth,h;return Math.abs(s)>Math.abs(o)?h=c||u:h=d||f,h?!t.settings.wheelPropagation:!0}function a(o){var s=o.deltaX,l=-1*o.deltaY;return(typeof s>"u"||typeof l>"u")&&(s=-1*o.wheelDeltaX/6,l=o.wheelDeltaY/6),o.deltaMode&&o.deltaMode===1&&(s*=10,l*=10),s!==s&&l!==l&&(s=0,l=o.wheelDelta),o.shiftKey?[-l,-s]:[s,l]}function r(o,s,l){if(!ft.isWebKit&&e.querySelector("select:focus"))return!0;if(!e.contains(o))return!1;for(var c=o;c&&c!==e;){if(c.classList.contains(ne.element.consuming))return!0;var u=Ie(c);if(l&&u.overflowY.match(/(scroll|auto)/)){var d=c.scrollHeight-c.clientHeight;if(d>0&&(c.scrollTop>0&&l<0||c.scrollTop<d&&l>0))return!0}if(s&&u.overflowX.match(/(scroll|auto)/)){var f=c.scrollWidth-c.clientWidth;if(f>0&&(c.scrollLeft>0&&s<0||c.scrollLeft<f&&s>0))return!0}c=c.parentNode}return!1}function i(o){var s=a(o),l=s[0],c=s[1];if(!r(o.target,l,c)){var u=!1;t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(c?e.scrollTop-=c*t.settings.wheelSpeed:e.scrollTop+=l*t.settings.wheelSpeed,u=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(l?e.scrollLeft+=l*t.settings.wheelSpeed:e.scrollLeft-=c*t.settings.wheelSpeed,u=!0):(e.scrollTop-=c*t.settings.wheelSpeed,e.scrollLeft+=l*t.settings.wheelSpeed),$e(t),u=u||n(l,c),u&&!o.ctrlKey&&(o.stopPropagation(),o.preventDefault())}}typeof window.onwheel<"u"?t.event.bind(e,"wheel",i):typeof window.onmousewheel<"u"&&t.event.bind(e,"mousewheel",i)}function Pi(t){if(!ft.supportsTouch&&!ft.supportsIePointer)return;var e=t.element,n={startOffset:{},startTime:0,speed:{},easingLoop:null};function a(d,f){var h=Math.floor(e.scrollTop),m=e.scrollLeft,v=Math.abs(d),w=Math.abs(f);if(w>v){if(f<0&&h===t.contentHeight-t.containerHeight||f>0&&h===0)return window.scrollY===0&&f>0&&ft.isChrome}else if(v>w&&(d<0&&m===t.contentWidth-t.containerWidth||d>0&&m===0))return!0;return!0}function r(d,f){e.scrollTop-=f,e.scrollLeft-=d,$e(t)}function i(d){return d.targetTouches?d.targetTouches[0]:d}function o(d){return d.target===t.scrollbarX||d.target===t.scrollbarY||d.pointerType&&d.pointerType==="pen"&&d.buttons===0?!1:!!(d.targetTouches&&d.targetTouches.length===1||d.pointerType&&d.pointerType!=="mouse"&&d.pointerType!==d.MSPOINTER_TYPE_MOUSE)}function s(d){if(o(d)){var f=i(d);n.startOffset.pageX=f.pageX,n.startOffset.pageY=f.pageY,n.startTime=new Date().getTime(),n.easingLoop!==null&&clearInterval(n.easingLoop)}}function l(d,f,h){if(!e.contains(d))return!1;for(var m=d;m&&m!==e;){if(m.classList.contains(ne.element.consuming))return!0;var v=Ie(m);if(h&&v.overflowY.match(/(scroll|auto)/)){var w=m.scrollHeight-m.clientHeight;if(w>0&&(m.scrollTop>0&&h<0||m.scrollTop<w&&h>0))return!0}if(f&&v.overflowX.match(/(scroll|auto)/)){var _=m.scrollWidth-m.clientWidth;if(_>0&&(m.scrollLeft>0&&f<0||m.scrollLeft<_&&f>0))return!0}m=m.parentNode}return!1}function c(d){if(o(d)){var f=i(d),h={pageX:f.pageX,pageY:f.pageY},m=h.pageX-n.startOffset.pageX,v=h.pageY-n.startOffset.pageY;if(l(d.target,m,v))return;r(m,v),n.startOffset=h;var w=new Date().getTime(),_=w-n.startTime;_>0&&(n.speed.x=m/_,n.speed.y=v/_,n.startTime=w),a(m,v)&&d.cancelable&&d.preventDefault()}}function u(){t.settings.swipeEasing&&(clearInterval(n.easingLoop),n.easingLoop=setInterval(function(){if(t.isInitialized){clearInterval(n.easingLoop);return}if(!n.speed.x&&!n.speed.y){clearInterval(n.easingLoop);return}if(Math.abs(n.speed.x)<.01&&Math.abs(n.speed.y)<.01){clearInterval(n.easingLoop);return}r(n.speed.x*30,n.speed.y*30),n.speed.x*=.8,n.speed.y*=.8},10))}ft.supportsTouch?(t.event.bind(e,"touchstart",s),t.event.bind(e,"touchmove",c),t.event.bind(e,"touchend",u)):ft.supportsIePointer&&(window.PointerEvent?(t.event.bind(e,"pointerdown",s),t.event.bind(e,"pointermove",c),t.event.bind(e,"pointerup",u)):window.MSPointerEvent&&(t.event.bind(e,"MSPointerDown",s),t.event.bind(e,"MSPointerMove",c),t.event.bind(e,"MSPointerUp",u)))}var Ni=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1}},Ri={"click-rail":Oi,"drag-thumb":Ii,keyboard:ki,wheel:qi,touch:Pi},$t=function(e,n){var a=this;if(n===void 0&&(n={}),typeof e=="string"&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=e,e.classList.add(ne.main),this.settings=Ni();for(var r in n)this.settings[r]=n[r];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var i=function(){return e.classList.add(ne.state.focus)},o=function(){return e.classList.remove(ne.state.focus)};this.isRtl=Ie(e).direction==="rtl",this.isRtl===!0&&e.classList.add(ne.rtl),this.isNegativeScroll=(function(){var c=e.scrollLeft,u=null;return e.scrollLeft=-1,u=e.scrollLeft<0,e.scrollLeft=c,u})(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new St,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=Ut(ne.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=Ut(ne.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",i),this.event.bind(this.scrollbarX,"blur",o),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var s=Ie(this.scrollbarXRail);this.scrollbarXBottom=parseInt(s.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=G(s.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=G(s.borderLeftWidth)+G(s.borderRightWidth),ve(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=G(s.marginLeft)+G(s.marginRight),ve(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=Ut(ne.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=Ut(ne.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",i),this.event.bind(this.scrollbarY,"blur",o),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var l=Ie(this.scrollbarYRail);this.scrollbarYRight=parseInt(l.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=G(l.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?Di(this.scrollbarY):null,this.railBorderYWidth=G(l.borderTopWidth)+G(l.borderBottomWidth),ve(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=G(l.marginTop)+G(l.marginBottom),ve(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(c){return Ri[c](a)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(c){return a.onScroll(c)}),$e(this)};$t.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,ve(this.scrollbarXRail,{display:"block"}),ve(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=G(Ie(this.scrollbarXRail).marginLeft)+G(Ie(this.scrollbarXRail).marginRight),this.railYMarginHeight=G(Ie(this.scrollbarYRail).marginTop)+G(Ie(this.scrollbarYRail).marginBottom),ve(this.scrollbarXRail,{display:"none"}),ve(this.scrollbarYRail,{display:"none"}),$e(this),cn(this,"top",0,!1,!0),cn(this,"left",0,!1,!0),ve(this.scrollbarXRail,{display:""}),ve(this.scrollbarYRail,{display:""}))};$t.prototype.onScroll=function(e){this.isAlive&&($e(this),cn(this,"top",this.element.scrollTop-this.lastScrollTop),cn(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)};$t.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),pt(this.scrollbarX),pt(this.scrollbarY),pt(this.scrollbarXRail),pt(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)};$t.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};const _n="ave.stickySidebar",Da=()=>{try{return window.localStorage}catch{return null}},Bi=(t,e)=>{const n=t.map(a=>({element:a,transition:a?.style.transition,webkit:a?.style.WebkitTransition,moz:a?.style.MozTransition}));n.forEach(({element:a})=>{a&&(a.style.WebkitTransition="none",a.style.MozTransition="none",a.style.transition="none")}),e(),n.forEach(({element:a,transition:r,webkit:i,moz:o})=>{a&&(a.style.WebkitTransition=i||"",a.style.MozTransition=o||"",a.style.transition=r||"")})};function Hi(){const t=document.querySelector(".app"),e=document.querySelector(".side-menu"),n=document.querySelector(".ave-navbar"),a=document.getElementById("ave-loader"),r=document.querySelector(".hamburger"),i=document.querySelector(".fadetoblack"),o=e?.querySelector('[data-ave-menu="container"]')||document.querySelector(".ave-sidebar__menu");if(!t||!e||!n||!r)return;let s=null;const l=()=>{s&&window.requestAnimationFrame(()=>{s?.update()})},c=h=>{const m=Da();if(m){if(h){m.setItem(_n,"true");return}m.removeItem(_n)}},u=(h,m={suppressPersist:!1})=>{t.classList.toggle("expanded",h),r.classList.toggle("is-active",h),m.suppressPersist||c(h),l()};Bi([e,t,n],()=>{if(!(window.innerWidth>768&&Da()?.getItem(_n)==="true")){u(!1,{suppressPersist:!0});return}t.classList.add("expanded","no-animation"),r.classList.add("is-active","no-animation"),a&&(a.style.left=`${e.clientWidth/2}px`)}),i&&i.addEventListener("click",()=>{u(!1)}),r.addEventListener("click",h=>{h.preventDefault();const m=!t.classList.contains("expanded");u(m)}),o&&(s=new $t(o,{wheelPropagation:!1,suppressScrollX:!0}),window.addEventListener("resize",()=>{l()},{passive:!0}));const d=document.querySelectorAll(".ave-sidebar__toggle"),f=(h,m)=>{if(!h)return;if(h.removeAttribute("data-ave-animating"),m){h.classList.add("ave-sidebar__submenu--open"),h.style.maxHeight="0px",requestAnimationFrame(()=>{const b=h.scrollHeight;h.style.maxHeight=`${b}px`,l()});const _=b=>{b.propertyName==="max-height"&&(h.style.maxHeight="none",h.removeEventListener("transitionend",_),l())};h.addEventListener("transitionend",_);return}const v=h.scrollHeight;h.style.maxHeight=`${v}px`,requestAnimationFrame(()=>{h.classList.remove("ave-sidebar__submenu--open"),h.style.maxHeight="0px",l()});const w=_=>{_.propertyName==="max-height"&&(h.style.maxHeight="0px",h.removeEventListener("transitionend",w),l())};h.addEventListener("transitionend",w)};d.forEach(h=>{const m=h.closest('[data-ave-menu="item"]'),v=h.getAttribute("data-ave-submenu"),w=v?document.getElementById(v):null;if(!m||!w)return;const _=h.getAttribute("aria-expanded")==="true";m.classList.toggle("ave-sidebar__item--expanded",_),w.classList.toggle("ave-sidebar__submenu--open",_),w.style.maxHeight=_?"none":"0px",h.setAttribute("aria-expanded",String(_)),l(),h.addEventListener("click",b=>{b.preventDefault();const M=h.getAttribute("aria-expanded")!=="true";h.setAttribute("aria-expanded",String(M)),m.classList.toggle("ave-sidebar__item--expanded",M),f(w,M)})})}function Xi(){const t=document.querySelector(".ave-navbar__right .dropdown.profile"),e=t?.querySelector(".dropdown-toggle"),n=t?.querySelector(".dropdown-menu");if(!t||!e||!n)return;const a=()=>{t.classList.remove("open"),e.setAttribute("aria-expanded","false")};e.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();const i=t.classList.toggle("open");e.setAttribute("aria-expanded",String(i))}),document.addEventListener("click",r=>{t.contains(r.target)||a()}),document.addEventListener("keydown",r=>{r.key==="Escape"&&a()})}function br(t=document){t.querySelectorAll(".form-field-default").forEach(e=>{const n=e.querySelector("input");n&&(n.addEventListener("focus",()=>e.classList.add("focused")),n.addEventListener("blur",()=>e.classList.remove("focused")))})}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Ma(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Ne(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ma(Object(n),!0).forEach(function(a){Yi(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ma(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function an(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?an=function(e){return typeof e}:an=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(t)}function Yi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function We(){return We=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},We.apply(this,arguments)}function $i(t,e){if(t==null)return{};var n={},a=Object.keys(t),r,i;for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Wi(t,e){if(t==null)return{};var n=$i(t,e),a,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)a=i[r],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}var Fi="1.15.6";function Ye(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Fe=Ye(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Wt=Ye(/Edge/i),Oa=Ye(/firefox/i),It=Ye(/safari/i)&&!Ye(/chrome/i)&&!Ye(/android/i),fa=Ye(/iP(ad|od|hone)/i),wr=Ye(/chrome/i)&&Ye(/android/i),Er={capture:!1,passive:!1};function $(t,e,n){t.addEventListener(e,n,!Fe&&Er)}function X(t,e,n){t.removeEventListener(e,n,!Fe&&Er)}function dn(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Sr(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function De(t,e,n,a){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&dn(t,e):dn(t,e))||a&&t===n)return t;if(t===n)break}while(t=Sr(t))}return null}var Ia=/\s+/g;function be(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var a=(" "+t.className+" ").replace(Ia," ").replace(" "+e+" "," ");t.className=(a+(n?" "+e:"")).replace(Ia," ")}}function P(t,e,n){var a=t&&t.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in a)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),a[e]=n+(typeof n=="string"?"":"px")}}function yt(t,e){var n="";if(typeof t=="string")n=t;else do{var a=P(t,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function Tr(t,e,n){if(t){var a=t.getElementsByTagName(e),r=0,i=a.length;if(n)for(;r<i;r++)n(a[r],r);return a}return[]}function qe(){var t=document.scrollingElement;return t||document.documentElement}function ae(t,e,n,a,r){if(!(!t.getBoundingClientRect&&t!==window)){var i,o,s,l,c,u,d;if(t!==window&&t.parentNode&&t!==qe()?(i=t.getBoundingClientRect(),o=i.top,s=i.left,l=i.bottom,c=i.right,u=i.height,d=i.width):(o=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(e||n)&&t!==window&&(r=r||t.parentNode,!Fe))do if(r&&r.getBoundingClientRect&&(P(r,"transform")!=="none"||n&&P(r,"position")!=="static")){var f=r.getBoundingClientRect();o-=f.top+parseInt(P(r,"border-top-width")),s-=f.left+parseInt(P(r,"border-left-width")),l=o+i.height,c=s+i.width;break}while(r=r.parentNode);if(a&&t!==window){var h=yt(r||t),m=h&&h.a,v=h&&h.d;h&&(o/=v,s/=m,d/=m,u/=v,l=o+u,c=s+d)}return{top:o,left:s,bottom:l,right:c,width:d,height:u}}}function ka(t,e,n){for(var a=Ve(t,!0),r=ae(t)[e];a;){var i=ae(a)[n],o=void 0;if(o=r>=i,!o)return a;if(a===qe())break;a=Ve(a,!1)}return!1}function Et(t,e,n,a){for(var r=0,i=0,o=t.children;i<o.length;){if(o[i].style.display!=="none"&&o[i]!==I.ghost&&(a||o[i]!==I.dragged)&&De(o[i],n.draggable,t,!1)){if(r===e)return o[i];r++}i++}return null}function ha(t,e){for(var n=t.lastElementChild;n&&(n===I.ghost||P(n,"display")==="none"||e&&!dn(n,e));)n=n.previousElementSibling;return n||null}function Te(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==I.clone&&(!e||dn(t,e))&&n++;return n}function qa(t){var e=0,n=0,a=qe();if(t)do{var r=yt(t),i=r.a,o=r.d;e+=t.scrollLeft*i,n+=t.scrollTop*o}while(t!==a&&(t=t.parentNode));return[e,n]}function ji(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var a in e)if(e.hasOwnProperty(a)&&e[a]===t[n][a])return Number(n)}return-1}function Ve(t,e){if(!t||!t.getBoundingClientRect)return qe();var n=t,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=P(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return qe();if(a||e)return n;a=!0}}while(n=n.parentNode);return qe()}function zi(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Ln(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var kt;function xr(t,e){return function(){if(!kt){var n=arguments,a=this;n.length===1?t.call(a,n[0]):t.apply(a,n),kt=setTimeout(function(){kt=void 0},e)}}}function Ui(){clearTimeout(kt),kt=void 0}function Ar(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function Cr(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function _r(t,e,n){var a={};return Array.from(t.children).forEach(function(r){var i,o,s,l;if(!(!De(r,e.draggable,t,!1)||r.animated||r===n)){var c=ae(r);a.left=Math.min((i=a.left)!==null&&i!==void 0?i:1/0,c.left),a.top=Math.min((o=a.top)!==null&&o!==void 0?o:1/0,c.top),a.right=Math.max((s=a.right)!==null&&s!==void 0?s:-1/0,c.right),a.bottom=Math.max((l=a.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var ye="Sortable"+new Date().getTime();function Ki(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(r){if(!(P(r,"display")==="none"||r===I.ghost)){t.push({target:r,rect:ae(r)});var i=Ne({},t[t.length-1].rect);if(r.thisAnimationDuration){var o=yt(r,!0);o&&(i.top-=o.f,i.left-=o.e)}r.fromRect=i}})}},addAnimationState:function(a){t.push(a)},removeAnimationState:function(a){t.splice(ji(t,{target:a}),1)},animateAll:function(a){var r=this;if(!this.options.animation){clearTimeout(e),typeof a=="function"&&a();return}var i=!1,o=0;t.forEach(function(s){var l=0,c=s.target,u=c.fromRect,d=ae(c),f=c.prevFromRect,h=c.prevToRect,m=s.rect,v=yt(c,!0);v&&(d.top-=v.f,d.left-=v.e),c.toRect=d,c.thisAnimationDuration&&Ln(f,d)&&!Ln(u,d)&&(m.top-d.top)/(m.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(l=Gi(m,f,h,r.options)),Ln(d,u)||(c.prevFromRect=u,c.prevToRect=d,l||(l=r.options.animation),r.animate(c,m,d,l)),l&&(i=!0,o=Math.max(o,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),i?e=setTimeout(function(){typeof a=="function"&&a()},o):typeof a=="function"&&a(),t=[]},animate:function(a,r,i,o){if(o){P(a,"transition",""),P(a,"transform","");var s=yt(this.el),l=s&&s.a,c=s&&s.d,u=(r.left-i.left)/(l||1),d=(r.top-i.top)/(c||1);a.animatingX=!!u,a.animatingY=!!d,P(a,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=Vi(a),P(a,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),P(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){P(a,"transition",""),P(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},o)}}}}function Vi(t){return t.offsetWidth}function Gi(t,e,n,a){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*a.animation}var ct=[],Dn={initializeByDefault:!0},Ft={mount:function(e){for(var n in Dn)Dn.hasOwnProperty(n)&&!(n in e)&&(e[n]=Dn[n]);ct.forEach(function(a){if(a.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),ct.push(e)},pluginEvent:function(e,n,a){var r=this;this.eventCanceled=!1,a.cancel=function(){r.eventCanceled=!0};var i=e+"Global";ct.forEach(function(o){n[o.pluginName]&&(n[o.pluginName][i]&&n[o.pluginName][i](Ne({sortable:n},a)),n.options[o.pluginName]&&n[o.pluginName][e]&&n[o.pluginName][e](Ne({sortable:n},a)))})},initializePlugins:function(e,n,a,r){ct.forEach(function(s){var l=s.pluginName;if(!(!e.options[l]&&!s.initializeByDefault)){var c=new s(e,n,e.options);c.sortable=e,c.options=e.options,e[l]=c,We(a,c.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var o=this.modifyOption(e,i,e.options[i]);typeof o<"u"&&(e.options[i]=o)}},getEventProperties:function(e,n){var a={};return ct.forEach(function(r){typeof r.eventProperties=="function"&&We(a,r.eventProperties.call(n[r.pluginName],e))}),a},modifyOption:function(e,n,a){var r;return ct.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(r=i.optionListeners[n].call(e[i.pluginName],a))}),r}};function Ji(t){var e=t.sortable,n=t.rootEl,a=t.name,r=t.targetEl,i=t.cloneEl,o=t.toEl,s=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,d=t.newDraggableIndex,f=t.originalEvent,h=t.putSortable,m=t.extraEventProperties;if(e=e||n&&n[ye],!!e){var v,w=e.options,_="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Fe&&!Wt?v=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent(a,!0,!0)),v.to=o||n,v.from=s||n,v.item=r||n,v.clone=i,v.oldIndex=l,v.newIndex=c,v.oldDraggableIndex=u,v.newDraggableIndex=d,v.originalEvent=f,v.pullMode=h?h.lastPutMode:void 0;var b=Ne(Ne({},m),Ft.getEventProperties(a,e));for(var M in b)v[M]=b[M];n&&n.dispatchEvent(v),w[_]&&w[_].call(e,v)}}var Zi=["evt"],pe=function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=a.evt,i=Wi(a,Zi);Ft.pluginEvent.bind(I)(e,n,Ne({dragEl:S,parentEl:Z,ghostEl:R,rootEl:j,nextEl:rt,lastDownEl:rn,cloneEl:V,cloneHidden:Ue,dragStarted:Lt,putSortable:le,activeSortable:I.active,originalEvent:r,oldIndex:mt,oldDraggableIndex:qt,newIndex:we,newDraggableIndex:ze,hideGhostForTarget:Or,unhideGhostForTarget:Ir,cloneNowHidden:function(){Ue=!0},cloneNowShown:function(){Ue=!1},dispatchSortableEvent:function(s){he({sortable:n,name:s,originalEvent:r})}},i))};function he(t){Ji(Ne({putSortable:le,cloneEl:V,targetEl:S,rootEl:j,oldIndex:mt,oldDraggableIndex:qt,newIndex:we,newDraggableIndex:ze},t))}var S,Z,R,j,rt,rn,V,Ue,mt,we,qt,ze,Gt,le,ht=!1,un=!1,fn=[],et,_e,Mn,On,Pa,Na,Lt,dt,Pt,Nt=!1,Jt=!1,on,ue,In=[],zn=!1,hn=[],bn=typeof document<"u",Zt=fa,Ra=Wt||Fe?"cssFloat":"float",Qi=bn&&!wr&&!fa&&"draggable"in document.createElement("div"),Lr=(function(){if(bn){if(Fe)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}})(),Dr=function(e,n){var a=P(e),r=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),i=Et(e,0,n),o=Et(e,1,n),s=i&&P(i),l=o&&P(o),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+ae(i).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+ae(o).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s.float&&s.float!=="none"){var d=s.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return i&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=r&&a[Ra]==="none"||o&&a[Ra]==="none"&&c+u>r)?"vertical":"horizontal"},eo=function(e,n,a){var r=a?e.left:e.top,i=a?e.right:e.bottom,o=a?e.width:e.height,s=a?n.left:n.top,l=a?n.right:n.bottom,c=a?n.width:n.height;return r===s||i===l||r+o/2===s+c/2},to=function(e,n){var a;return fn.some(function(r){var i=r[ye].options.emptyInsertThreshold;if(!(!i||ha(r))){var o=ae(r),s=e>=o.left-i&&e<=o.right+i,l=n>=o.top-i&&n<=o.bottom+i;if(s&&l)return a=r}}),a},Mr=function(e){function n(i,o){return function(s,l,c,u){var d=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(i==null&&(o||d))return!0;if(i==null||i===!1)return!1;if(o&&i==="clone")return i;if(typeof i=="function")return n(i(s,l,c,u),o)(s,l,c,u);var f=(o?s:l).options.group.name;return i===!0||typeof i=="string"&&i===f||i.join&&i.indexOf(f)>-1}}var a={},r=e.group;(!r||an(r)!="object")&&(r={name:r}),a.name=r.name,a.checkPull=n(r.pull,!0),a.checkPut=n(r.put),a.revertClone=r.revertClone,e.group=a},Or=function(){!Lr&&R&&P(R,"display","none")},Ir=function(){!Lr&&R&&P(R,"display","")};bn&&!wr&&document.addEventListener("click",function(t){if(un)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),un=!1,!1},!0);var tt=function(e){if(S){e=e.touches?e.touches[0]:e;var n=to(e.clientX,e.clientY);if(n){var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=e[r]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[ye]._onDragOver(a)}}},no=function(e){S&&S.parentNode[ye]._isOutsideThisEl(e.target)};function I(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=We({},e),t[ye]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Dr(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,s){o.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:I.supportPointer!==!1&&"PointerEvent"in window&&(!It||fa),emptyInsertThreshold:5};Ft.initializePlugins(this,t,n);for(var a in n)!(a in e)&&(e[a]=n[a]);Mr(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:Qi,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?$(t,"pointerdown",this._onTapStart):($(t,"mousedown",this._onTapStart),$(t,"touchstart",this._onTapStart)),this.nativeDraggable&&($(t,"dragover",this),$(t,"dragenter",this)),fn.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),We(this,Ki())}I.prototype={constructor:I,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(dt=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,S):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,a=this.el,r=this.options,i=r.preventOnFilter,o=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(s||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=r.filter;if(uo(a),!S&&!(/mousedown|pointerdown/.test(o)&&e.button!==0||r.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&It&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=De(l,r.draggable,a,!1),!(l&&l.animated)&&rn!==l)){if(mt=Te(l),qt=Te(l,r.draggable),typeof u=="function"){if(u.call(this,e,l,this)){he({sortable:n,rootEl:c,name:"filter",targetEl:l,toEl:a,fromEl:a}),pe("filter",n,{evt:e}),i&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=De(c,d.trim(),a,!1),d)return he({sortable:n,rootEl:d,name:"filter",targetEl:l,fromEl:a,toEl:a}),pe("filter",n,{evt:e}),!0}),u)){i&&e.preventDefault();return}r.handle&&!De(c,r.handle,a,!1)||this._prepareDragStart(e,s,l)}}},_prepareDragStart:function(e,n,a){var r=this,i=r.el,o=r.options,s=i.ownerDocument,l;if(a&&!S&&a.parentNode===i){var c=ae(a);if(j=i,S=a,Z=S.parentNode,rt=S.nextSibling,rn=a,Gt=o.group,I.dragged=S,et={target:S,clientX:(n||e).clientX,clientY:(n||e).clientY},Pa=et.clientX-c.left,Na=et.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,S.style["will-change"]="all",l=function(){if(pe("delayEnded",r,{evt:e}),I.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!Oa&&r.nativeDraggable&&(S.draggable=!0),r._triggerDragStart(e,n),he({sortable:r,name:"choose",originalEvent:e}),be(S,o.chosenClass,!0)},o.ignore.split(",").forEach(function(u){Tr(S,u.trim(),kn)}),$(s,"dragover",tt),$(s,"mousemove",tt),$(s,"touchmove",tt),o.supportPointer?($(s,"pointerup",r._onDrop),!this.nativeDraggable&&$(s,"pointercancel",r._onDrop)):($(s,"mouseup",r._onDrop),$(s,"touchend",r._onDrop),$(s,"touchcancel",r._onDrop)),Oa&&this.nativeDraggable&&(this.options.touchStartThreshold=4,S.draggable=!0),pe("delayStart",this,{evt:e}),o.delay&&(!o.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Wt||Fe))){if(I.eventCanceled){this._onDrop();return}o.supportPointer?($(s,"pointerup",r._disableDelayedDrag),$(s,"pointercancel",r._disableDelayedDrag)):($(s,"mouseup",r._disableDelayedDrag),$(s,"touchend",r._disableDelayedDrag),$(s,"touchcancel",r._disableDelayedDrag)),$(s,"mousemove",r._delayedDragTouchMoveHandler),$(s,"touchmove",r._delayedDragTouchMoveHandler),o.supportPointer&&$(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){S&&kn(S),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;X(e,"mouseup",this._disableDelayedDrag),X(e,"touchend",this._disableDelayedDrag),X(e,"touchcancel",this._disableDelayedDrag),X(e,"pointerup",this._disableDelayedDrag),X(e,"pointercancel",this._disableDelayedDrag),X(e,"mousemove",this._delayedDragTouchMoveHandler),X(e,"touchmove",this._delayedDragTouchMoveHandler),X(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?$(document,"pointermove",this._onTouchMove):n?$(document,"touchmove",this._onTouchMove):$(document,"mousemove",this._onTouchMove):($(S,"dragend",this),$(j,"dragstart",this._onDragStart));try{document.selection?sn(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(ht=!1,j&&S){pe("dragStarted",this,{evt:n}),this.nativeDraggable&&$(document,"dragover",no);var a=this.options;!e&&be(S,a.dragClass,!1),be(S,a.ghostClass,!0),I.active=this,e&&this._appendGhost(),he({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(_e){this._lastX=_e.clientX,this._lastY=_e.clientY,Or();for(var e=document.elementFromPoint(_e.clientX,_e.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(_e.clientX,_e.clientY),e!==n);)n=e;if(S.parentNode[ye]._isOutsideThisEl(e),n)do{if(n[ye]){var a=void 0;if(a=n[ye]._onDragOver({clientX:_e.clientX,clientY:_e.clientY,target:e,rootEl:n}),a&&!this.options.dragoverBubble)break}e=n}while(n=Sr(n));Ir()}},_onTouchMove:function(e){if(et){var n=this.options,a=n.fallbackTolerance,r=n.fallbackOffset,i=e.touches?e.touches[0]:e,o=R&&yt(R,!0),s=R&&o&&o.a,l=R&&o&&o.d,c=Zt&&ue&&qa(ue),u=(i.clientX-et.clientX+r.x)/(s||1)+(c?c[0]-In[0]:0)/(s||1),d=(i.clientY-et.clientY+r.y)/(l||1)+(c?c[1]-In[1]:0)/(l||1);if(!I.active&&!ht){if(a&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<a)return;this._onDragStart(e,!0)}if(R){o?(o.e+=u-(Mn||0),o.f+=d-(On||0)):o={a:1,b:0,c:0,d:1,e:u,f:d};var f="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");P(R,"webkitTransform",f),P(R,"mozTransform",f),P(R,"msTransform",f),P(R,"transform",f),Mn=u,On=d,_e=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!R){var e=this.options.fallbackOnBody?document.body:j,n=ae(S,!0,Zt,!0,e),a=this.options;if(Zt){for(ue=e;P(ue,"position")==="static"&&P(ue,"transform")==="none"&&ue!==document;)ue=ue.parentNode;ue!==document.body&&ue!==document.documentElement?(ue===document&&(ue=qe()),n.top+=ue.scrollTop,n.left+=ue.scrollLeft):ue=qe(),In=qa(ue)}R=S.cloneNode(!0),be(R,a.ghostClass,!1),be(R,a.fallbackClass,!0),be(R,a.dragClass,!0),P(R,"transition",""),P(R,"transform",""),P(R,"box-sizing","border-box"),P(R,"margin",0),P(R,"top",n.top),P(R,"left",n.left),P(R,"width",n.width),P(R,"height",n.height),P(R,"opacity","0.8"),P(R,"position",Zt?"absolute":"fixed"),P(R,"zIndex","100000"),P(R,"pointerEvents","none"),I.ghost=R,e.appendChild(R),P(R,"transform-origin",Pa/parseInt(R.style.width)*100+"% "+Na/parseInt(R.style.height)*100+"%")}},_onDragStart:function(e,n){var a=this,r=e.dataTransfer,i=a.options;if(pe("dragStart",this,{evt:e}),I.eventCanceled){this._onDrop();return}pe("setupClone",this),I.eventCanceled||(V=Cr(S),V.removeAttribute("id"),V.draggable=!1,V.style["will-change"]="",this._hideClone(),be(V,this.options.chosenClass,!1),I.clone=V),a.cloneId=sn(function(){pe("clone",a),!I.eventCanceled&&(a.options.removeCloneOnHide||j.insertBefore(V,S),a._hideClone(),he({sortable:a,name:"clone"}))}),!n&&be(S,i.dragClass,!0),n?(un=!0,a._loopId=setInterval(a._emulateDragOver,50)):(X(document,"mouseup",a._onDrop),X(document,"touchend",a._onDrop),X(document,"touchcancel",a._onDrop),r&&(r.effectAllowed="move",i.setData&&i.setData.call(a,r,S)),$(document,"drop",a),P(S,"transform","translateZ(0)")),ht=!0,a._dragStartId=sn(a._dragStarted.bind(a,n,e)),$(document,"selectstart",a),Lt=!0,window.getSelection().removeAllRanges(),It&&P(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,a=e.target,r,i,o,s=this.options,l=s.group,c=I.active,u=Gt===l,d=s.sort,f=le||c,h,m=this,v=!1;if(zn)return;function w(Ce,Ze){pe(Ce,m,Ne({evt:e,isOwner:u,axis:h?"vertical":"horizontal",revert:o,dragRect:r,targetRect:i,canSort:d,fromSortable:f,target:a,completed:b,onMove:function(Qe,He){return Qt(j,n,S,r,Qe,ae(Qe),e,He)},changed:M},Ze))}function _(){w("dragOverAnimationCapture"),m.captureAnimationState(),m!==f&&f.captureAnimationState()}function b(Ce){return w("dragOverCompleted",{insertion:Ce}),Ce&&(u?c._hideClone():c._showClone(m),m!==f&&(be(S,le?le.options.ghostClass:c.options.ghostClass,!1),be(S,s.ghostClass,!0)),le!==m&&m!==I.active?le=m:m===I.active&&le&&(le=null),f===m&&(m._ignoreWhileAnimating=a),m.animateAll(function(){w("dragOverAnimationComplete"),m._ignoreWhileAnimating=null}),m!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(a===S&&!S.animated||a===n&&!a.animated)&&(dt=null),!s.dragoverBubble&&!e.rootEl&&a!==document&&(S.parentNode[ye]._isOutsideThisEl(e.target),!Ce&&tt(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function M(){we=Te(S),ze=Te(S,s.draggable),he({sortable:m,name:"change",toEl:n,newIndex:we,newDraggableIndex:ze,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),a=De(a,s.draggable,n,!0),w("dragOver"),I.eventCanceled)return v;if(S.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||m._ignoreWhileAnimating===a)return b(!1);if(un=!1,c&&!s.disabled&&(u?d||(o=Z!==j):le===this||(this.lastPutMode=Gt.checkPull(this,c,S,e))&&l.checkPut(this,c,S,e))){if(h=this._getDirection(e,a)==="vertical",r=ae(S),w("dragOverValid"),I.eventCanceled)return v;if(o)return Z=j,_(),this._hideClone(),w("revert"),I.eventCanceled||(rt?j.insertBefore(S,rt):j.appendChild(S)),b(!0);var E=ha(n,s.draggable);if(!E||oo(e,h,this)&&!E.animated){if(E===S)return b(!1);if(E&&n===e.target&&(a=E),a&&(i=ae(a)),Qt(j,n,S,r,a,i,e,!!a)!==!1)return _(),E&&E.nextSibling?n.insertBefore(S,E.nextSibling):n.appendChild(S),Z=n,M(),b(!0)}else if(E&&io(e,h,this)){var y=Et(n,0,s,!0);if(y===S)return b(!1);if(a=y,i=ae(a),Qt(j,n,S,r,a,i,e,!1)!==!1)return _(),n.insertBefore(S,y),Z=n,M(),b(!0)}else if(a.parentNode===n){i=ae(a);var p=0,C,k=S.parentNode!==n,q=!eo(S.animated&&S.toRect||r,a.animated&&a.toRect||i,h),K=h?"top":"left",W=ka(a,"top","top")||ka(S,"top","top"),de=W?W.scrollTop:void 0;dt!==a&&(C=i[K],Nt=!1,Jt=!q&&s.invertSwap||k),p=so(e,a,i,h,q?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Jt,dt===a);var Q;if(p!==0){var ee=Te(S);do ee-=p,Q=Z.children[ee];while(Q&&(P(Q,"display")==="none"||Q===R))}if(p===0||Q===a)return b(!1);dt=a,Pt=p;var J=a.nextElementSibling,oe=!1;oe=p===1;var Ae=Qt(j,n,S,r,a,i,e,oe);if(Ae!==!1)return(Ae===1||Ae===-1)&&(oe=Ae===1),zn=!0,setTimeout(ro,30),_(),oe&&!J?n.appendChild(S):a.parentNode.insertBefore(S,oe?J:a),W&&Ar(W,0,de-W.scrollTop),Z=S.parentNode,C!==void 0&&!Jt&&(on=Math.abs(C-ae(a)[K])),M(),b(!0)}if(n.contains(S))return b(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){X(document,"mousemove",this._onTouchMove),X(document,"touchmove",this._onTouchMove),X(document,"pointermove",this._onTouchMove),X(document,"dragover",tt),X(document,"mousemove",tt),X(document,"touchmove",tt)},_offUpEvents:function(){var e=this.el.ownerDocument;X(e,"mouseup",this._onDrop),X(e,"touchend",this._onDrop),X(e,"pointerup",this._onDrop),X(e,"pointercancel",this._onDrop),X(e,"touchcancel",this._onDrop),X(document,"selectstart",this)},_onDrop:function(e){var n=this.el,a=this.options;if(we=Te(S),ze=Te(S,a.draggable),pe("drop",this,{evt:e}),Z=S&&S.parentNode,we=Te(S),ze=Te(S,a.draggable),I.eventCanceled){this._nulling();return}ht=!1,Jt=!1,Nt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Un(this.cloneId),Un(this._dragStartId),this.nativeDraggable&&(X(document,"drop",this),X(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),It&&P(document.body,"user-select",""),P(S,"transform",""),e&&(Lt&&(e.cancelable&&e.preventDefault(),!a.dropBubble&&e.stopPropagation()),R&&R.parentNode&&R.parentNode.removeChild(R),(j===Z||le&&le.lastPutMode!=="clone")&&V&&V.parentNode&&V.parentNode.removeChild(V),S&&(this.nativeDraggable&&X(S,"dragend",this),kn(S),S.style["will-change"]="",Lt&&!ht&&be(S,le?le.options.ghostClass:this.options.ghostClass,!1),be(S,this.options.chosenClass,!1),he({sortable:this,name:"unchoose",toEl:Z,newIndex:null,newDraggableIndex:null,originalEvent:e}),j!==Z?(we>=0&&(he({rootEl:Z,name:"add",toEl:Z,fromEl:j,originalEvent:e}),he({sortable:this,name:"remove",toEl:Z,originalEvent:e}),he({rootEl:Z,name:"sort",toEl:Z,fromEl:j,originalEvent:e}),he({sortable:this,name:"sort",toEl:Z,originalEvent:e})),le&&le.save()):we!==mt&&we>=0&&(he({sortable:this,name:"update",toEl:Z,originalEvent:e}),he({sortable:this,name:"sort",toEl:Z,originalEvent:e})),I.active&&((we==null||we===-1)&&(we=mt,ze=qt),he({sortable:this,name:"end",toEl:Z,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){pe("nulling",this),j=S=Z=R=rt=V=rn=Ue=et=_e=Lt=we=ze=mt=qt=dt=Pt=le=Gt=I.dragged=I.ghost=I.clone=I.active=null,hn.forEach(function(e){e.checked=!0}),hn.length=Mn=On=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":S&&(this._onDragOver(e),ao(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,a=this.el.children,r=0,i=a.length,o=this.options;r<i;r++)n=a[r],De(n,o.draggable,this.el,!1)&&e.push(n.getAttribute(o.dataIdAttr)||co(n));return e},sort:function(e,n){var a={},r=this.el;this.toArray().forEach(function(i,o){var s=r.children[o];De(s,this.options.draggable,r,!1)&&(a[i]=s)},this),n&&this.captureAnimationState(),e.forEach(function(i){a[i]&&(r.removeChild(a[i]),r.appendChild(a[i]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return De(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var a=this.options;if(n===void 0)return a[e];var r=Ft.modifyOption(this,e,n);typeof r<"u"?a[e]=r:a[e]=n,e==="group"&&Mr(a)},destroy:function(){pe("destroy",this);var e=this.el;e[ye]=null,X(e,"mousedown",this._onTapStart),X(e,"touchstart",this._onTapStart),X(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(e,"dragover",this),X(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),fn.splice(fn.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ue){if(pe("hideClone",this),I.eventCanceled)return;P(V,"display","none"),this.options.removeCloneOnHide&&V.parentNode&&V.parentNode.removeChild(V),Ue=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Ue){if(pe("showClone",this),I.eventCanceled)return;S.parentNode==j&&!this.options.group.revertClone?j.insertBefore(V,S):rt?j.insertBefore(V,rt):j.appendChild(V),this.options.group.revertClone&&this.animate(S,V),P(V,"display",""),Ue=!1}}};function ao(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Qt(t,e,n,a,r,i,o,s){var l,c=t[ye],u=c.options.onMove,d;return window.CustomEvent&&!Fe&&!Wt?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=n,l.draggedRect=a,l.related=r||e,l.relatedRect=i||ae(e),l.willInsertAfter=s,l.originalEvent=o,t.dispatchEvent(l),u&&(d=u.call(c,l,o)),d}function kn(t){t.draggable=!1}function ro(){zn=!1}function io(t,e,n){var a=ae(Et(n.el,0,n.options,!0)),r=_r(n.el,n.options,R),i=10;return e?t.clientX<r.left-i||t.clientY<a.top&&t.clientX<a.right:t.clientY<r.top-i||t.clientY<a.bottom&&t.clientX<a.left}function oo(t,e,n){var a=ae(ha(n.el,n.options.draggable)),r=_r(n.el,n.options,R),i=10;return e?t.clientX>r.right+i||t.clientY>a.bottom&&t.clientX>a.left:t.clientY>r.bottom+i||t.clientX>a.right&&t.clientY>a.top}function so(t,e,n,a,r,i,o,s){var l=a?t.clientY:t.clientX,c=a?n.height:n.width,u=a?n.top:n.left,d=a?n.bottom:n.right,f=!1;if(!o){if(s&&on<c*r){if(!Nt&&(Pt===1?l>u+c*i/2:l<d-c*i/2)&&(Nt=!0),Nt)f=!0;else if(Pt===1?l<u+on:l>d-on)return-Pt}else if(l>u+c*(1-r)/2&&l<d-c*(1-r)/2)return lo(e)}return f=f||o,f&&(l<u+c*i/2||l>d-c*i/2)?l>u+c/2?1:-1:0}function lo(t){return Te(S)<Te(t)?1:-1}function co(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,a=0;n--;)a+=e.charCodeAt(n);return a.toString(36)}function uo(t){hn.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var a=e[n];a.checked&&hn.push(a)}}function sn(t){return setTimeout(t,0)}function Un(t){return clearTimeout(t)}bn&&$(document,"touchmove",function(t){(I.active||ht)&&t.cancelable&&t.preventDefault()});I.utils={on:$,off:X,css:P,find:Tr,is:function(e,n){return!!De(e,n,e,!1)},extend:zi,throttle:xr,closest:De,toggleClass:be,clone:Cr,index:Te,nextTick:sn,cancelNextTick:Un,detectDirection:Dr,getChild:Et,expando:ye};I.get=function(t){return t[ye]};I.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(I.utils=Ne(Ne({},I.utils),a.utils)),Ft.mount(a)})};I.create=function(t,e){return new I(t,e)};I.version=Fi;var te=[],Dt,Kn,Vn=!1,qn,Pn,pn,Mt;function fo(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?$(document,"dragover",this._handleAutoScroll):this.options.supportPointer?$(document,"pointermove",this._handleFallbackAutoScroll):a.touches?$(document,"touchmove",this._handleFallbackAutoScroll):$(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):(X(document,"pointermove",this._handleFallbackAutoScroll),X(document,"touchmove",this._handleFallbackAutoScroll),X(document,"mousemove",this._handleFallbackAutoScroll)),Ba(),ln(),Ui()},nulling:function(){pn=Kn=Dt=Vn=Mt=qn=Pn=null,te.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var r=this,i=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(i,o);if(pn=n,a||this.options.forceAutoScrollFallback||Wt||Fe||It){Nn(n,this.options,s,a);var l=Ve(s,!0);Vn&&(!Mt||i!==qn||o!==Pn)&&(Mt&&Ba(),Mt=setInterval(function(){var c=Ve(document.elementFromPoint(i,o),!0);c!==l&&(l=c,ln()),Nn(n,r.options,c,a)},10),qn=i,Pn=o)}else{if(!this.options.bubbleScroll||Ve(s,!0)===qe()){ln();return}Nn(n,this.options,Ve(s,!1),!1)}}},We(t,{pluginName:"scroll",initializeByDefault:!0})}function ln(){te.forEach(function(t){clearInterval(t.pid)}),te=[]}function Ba(){clearInterval(Mt)}var Nn=xr(function(t,e,n,a){if(e.scroll){var r=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,o=e.scrollSensitivity,s=e.scrollSpeed,l=qe(),c=!1,u;Kn!==n&&(Kn=n,ln(),Dt=e.scroll,u=e.scrollFn,Dt===!0&&(Dt=Ve(n,!0)));var d=0,f=Dt;do{var h=f,m=ae(h),v=m.top,w=m.bottom,_=m.left,b=m.right,M=m.width,E=m.height,y=void 0,p=void 0,C=h.scrollWidth,k=h.scrollHeight,q=P(h),K=h.scrollLeft,W=h.scrollTop;h===l?(y=M<C&&(q.overflowX==="auto"||q.overflowX==="scroll"||q.overflowX==="visible"),p=E<k&&(q.overflowY==="auto"||q.overflowY==="scroll"||q.overflowY==="visible")):(y=M<C&&(q.overflowX==="auto"||q.overflowX==="scroll"),p=E<k&&(q.overflowY==="auto"||q.overflowY==="scroll"));var de=y&&(Math.abs(b-r)<=o&&K+M<C)-(Math.abs(_-r)<=o&&!!K),Q=p&&(Math.abs(w-i)<=o&&W+E<k)-(Math.abs(v-i)<=o&&!!W);if(!te[d])for(var ee=0;ee<=d;ee++)te[ee]||(te[ee]={});(te[d].vx!=de||te[d].vy!=Q||te[d].el!==h)&&(te[d].el=h,te[d].vx=de,te[d].vy=Q,clearInterval(te[d].pid),(de!=0||Q!=0)&&(c=!0,te[d].pid=setInterval((function(){a&&this.layer===0&&I.active._onTouchMove(pn);var J=te[this.layer].vy?te[this.layer].vy*s:0,oe=te[this.layer].vx?te[this.layer].vx*s:0;typeof u=="function"&&u.call(I.dragged.parentNode[ye],oe,J,t,pn,te[this.layer].el)!=="continue"||Ar(te[this.layer].el,oe,J)}).bind({layer:d}),24))),d++}while(e.bubbleScroll&&f!==l&&(f=Ve(f,!1)));Vn=c}},30),kr=function(e){var n=e.originalEvent,a=e.putSortable,r=e.dragEl,i=e.activeSortable,o=e.dispatchSortableEvent,s=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(n){var c=a||i;s();var u=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,d=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(d)&&(o("spill"),this.onSpill({dragEl:r,putSortable:a}))}};function pa(){}pa.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,a=e.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var r=Et(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(n,r):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:kr};We(pa,{pluginName:"revertOnSpill"});function ma(){}ma.prototype={onSpill:function(e){var n=e.dragEl,a=e.putSortable,r=a||this.sortable;r.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),r.animateAll()},drop:kr};We(ma,{pluginName:"removeOnSpill"});I.mount(new fo);I.mount(ma,pa);/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function Ha(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function qr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ha(Object(n),!0).forEach(function(a){go(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ha(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function ho(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Pr(t){var e=ho(t,"string");return typeof e=="symbol"?e:e+""}function Gn(t){"@babel/helpers - typeof";return Gn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gn(t)}function po(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xa(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,Pr(a.key),a)}}function mo(t,e,n){return e&&Xa(t.prototype,e),n&&Xa(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function go(t,e,n){return e=Pr(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nr(t){return vo(t)||yo(t)||bo(t)||wo()}function vo(t){if(Array.isArray(t))return Jn(t)}function yo(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bo(t,e){if(t){if(typeof t=="string")return Jn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jn(t,e)}}function Jn(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function wo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var wn=typeof window<"u"&&typeof window.document<"u",Re=wn?window:{},ga=wn&&Re.document.documentElement?"ontouchstart"in Re.document.documentElement:!1,va=wn?"PointerEvent"in Re:!1,z="cropper",ya="all",Rr="crop",Br="move",Hr="zoom",nt="e",at="w",ut="s",je="n",xt="ne",At="nw",Ct="se",_t="sw",Zn="".concat(z,"-crop"),Ya="".concat(z,"-disabled"),ge="".concat(z,"-hidden"),$a="".concat(z,"-hide"),Eo="".concat(z,"-invisible"),mn="".concat(z,"-modal"),Qn="".concat(z,"-move"),Bt="".concat(z,"Action"),en="".concat(z,"Preview"),ba="crop",Xr="move",Yr="none",ea="crop",ta="cropend",na="cropmove",aa="cropstart",Wa="dblclick",So=ga?"touchstart":"mousedown",To=ga?"touchmove":"mousemove",xo=ga?"touchend touchcancel":"mouseup",Fa=va?"pointerdown":So,ja=va?"pointermove":To,za=va?"pointerup pointercancel":xo,Ua="ready",Ka="resize",Va="wheel",ra="zoom",Ga="image/jpeg",Ao=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Co=/^data:/,_o=/^data:image\/jpeg;base64,/,Lo=/^img|canvas$/i,$r=200,Wr=100,Ja={viewMode:0,dragMode:ba,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:$r,minContainerHeight:Wr,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Do='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',Mo=Number.isNaN||Re.isNaN;function Y(t){return typeof t=="number"&&!Mo(t)}var Za=function(e){return e>0&&e<1/0};function Rn(t){return typeof t>"u"}function ot(t){return Gn(t)==="object"&&t!==null}var Oo=Object.prototype.hasOwnProperty;function gt(t){if(!ot(t))return!1;try{var e=t.constructor,n=e.prototype;return e&&n&&Oo.call(n,"isPrototypeOf")}catch{return!1}}function me(t){return typeof t=="function"}var Io=Array.prototype.slice;function Fr(t){return Array.from?Array.from(t):Io.call(t)}function re(t,e){return t&&me(e)&&(Array.isArray(t)||Y(t.length)?Fr(t).forEach(function(n,a){e.call(t,n,a,t)}):ot(t)&&Object.keys(t).forEach(function(n){e.call(t,t[n],n,t)})),t}var U=Object.assign||function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return ot(e)&&a.length>0&&a.forEach(function(i){ot(i)&&Object.keys(i).forEach(function(o){e[o]=i[o]})}),e},ko=/\.\d*(?:0|9){12}\d*$/;function bt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ko.test(t)?Math.round(t*e)/e:t}var qo=/^width|height|left|top|marginLeft|marginTop$/;function Ge(t,e){var n=t.style;re(e,function(a,r){qo.test(r)&&Y(a)&&(a="".concat(a,"px")),n[r]=a})}function Po(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function se(t,e){if(e){if(Y(t.length)){re(t,function(a){se(a,e)});return}if(t.classList){t.classList.add(e);return}var n=t.className.trim();n?n.indexOf(e)<0&&(t.className="".concat(n," ").concat(e)):t.className=e}}function Pe(t,e){if(e){if(Y(t.length)){re(t,function(n){Pe(n,e)});return}if(t.classList){t.classList.remove(e);return}t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,""))}}function vt(t,e,n){if(e){if(Y(t.length)){re(t,function(a){vt(a,e,n)});return}n?se(t,e):Pe(t,e)}}var No=/([a-z\d])([A-Z])/g;function wa(t){return t.replace(No,"$1-$2").toLowerCase()}function ia(t,e){return ot(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(wa(e)))}function Ht(t,e,n){ot(n)?t[e]=n:t.dataset?t.dataset[e]=n:t.setAttribute("data-".concat(wa(e)),n)}function Ro(t,e){if(ot(t[e]))try{delete t[e]}catch{t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch{t.dataset[e]=void 0}else t.removeAttribute("data-".concat(wa(e)))}var jr=/\s\s*/,zr=(function(){var t=!1;if(wn){var e=!1,n=function(){},a=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(i){e=i}});Re.addEventListener("test",n,a),Re.removeEventListener("test",n,a)}return t})();function Le(t,e,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=n;e.trim().split(jr).forEach(function(i){if(!zr){var o=t.listeners;o&&o[i]&&o[i][n]&&(r=o[i][n],delete o[i][n],Object.keys(o[i]).length===0&&delete o[i],Object.keys(o).length===0&&delete t.listeners)}t.removeEventListener(i,r,a)})}function Se(t,e,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=n;e.trim().split(jr).forEach(function(i){if(a.once&&!zr){var o=t.listeners,s=o===void 0?{}:o;r=function(){delete s[i][n],t.removeEventListener(i,r,a);for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];n.apply(t,u)},s[i]||(s[i]={}),s[i][n]&&t.removeEventListener(i,s[i][n],a),s[i][n]=r,t.listeners=s}t.addEventListener(i,r,a)})}function wt(t,e,n){var a;return me(Event)&&me(CustomEvent)?a=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!0,!0,n)),t.dispatchEvent(a)}function Ur(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Bn=Re.location,Bo=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Qa(t){var e=t.match(Bo);return e!==null&&(e[1]!==Bn.protocol||e[2]!==Bn.hostname||e[3]!==Bn.port)}function er(t){var e="timestamp=".concat(new Date().getTime());return t+(t.indexOf("?")===-1?"?":"&")+e}function Rt(t){var e=t.rotate,n=t.scaleX,a=t.scaleY,r=t.translateX,i=t.translateY,o=[];Y(r)&&r!==0&&o.push("translateX(".concat(r,"px)")),Y(i)&&i!==0&&o.push("translateY(".concat(i,"px)")),Y(e)&&e!==0&&o.push("rotate(".concat(e,"deg)")),Y(n)&&n!==1&&o.push("scaleX(".concat(n,")")),Y(a)&&a!==1&&o.push("scaleY(".concat(a,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function Ho(t){var e=qr({},t),n=0;return re(t,function(a,r){delete e[r],re(e,function(i){var o=Math.abs(a.startX-i.startX),s=Math.abs(a.startY-i.startY),l=Math.abs(a.endX-i.endX),c=Math.abs(a.endY-i.endY),u=Math.sqrt(o*o+s*s),d=Math.sqrt(l*l+c*c),f=(d-u)/u;Math.abs(f)>Math.abs(n)&&(n=f)})}),n}function tn(t,e){var n=t.pageX,a=t.pageY,r={endX:n,endY:a};return e?r:qr({startX:n,startY:a},r)}function Xo(t){var e=0,n=0,a=0;return re(t,function(r){var i=r.startX,o=r.startY;e+=i,n+=o,a+=1}),e/=a,n/=a,{pageX:e,pageY:n}}function Je(t){var e=t.aspectRatio,n=t.height,a=t.width,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",i=Za(a),o=Za(n);if(i&&o){var s=n*e;r==="contain"&&s>a||r==="cover"&&s<a?n=a/e:a=n*e}else i?n=a/e:o&&(a=n*e);return{width:a,height:n}}function Yo(t){var e=t.width,n=t.height,a=t.degree;if(a=Math.abs(a)%180,a===90)return{width:n,height:e};var r=a%90*Math.PI/180,i=Math.sin(r),o=Math.cos(r),s=e*o+n*i,l=e*i+n*o;return a>90?{width:l,height:s}:{width:s,height:l}}function $o(t,e,n,a){var r=e.aspectRatio,i=e.naturalWidth,o=e.naturalHeight,s=e.rotate,l=s===void 0?0:s,c=e.scaleX,u=c===void 0?1:c,d=e.scaleY,f=d===void 0?1:d,h=n.aspectRatio,m=n.naturalWidth,v=n.naturalHeight,w=a.fillColor,_=w===void 0?"transparent":w,b=a.imageSmoothingEnabled,M=b===void 0?!0:b,E=a.imageSmoothingQuality,y=E===void 0?"low":E,p=a.maxWidth,C=p===void 0?1/0:p,k=a.maxHeight,q=k===void 0?1/0:k,K=a.minWidth,W=K===void 0?0:K,de=a.minHeight,Q=de===void 0?0:de,ee=document.createElement("canvas"),J=ee.getContext("2d"),oe=Je({aspectRatio:h,width:C,height:q}),Ae=Je({aspectRatio:h,width:W,height:Q},"cover"),Ce=Math.min(oe.width,Math.max(Ae.width,m)),Ze=Math.min(oe.height,Math.max(Ae.height,v)),Tt=Je({aspectRatio:r,width:C,height:q}),Qe=Je({aspectRatio:r,width:W,height:Q},"cover"),He=Math.min(Tt.width,Math.max(Qe.width,i)),Me=Math.min(Tt.height,Math.max(Qe.height,o)),En=[-He/2,-Me/2,He,Me];return ee.width=bt(Ce),ee.height=bt(Ze),J.fillStyle=_,J.fillRect(0,0,Ce,Ze),J.save(),J.translate(Ce/2,Ze/2),J.rotate(l*Math.PI/180),J.scale(u,f),J.imageSmoothingEnabled=M,J.imageSmoothingQuality=y,J.drawImage.apply(J,[t].concat(Nr(En.map(function(lt){return Math.floor(bt(lt))})))),J.restore(),ee}var Kr=String.fromCharCode;function Wo(t,e,n){var a="";n+=e;for(var r=e;r<n;r+=1)a+=Kr(t.getUint8(r));return a}var Fo=/^data:.*,/;function jo(t){var e=t.replace(Fo,""),n=atob(e),a=new ArrayBuffer(n.length),r=new Uint8Array(a);return re(r,function(i,o){r[o]=n.charCodeAt(o)}),a}function zo(t,e){for(var n=[],a=8192,r=new Uint8Array(t);r.length>0;)n.push(Kr.apply(null,Fr(r.subarray(0,a)))),r=r.subarray(a);return"data:".concat(e,";base64,").concat(btoa(n.join("")))}function Uo(t){var e=new DataView(t),n;try{var a,r,i;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var o=e.byteLength,s=2;s+1<o;){if(e.getUint8(s)===255&&e.getUint8(s+1)===225){r=s;break}s+=1}if(r){var l=r+4,c=r+10;if(Wo(e,l,4)==="Exif"){var u=e.getUint16(c);if(a=u===18761,(a||u===19789)&&e.getUint16(c+2,a)===42){var d=e.getUint32(c+4,a);d>=8&&(i=c+d)}}}if(i){var f=e.getUint16(i,a),h,m;for(m=0;m<f;m+=1)if(h=i+m*12+2,e.getUint16(h,a)===274){h+=8,n=e.getUint16(h,a),e.setUint16(h,1,a);break}}}catch{n=1}return n}function Ko(t){var e=0,n=1,a=1;switch(t){case 2:n=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,n=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:n,scaleY:a}}var Vo={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,n=this.options,a=this.container,r=this.cropper,i=Number(n.minContainerWidth),o=Number(n.minContainerHeight);se(r,ge),Pe(e,ge);var s={width:Math.max(a.offsetWidth,i>=0?i:$r),height:Math.max(a.offsetHeight,o>=0?o:Wr)};this.containerData=s,Ge(r,{width:s.width,height:s.height}),se(e,ge),Pe(r,ge)},initCanvas:function(){var e=this.containerData,n=this.imageData,a=this.options.viewMode,r=Math.abs(n.rotate)%180===90,i=r?n.naturalHeight:n.naturalWidth,o=r?n.naturalWidth:n.naturalHeight,s=i/o,l=e.width,c=e.height;e.height*s>e.width?a===3?l=e.height*s:c=e.width/s:a===3?c=e.width/s:l=e.height*s;var u={aspectRatio:s,naturalWidth:i,naturalHeight:o,width:l,height:c};this.canvasData=u,this.limited=a===1||a===2,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(e.width-u.width)/2,u.top=(e.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=U({},u)},limitCanvas:function(e,n){var a=this.options,r=this.containerData,i=this.canvasData,o=this.cropBoxData,s=a.viewMode,l=i.aspectRatio,c=this.cropped&&o;if(e){var u=Number(a.minCanvasWidth)||0,d=Number(a.minCanvasHeight)||0;s>1?(u=Math.max(u,r.width),d=Math.max(d,r.height),s===3&&(d*l>u?u=d*l:d=u/l)):s>0&&(u?u=Math.max(u,c?o.width:0):d?d=Math.max(d,c?o.height:0):c&&(u=o.width,d=o.height,d*l>u?u=d*l:d=u/l));var f=Je({aspectRatio:l,width:u,height:d});u=f.width,d=f.height,i.minWidth=u,i.minHeight=d,i.maxWidth=1/0,i.maxHeight=1/0}if(n)if(s>(c?0:1)){var h=r.width-i.width,m=r.height-i.height;i.minLeft=Math.min(0,h),i.minTop=Math.min(0,m),i.maxLeft=Math.max(0,h),i.maxTop=Math.max(0,m),c&&this.limited&&(i.minLeft=Math.min(o.left,o.left+(o.width-i.width)),i.minTop=Math.min(o.top,o.top+(o.height-i.height)),i.maxLeft=o.left,i.maxTop=o.top,s===2&&(i.width>=r.width&&(i.minLeft=Math.min(0,h),i.maxLeft=Math.max(0,h)),i.height>=r.height&&(i.minTop=Math.min(0,m),i.maxTop=Math.max(0,m))))}else i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=r.width,i.maxTop=r.height},renderCanvas:function(e,n){var a=this.canvasData,r=this.imageData;if(n){var i=Yo({width:r.naturalWidth*Math.abs(r.scaleX||1),height:r.naturalHeight*Math.abs(r.scaleY||1),degree:r.rotate||0}),o=i.width,s=i.height,l=a.width*(o/a.naturalWidth),c=a.height*(s/a.naturalHeight);a.left-=(l-a.width)/2,a.top-=(c-a.height)/2,a.width=l,a.height=c,a.aspectRatio=o/s,a.naturalWidth=o,a.naturalHeight=s,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,Ge(this.canvas,U({width:a.width,height:a.height},Rt({translateX:a.left,translateY:a.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var n=this.canvasData,a=this.imageData,r=a.naturalWidth*(n.width/n.naturalWidth),i=a.naturalHeight*(n.height/n.naturalHeight);U(a,{width:r,height:i,left:(n.width-r)/2,top:(n.height-i)/2}),Ge(this.image,U({width:a.width,height:a.height},Rt(U({translateX:a.left,translateY:a.top},a)))),e&&this.output()},initCropBox:function(){var e=this.options,n=this.canvasData,a=e.aspectRatio||e.initialAspectRatio,r=Number(e.autoCropArea)||.8,i={width:n.width,height:n.height};a&&(n.height*a>n.width?i.height=i.width/a:i.width=i.height*a),this.cropBoxData=i,this.limitCropBox(!0,!0),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),i.width=Math.max(i.minWidth,i.width*r),i.height=Math.max(i.minHeight,i.height*r),i.left=n.left+(n.width-i.width)/2,i.top=n.top+(n.height-i.height)/2,i.oldLeft=i.left,i.oldTop=i.top,this.initialCropBoxData=U({},i)},limitCropBox:function(e,n){var a=this.options,r=this.containerData,i=this.canvasData,o=this.cropBoxData,s=this.limited,l=a.aspectRatio;if(e){var c=Number(a.minCropBoxWidth)||0,u=Number(a.minCropBoxHeight)||0,d=s?Math.min(r.width,i.width,i.width+i.left,r.width-i.left):r.width,f=s?Math.min(r.height,i.height,i.height+i.top,r.height-i.top):r.height;c=Math.min(c,r.width),u=Math.min(u,r.height),l&&(c&&u?u*l>c?u=c/l:c=u*l:c?u=c/l:u&&(c=u*l),f*l>d?f=d/l:d=f*l),o.minWidth=Math.min(c,d),o.minHeight=Math.min(u,f),o.maxWidth=d,o.maxHeight=f}n&&(s?(o.minLeft=Math.max(0,i.left),o.minTop=Math.max(0,i.top),o.maxLeft=Math.min(r.width,i.left+i.width)-o.width,o.maxTop=Math.min(r.height,i.top+i.height)-o.height):(o.minLeft=0,o.minTop=0,o.maxLeft=r.width-o.width,o.maxTop=r.height-o.height))},renderCropBox:function(){var e=this.options,n=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,e.movable&&e.cropBoxMovable&&Ht(this.face,Bt,a.width>=n.width&&a.height>=n.height?Br:ya),Ge(this.cropBox,U({width:a.width,height:a.height},Rt({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),wt(this.element,ea,this.getData())}},Go={initPreview:function(){var e=this.element,n=this.crossOrigin,a=this.options.preview,r=n?this.crossOriginUrl:this.url,i=e.alt||"The image to preview",o=document.createElement("img");if(n&&(o.crossOrigin=n),o.src=r,o.alt=i,this.viewBox.appendChild(o),this.viewBoxImage=o,!!a){var s=a;typeof a=="string"?s=e.ownerDocument.querySelectorAll(a):a.querySelector&&(s=[a]),this.previews=s,re(s,function(l){var c=document.createElement("img");Ht(l,en,{width:l.offsetWidth,height:l.offsetHeight,html:l.innerHTML}),n&&(c.crossOrigin=n),c.src=r,c.alt=i,c.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',l.innerHTML="",l.appendChild(c)})}},resetPreview:function(){re(this.previews,function(e){var n=ia(e,en);Ge(e,{width:n.width,height:n.height}),e.innerHTML=n.html,Ro(e,en)})},preview:function(){var e=this.imageData,n=this.canvasData,a=this.cropBoxData,r=a.width,i=a.height,o=e.width,s=e.height,l=a.left-n.left-e.left,c=a.top-n.top-e.top;!this.cropped||this.disabled||(Ge(this.viewBoxImage,U({width:o,height:s},Rt(U({translateX:-l,translateY:-c},e)))),re(this.previews,function(u){var d=ia(u,en),f=d.width,h=d.height,m=f,v=h,w=1;r&&(w=f/r,v=i*w),i&&v>h&&(w=h/i,m=r*w,v=h),Ge(u,{width:m,height:v}),Ge(u.getElementsByTagName("img")[0],U({width:o*w,height:s*w},Rt(U({translateX:-l*w,translateY:-c*w},e))))}))}},Jo={bind:function(){var e=this.element,n=this.options,a=this.cropper;me(n.cropstart)&&Se(e,aa,n.cropstart),me(n.cropmove)&&Se(e,na,n.cropmove),me(n.cropend)&&Se(e,ta,n.cropend),me(n.crop)&&Se(e,ea,n.crop),me(n.zoom)&&Se(e,ra,n.zoom),Se(a,Fa,this.onCropStart=this.cropStart.bind(this)),n.zoomable&&n.zoomOnWheel&&Se(a,Va,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&Se(a,Wa,this.onDblclick=this.dblclick.bind(this)),Se(e.ownerDocument,ja,this.onCropMove=this.cropMove.bind(this)),Se(e.ownerDocument,za,this.onCropEnd=this.cropEnd.bind(this)),n.responsive&&Se(window,Ka,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,n=this.options,a=this.cropper;me(n.cropstart)&&Le(e,aa,n.cropstart),me(n.cropmove)&&Le(e,na,n.cropmove),me(n.cropend)&&Le(e,ta,n.cropend),me(n.crop)&&Le(e,ea,n.crop),me(n.zoom)&&Le(e,ra,n.zoom),Le(a,Fa,this.onCropStart),n.zoomable&&n.zoomOnWheel&&Le(a,Va,this.onWheel,{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&Le(a,Wa,this.onDblclick),Le(e.ownerDocument,ja,this.onCropMove),Le(e.ownerDocument,za,this.onCropEnd),n.responsive&&Le(window,Ka,this.onResize)}},Zo={resize:function(){if(!this.disabled){var e=this.options,n=this.container,a=this.containerData,r=n.offsetWidth/a.width,i=n.offsetHeight/a.height,o=Math.abs(r-1)>Math.abs(i-1)?r:i;if(o!==1){var s,l;e.restore&&(s=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(re(s,function(c,u){s[u]=c*o})),this.setCropBoxData(re(l,function(c,u){l[u]=c*o})))}}},dblclick:function(){this.disabled||this.options.dragMode===Yr||this.setDragMode(Po(this.dragBox,Zn)?Xr:ba)},wheel:function(e){var n=this,a=Number(this.options.wheelZoomRatio)||.1,r=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){n.wheeling=!1},50),e.deltaY?r=e.deltaY>0?1:-1:e.wheelDelta?r=-e.wheelDelta/120:e.detail&&(r=e.detail>0?1:-1),this.zoom(-r*a,e)))},cropStart:function(e){var n=e.buttons,a=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(Y(n)&&n!==1||Y(a)&&a!==0||e.ctrlKey))){var r=this.options,i=this.pointers,o;e.changedTouches?re(e.changedTouches,function(s){i[s.identifier]=tn(s)}):i[e.pointerId||0]=tn(e),Object.keys(i).length>1&&r.zoomable&&r.zoomOnTouch?o=Hr:o=ia(e.target,Bt),Ao.test(o)&&wt(this.element,aa,{originalEvent:e,action:o})!==!1&&(e.preventDefault(),this.action=o,this.cropping=!1,o===Rr&&(this.cropping=!0,se(this.dragBox,mn)))}},cropMove:function(e){var n=this.action;if(!(this.disabled||!n)){var a=this.pointers;e.preventDefault(),wt(this.element,na,{originalEvent:e,action:n})!==!1&&(e.changedTouches?re(e.changedTouches,function(r){U(a[r.identifier]||{},tn(r,!0))}):U(a[e.pointerId||0]||{},tn(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var n=this.action,a=this.pointers;e.changedTouches?re(e.changedTouches,function(r){delete a[r.identifier]}):delete a[e.pointerId||0],n&&(e.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,vt(this.dragBox,mn,this.cropped&&this.options.modal)),wt(this.element,ta,{originalEvent:e,action:n}))}}},Qo={change:function(e){var n=this.options,a=this.canvasData,r=this.containerData,i=this.cropBoxData,o=this.pointers,s=this.action,l=n.aspectRatio,c=i.left,u=i.top,d=i.width,f=i.height,h=c+d,m=u+f,v=0,w=0,_=r.width,b=r.height,M=!0,E;!l&&e.shiftKey&&(l=d&&f?d/f:1),this.limited&&(v=i.minLeft,w=i.minTop,_=v+Math.min(r.width,a.width,a.left+a.width),b=w+Math.min(r.height,a.height,a.top+a.height));var y=o[Object.keys(o)[0]],p={x:y.endX-y.startX,y:y.endY-y.startY},C=function(q){switch(q){case nt:h+p.x>_&&(p.x=_-h);break;case at:c+p.x<v&&(p.x=v-c);break;case je:u+p.y<w&&(p.y=w-u);break;case ut:m+p.y>b&&(p.y=b-m);break}};switch(s){case ya:c+=p.x,u+=p.y;break;case nt:if(p.x>=0&&(h>=_||l&&(u<=w||m>=b))){M=!1;break}C(nt),d+=p.x,d<0&&(s=at,d=-d,c-=d),l&&(f=d/l,u+=(i.height-f)/2);break;case je:if(p.y<=0&&(u<=w||l&&(c<=v||h>=_))){M=!1;break}C(je),f-=p.y,u+=p.y,f<0&&(s=ut,f=-f,u-=f),l&&(d=f*l,c+=(i.width-d)/2);break;case at:if(p.x<=0&&(c<=v||l&&(u<=w||m>=b))){M=!1;break}C(at),d-=p.x,c+=p.x,d<0&&(s=nt,d=-d,c-=d),l&&(f=d/l,u+=(i.height-f)/2);break;case ut:if(p.y>=0&&(m>=b||l&&(c<=v||h>=_))){M=!1;break}C(ut),f+=p.y,f<0&&(s=je,f=-f,u-=f),l&&(d=f*l,c+=(i.width-d)/2);break;case xt:if(l){if(p.y<=0&&(u<=w||h>=_)){M=!1;break}C(je),f-=p.y,u+=p.y,d=f*l}else C(je),C(nt),p.x>=0?h<_?d+=p.x:p.y<=0&&u<=w&&(M=!1):d+=p.x,p.y<=0?u>w&&(f-=p.y,u+=p.y):(f-=p.y,u+=p.y);d<0&&f<0?(s=_t,f=-f,d=-d,u-=f,c-=d):d<0?(s=At,d=-d,c-=d):f<0&&(s=Ct,f=-f,u-=f);break;case At:if(l){if(p.y<=0&&(u<=w||c<=v)){M=!1;break}C(je),f-=p.y,u+=p.y,d=f*l,c+=i.width-d}else C(je),C(at),p.x<=0?c>v?(d-=p.x,c+=p.x):p.y<=0&&u<=w&&(M=!1):(d-=p.x,c+=p.x),p.y<=0?u>w&&(f-=p.y,u+=p.y):(f-=p.y,u+=p.y);d<0&&f<0?(s=Ct,f=-f,d=-d,u-=f,c-=d):d<0?(s=xt,d=-d,c-=d):f<0&&(s=_t,f=-f,u-=f);break;case _t:if(l){if(p.x<=0&&(c<=v||m>=b)){M=!1;break}C(at),d-=p.x,c+=p.x,f=d/l}else C(ut),C(at),p.x<=0?c>v?(d-=p.x,c+=p.x):p.y>=0&&m>=b&&(M=!1):(d-=p.x,c+=p.x),p.y>=0?m<b&&(f+=p.y):f+=p.y;d<0&&f<0?(s=xt,f=-f,d=-d,u-=f,c-=d):d<0?(s=Ct,d=-d,c-=d):f<0&&(s=At,f=-f,u-=f);break;case Ct:if(l){if(p.x>=0&&(h>=_||m>=b)){M=!1;break}C(nt),d+=p.x,f=d/l}else C(ut),C(nt),p.x>=0?h<_?d+=p.x:p.y>=0&&m>=b&&(M=!1):d+=p.x,p.y>=0?m<b&&(f+=p.y):f+=p.y;d<0&&f<0?(s=At,f=-f,d=-d,u-=f,c-=d):d<0?(s=_t,d=-d,c-=d):f<0&&(s=xt,f=-f,u-=f);break;case Br:this.move(p.x,p.y),M=!1;break;case Hr:this.zoom(Ho(o),e),M=!1;break;case Rr:if(!p.x||!p.y){M=!1;break}E=Ur(this.cropper),c=y.startX-E.left,u=y.startY-E.top,d=i.minWidth,f=i.minHeight,p.x>0?s=p.y>0?Ct:xt:p.x<0&&(c-=d,s=p.y>0?_t:At),p.y<0&&(u-=f),this.cropped||(Pe(this.cropBox,ge),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}M&&(i.width=d,i.height=f,i.left=c,i.top=u,this.action=s,this.renderCropBox()),re(o,function(k){k.startX=k.endX,k.startY=k.endY})}},es={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&se(this.dragBox,mn),Pe(this.cropBox,ge),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=U({},this.initialImageData),this.canvasData=U({},this.initialCanvasData),this.cropBoxData=U({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(U(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Pe(this.dragBox,mn),se(this.cropBox,ge)),this},replace:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),n?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,re(this.previews,function(a){a.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Pe(this.cropper,Ya)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,se(this.cropper,Ya)),this},destroy:function(){var e=this.element;return e[z]?(e[z]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,r=a.left,i=a.top;return this.moveTo(Rn(e)?e:r+Number(e),Rn(n)?n:i+Number(n))},moveTo:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,r=!1;return e=Number(e),n=Number(n),this.ready&&!this.disabled&&this.options.movable&&(Y(e)&&(a.left=e,r=!0),Y(n)&&(a.top=n,r=!0),r&&this.renderCanvas(!0)),this},zoom:function(e,n){var a=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(a.width*e/a.naturalWidth,null,n)},zoomTo:function(e,n,a){var r=this.options,i=this.canvasData,o=i.width,s=i.height,l=i.naturalWidth,c=i.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&r.zoomable){var u=l*e,d=c*e;if(wt(this.element,ra,{ratio:e,oldRatio:o/l,originalEvent:a})===!1)return this;if(a){var f=this.pointers,h=Ur(this.cropper),m=f&&Object.keys(f).length?Xo(f):{pageX:a.pageX,pageY:a.pageY};i.left-=(u-o)*((m.pageX-h.left-i.left)/o),i.top-=(d-s)*((m.pageY-h.top-i.top)/s)}else gt(n)&&Y(n.x)&&Y(n.y)?(i.left-=(u-o)*((n.x-i.left)/o),i.top-=(d-s)*((n.y-i.top)/s)):(i.left-=(u-o)/2,i.top-=(d-s)/2);i.width=u,i.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),Y(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var n=this.imageData.scaleY;return this.scale(e,Y(n)?n:1)},scaleY:function(e){var n=this.imageData.scaleX;return this.scale(Y(n)?n:1,e)},scale:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.imageData,r=!1;return e=Number(e),n=Number(n),this.ready&&!this.disabled&&this.options.scalable&&(Y(e)&&(a.scaleX=e,r=!0),Y(n)&&(a.scaleY=n,r=!0),r&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.options,a=this.imageData,r=this.canvasData,i=this.cropBoxData,o;if(this.ready&&this.cropped){o={x:i.left-r.left,y:i.top-r.top,width:i.width,height:i.height};var s=a.width/a.naturalWidth;if(re(o,function(u,d){o[d]=u/s}),e){var l=Math.round(o.y+o.height),c=Math.round(o.x+o.width);o.x=Math.round(o.x),o.y=Math.round(o.y),o.width=c-o.x,o.height=l-o.y}}else o={x:0,y:0,width:0,height:0};return n.rotatable&&(o.rotate=a.rotate||0),n.scalable&&(o.scaleX=a.scaleX||1,o.scaleY=a.scaleY||1),o},setData:function(e){var n=this.options,a=this.imageData,r=this.canvasData,i={};if(this.ready&&!this.disabled&&gt(e)){var o=!1;n.rotatable&&Y(e.rotate)&&e.rotate!==a.rotate&&(a.rotate=e.rotate,o=!0),n.scalable&&(Y(e.scaleX)&&e.scaleX!==a.scaleX&&(a.scaleX=e.scaleX,o=!0),Y(e.scaleY)&&e.scaleY!==a.scaleY&&(a.scaleY=e.scaleY,o=!0)),o&&this.renderCanvas(!0,!0);var s=a.width/a.naturalWidth;Y(e.x)&&(i.left=e.x*s+r.left),Y(e.y)&&(i.top=e.y*s+r.top),Y(e.width)&&(i.width=e.width*s),Y(e.height)&&(i.height=e.height*s),this.setCropBoxData(i)}return this},getContainerData:function(){return this.ready?U({},this.containerData):{}},getImageData:function(){return this.sized?U({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,n={};return this.ready&&re(["left","top","width","height","naturalWidth","naturalHeight"],function(a){n[a]=e[a]}),n},setCanvasData:function(e){var n=this.canvasData,a=n.aspectRatio;return this.ready&&!this.disabled&&gt(e)&&(Y(e.left)&&(n.left=e.left),Y(e.top)&&(n.top=e.top),Y(e.width)?(n.width=e.width,n.height=e.width/a):Y(e.height)&&(n.height=e.height,n.width=e.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,n;return this.ready&&this.cropped&&(n={left:e.left,top:e.top,width:e.width,height:e.height}),n||{}},setCropBoxData:function(e){var n=this.cropBoxData,a=this.options.aspectRatio,r,i;return this.ready&&this.cropped&&!this.disabled&&gt(e)&&(Y(e.left)&&(n.left=e.left),Y(e.top)&&(n.top=e.top),Y(e.width)&&e.width!==n.width&&(r=!0,n.width=e.width),Y(e.height)&&e.height!==n.height&&(i=!0,n.height=e.height),a&&(r?n.height=n.width/a:i&&(n.width=n.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var n=this.canvasData,a=$o(this.image,this.imageData,n,e);if(!this.cropped)return a;var r=this.getData(e.rounded),i=r.x,o=r.y,s=r.width,l=r.height,c=a.width/Math.floor(n.naturalWidth);c!==1&&(i*=c,o*=c,s*=c,l*=c);var u=s/l,d=Je({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=Je({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),h=Je({aspectRatio:u,width:e.width||(c!==1?a.width:s),height:e.height||(c!==1?a.height:l)}),m=h.width,v=h.height;m=Math.min(d.width,Math.max(f.width,m)),v=Math.min(d.height,Math.max(f.height,v));var w=document.createElement("canvas"),_=w.getContext("2d");w.width=bt(m),w.height=bt(v),_.fillStyle=e.fillColor||"transparent",_.fillRect(0,0,m,v);var b=e.imageSmoothingEnabled,M=b===void 0?!0:b,E=e.imageSmoothingQuality;_.imageSmoothingEnabled=M,E&&(_.imageSmoothingQuality=E);var y=a.width,p=a.height,C=i,k=o,q,K,W,de,Q,ee;C<=-s||C>y?(C=0,q=0,W=0,Q=0):C<=0?(W=-C,C=0,q=Math.min(y,s+C),Q=q):C<=y&&(W=0,q=Math.min(s,y-C),Q=q),q<=0||k<=-l||k>p?(k=0,K=0,de=0,ee=0):k<=0?(de=-k,k=0,K=Math.min(p,l+k),ee=K):k<=p&&(de=0,K=Math.min(l,p-k),ee=K);var J=[C,k,q,K];if(Q>0&&ee>0){var oe=m/s;J.push(W*oe,de*oe,Q*oe,ee*oe)}return _.drawImage.apply(_,[a].concat(Nr(J.map(function(Ae){return Math.floor(bt(Ae))})))),w},setAspectRatio:function(e){var n=this.options;return!this.disabled&&!Rn(e)&&(n.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var n=this.options,a=this.dragBox,r=this.face;if(this.ready&&!this.disabled){var i=e===ba,o=n.movable&&e===Xr;e=i||o?e:Yr,n.dragMode=e,Ht(a,Bt,e),vt(a,Zn,i),vt(a,Qn,o),n.cropBoxMovable||(Ht(r,Bt,e),vt(r,Zn,i),vt(r,Qn,o))}return this}},ts=Re.Cropper,Vr=(function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(po(this,t),!e||!Lo.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=U({},Ja,gt(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return mo(t,[{key:"init",value:function(){var n=this.element,a=n.tagName.toLowerCase(),r;if(!n[z]){if(n[z]=this,a==="img"){if(this.isImg=!0,r=n.getAttribute("src")||"",this.originalUrl=r,!r)return;r=n.src}else a==="canvas"&&window.HTMLCanvasElement&&(r=n.toDataURL());this.load(r)}}},{key:"load",value:function(n){var a=this;if(n){this.url=n,this.imageData={};var r=this.element,i=this.options;if(!i.rotatable&&!i.scalable&&(i.checkOrientation=!1),!i.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Co.test(n)){_o.test(n)?this.read(jo(n)):this.clone();return}var o=new XMLHttpRequest,s=this.clone.bind(this);this.reloading=!0,this.xhr=o,o.onabort=s,o.onerror=s,o.ontimeout=s,o.onprogress=function(){o.getResponseHeader("content-type")!==Ga&&o.abort()},o.onload=function(){a.read(o.response)},o.onloadend=function(){a.reloading=!1,a.xhr=null},i.checkCrossOrigin&&Qa(n)&&r.crossOrigin&&(n=er(n)),o.open("GET",n,!0),o.responseType="arraybuffer",o.withCredentials=r.crossOrigin==="use-credentials",o.send()}}},{key:"read",value:function(n){var a=this.options,r=this.imageData,i=Uo(n),o=0,s=1,l=1;if(i>1){this.url=zo(n,Ga);var c=Ko(i);o=c.rotate,s=c.scaleX,l=c.scaleY}a.rotatable&&(r.rotate=o),a.scalable&&(r.scaleX=s,r.scaleY=l),this.clone()}},{key:"clone",value:function(){var n=this.element,a=this.url,r=n.crossOrigin,i=a;this.options.checkCrossOrigin&&Qa(a)&&(r||(r="anonymous"),i=er(a)),this.crossOrigin=r,this.crossOriginUrl=i;var o=document.createElement("img");r&&(o.crossOrigin=r),o.src=i||a,o.alt=n.alt||"The image to crop",this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),se(o,$a),n.parentNode.insertBefore(o,n.nextSibling)}},{key:"start",value:function(){var n=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var r=Re.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Re.navigator.userAgent),i=function(c,u){U(n.imageData,{naturalWidth:c,naturalHeight:u,aspectRatio:c/u}),n.initialImageData=U({},n.imageData),n.sizing=!1,n.sized=!0,n.build()};if(a.naturalWidth&&!r){i(a.naturalWidth,a.naturalHeight);return}var o=document.createElement("img"),s=document.body||document.documentElement;this.sizingImage=o,o.onload=function(){i(o.width,o.height),r||s.removeChild(o)},o.src=a.src,r||(o.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",s.appendChild(o))}},{key:"stop",value:function(){var n=this.image;n.onload=null,n.onerror=null,n.parentNode.removeChild(n),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var n=this.element,a=this.options,r=this.image,i=n.parentNode,o=document.createElement("div");o.innerHTML=Do;var s=o.querySelector(".".concat(z,"-container")),l=s.querySelector(".".concat(z,"-canvas")),c=s.querySelector(".".concat(z,"-drag-box")),u=s.querySelector(".".concat(z,"-crop-box")),d=u.querySelector(".".concat(z,"-face"));this.container=i,this.cropper=s,this.canvas=l,this.dragBox=c,this.cropBox=u,this.viewBox=s.querySelector(".".concat(z,"-view-box")),this.face=d,l.appendChild(r),se(n,ge),i.insertBefore(s,n.nextSibling),Pe(r,$a),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,se(u,ge),a.guides||se(u.getElementsByClassName("".concat(z,"-dashed")),ge),a.center||se(u.getElementsByClassName("".concat(z,"-center")),ge),a.background&&se(s,"".concat(z,"-bg")),a.highlight||se(d,Eo),a.cropBoxMovable&&(se(d,Qn),Ht(d,Bt,ya)),a.cropBoxResizable||(se(u.getElementsByClassName("".concat(z,"-line")),ge),se(u.getElementsByClassName("".concat(z,"-point")),ge)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),me(a.ready)&&Se(n,Ua,a.ready,{once:!0}),wt(n,Ua)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var n=this.cropper.parentNode;n&&n.removeChild(this.cropper),Pe(this.element,ge)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ts,t}},{key:"setDefaults",value:function(n){U(Ja,gt(n)&&n)}}])})();U(Vr.prototype,Vo,Go,Jo,Zo,Qo,es);function g(t,e={}){if(!window.AveTranslations)return console.warn("AveTranslations not loaded"),t;const n=t.split(".");let a=window.AveTranslations;for(const i of n)if(a&&typeof a=="object"&&i in a)a=a[i];else return console.warn(`Translation key not found: ${t}`),t;if(typeof a!="string")return console.warn(`Translation value is not a string: ${t}`),t;let r=a;for(const[i,o]of Object.entries(e))r=r.replace(`:${i}`,o);return r}const Gr=t=>{if(!t)return;t.classList.add("is-active"),t.setAttribute("aria-hidden","false"),t.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},ke=t=>{t&&(t.classList.remove("is-active"),t.setAttribute("aria-hidden","true"))},Be=t=>{t&&(ke(t),setTimeout(()=>t.remove(),300))},fe=t=>{const{title:e="Modal",body:n="",bodyParams:a=null,type:r="default",variant:i="default",confirmText:o="OK",cancelText:s="Cancel",onConfirm:l=null,onCancel:c=null,size:u="default",autoClose:d=!0}=t,f=document.createElement("div");f.className="modal",f.setAttribute("data-ave-modal",""),f.setAttribute("data-modal-dynamic","true");const h=u==="small"?"modal-sm":u==="large"?"modal-lg":"",m=i!=="default"?`modal-${i}`:"";let v=n;if(a&&Array.isArray(a)&&a.length>0){const y=a.map(p=>`<span class="modal-param">"${p}"</span>`).join(", ");v=`<p class="modal-message">${n} ${y}</p>`}else n&&!n.startsWith("<")&&(v=`<p>${n}</p>`);f.innerHTML=`
        <div class="modal-background" data-ave-modal-close></div>
        <div class="modal-dialog ${h} ${m}">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">${e}</h4>
                    <button class="close" data-ave-modal-dismiss type="button">&times;</button>
                </div>
                <div class="modal-body">
                    ${v}
                </div>
                <div class="modal-footer">
                    ${r==="alert"?`
                        <button class="btn btn-modal-confirm" data-modal-confirm type="button">${o}</button>
                    `:r==="confirm"?`
                        <button class="btn btn-default" data-modal-cancel type="button">${s}</button>
                        <button class="btn btn-modal-confirm" data-modal-confirm type="button">${o}</button>
                    `:r==="form"?`
                        <button class="btn btn-default" data-modal-cancel type="button">${s}</button>
                        <button class="btn btn-modal-confirm" data-modal-confirm type="button">${o}</button>
                    `:""}
                </div>
            </div>
        </div>
    `;const w=f.querySelector("[data-modal-confirm]"),_=f.querySelector("[data-modal-cancel]"),b=f.querySelector("[data-ave-modal-dismiss]"),M=f.querySelector("[data-ave-modal-close]"),E=()=>{ke(f),setTimeout(()=>f.remove(),300)};return w&&w.addEventListener("click",()=>{l&&l(f),d&&setTimeout(()=>E(),0)}),_&&_.addEventListener("click",()=>{c&&c(),E()}),b&&b.addEventListener("click",E),M&&M.addEventListener("click",()=>{c&&c(),E()}),document.body.appendChild(f),requestAnimationFrame(()=>{Gr(f),xe.emit("dom:updated",f)}),f},Xt=(t,e={})=>new Promise(n=>{fe({title:e.title||g("common.confirm"),body:t,bodyParams:e.bodyParams||null,type:"confirm",variant:e.variant||"default",confirmText:e.confirmText||g("common.yes"),cancelText:e.cancelText||g("common.cancel"),size:e.size||"small",onConfirm:()=>n(!0),onCancel:()=>n(!1)})}),ns=(t,e={})=>{fe({title:e.title||g("common.alert"),body:t,bodyParams:e.bodyParams||null,type:"alert",variant:e.variant||"default",confirmText:e.confirmText||g("common.ok"),size:e.size||"small"})};function as(){window.Ave=window.Ave||{},window.Ave.confirm=Xt,window.Ave.createModal=fe,window.Ave.closeModal=ke,window.Ave.destroyModal=Be,document.querySelectorAll("[data-ave-modal-trigger]").forEach(t=>{const e=t.getAttribute("data-ave-modal-trigger"),n=e?document.querySelector(e):null;n&&t.addEventListener("click",a=>{a.preventDefault(),Gr(n)})}),document.querySelectorAll("[data-ave-modal]").forEach(t=>{t.addEventListener("click",e=>{e.target.hasAttribute("data-ave-modal-close")&&ke(t)}),t.querySelectorAll("[data-ave-modal-dismiss]").forEach(e=>{e.addEventListener("click",n=>{n.preventDefault(),ke(t)})})}),document.addEventListener("keydown",t=>{if(t.key==="Escape"){const e=document.querySelector("[data-ave-modal].is-active");e&&ke(e)}})}let Ot=null;const A=(t="success",e="",n=4e3)=>{if(!Ot&&(Ot=document.getElementById("toast-container"),!Ot)){console.error(g("toast.container_not_found"));return}const a={success:g("toast.defaults.success"),danger:g("toast.defaults.error"),warning:g("toast.defaults.warning"),info:g("toast.defaults.info")},r={success:g("toast.titles.success"),danger:g("toast.titles.error"),warning:g("toast.titles.warning"),info:g("toast.titles.info")},i=document.createElement("div");i.className=`toast toast-${t}`;const s=(e||a[t]||a.info).split(`
`).map(c=>`<p>${c}</p>`).join("");i.innerHTML=`
        <div class="toast-title">${r[t]||r.info}</div>
        <div class="toast-message">${s}</div>
    `,Ot.appendChild(i),requestAnimationFrame(()=>{i.classList.add("show")});const l=t==="danger"?Math.max(n,6e3):n;window.setTimeout(()=>{i.classList.remove("show"),window.setTimeout(()=>i.remove(),200)},l)};function rs(){Ot=document.getElementById("toast-container");const t=document.getElementById("ave-toast-data");if(t)try{const e=JSON.parse(t.textContent);e.type&&e.message&&A(e.type,e.message)}catch(e){console.error(g("toast.parse_error"),e)}document.querySelectorAll("[data-ave-toast-trigger]").forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();const a=e.getAttribute("data-ave-toast-trigger")||"success",r=e.getAttribute("data-ave-toast-message")||"";A(a,r)})})}const gn={SORTABLE:400,COLLAPSE:300},Ea={SORTABLE:"cubic-bezier(0.25, 0.8, 0.25, 1)"},is={OK:200},Hn={BYTE_FACTOR:1024,DECIMAL_PLACES:1};function os(t,e=Hn.DECIMAL_PLACES){const n=["B","KB","MB","GB","TB"];if(t<=0)return"0B";const a=Math.floor(Math.log(t)/Math.log(Hn.BYTE_FACTOR));return(t/Math.pow(Hn.BYTE_FACTOR,a)).toFixed(e)+n[a]}const Jr=new Map,oa=(t="")=>t?t.replace(/\]/g,"").replace(/\[/g,".").replace(/\.+/g,".").replace(/^\./,"").replace(/\.$/,"").toLowerCase():"",tr=(t,e)=>t.replace(/__INDEX__/g,e).replace(/__index__/g,e).replace(/__ITEM__/g,e).replace(/__item__/g,e).replace(/__TEMPLATE__/g,e).replace(/__template__/g,e);function nr(t){if(!t||!t.classList.contains("media-field-container"))return;const e=t.dataset.metaKey;if(!e||!e.includes("__item__")&&!e.includes("__template__"))return;const n=t.closest("[data-fieldset-item]");if(!n)return;const a=n.dataset.itemId;if(a===void 0)return;const r=tr(e,a),i=oa(r);if(t.dataset.metaKey=i,t.dataset.collection&&/__(ITEM|TEMPLATE)__/.test(t.dataset.collection)){const o=tr(t.dataset.collection,a);t.dataset.collection=o}t.querySelectorAll('input[data-uploaded-ids], input[data-deleted-ids], input[data-media-props="true"]').forEach(o=>{o.name&&o.name.includes(e)&&(o.name=o.name.replace(e,i))}),delete t.dataset.initialized}function ss(){Jr.forEach(t=>{t.uploadedIdsInput&&(t.uploadedIdsInput.value=t.uploadedIds.join(",")),t.deletedIdsInput&&(t.deletedIdsInput.value=t.deletedIds.join(",")),sa(t)})}function sa(t){const{fieldValueInput:e,container:n,collection:a,uploadedIds:r}=t;if(!e||!n)return;const i=n.querySelector("[data-media-grid]"),s=(i?i.querySelectorAll(".media-item"):[]).length>0||(r??[]).length>0;e.value=s?a:""}function vn(t=document){t.querySelectorAll(".media-field-container").forEach(e=>{if(e.dataset.initialized==="true")return;e.dataset.initialized="true";const n=e.dataset.multiple==="true",a=parseInt(e.dataset.maxFiles)||null,r=parseInt(e.dataset.maxSize)||null;e.dataset.accept;const i=e.dataset.uploadUrl,o=e.dataset.modelType||"",s=e.dataset.modelId||"",l=e.dataset.customPath||"",c=e.dataset.pathPrefix||"",u=e.closest("[data-field-name]"),d=u?.dataset.fieldName||"media",f=u?.dataset.fieldId||d.replace(/[^A-Za-z0-9_-]+/g,"-");let h=oa(e.dataset.metaKey||d);e.dataset.metaKey=h;const m=JSON.parse(e.dataset.propNames||"[]"),v=e.dataset.collection||"default",w=e.querySelector("[data-media-dropzone]"),_=e.querySelector(".media-file-input"),b=e.querySelector("[data-media-grid]"),M=e.querySelector(".media-bulk-actions"),E=e.querySelector("[data-uploaded-ids]"),y=e.querySelector("[data-deleted-ids]"),p=e.querySelector("[data-media-value]"),C=[],k=[],q=new Set,K=h||d;Jr.set(K,{uploadedIds:C,deletedIds:k,uploadedIdsInput:E,deletedIdsInput:y,fieldValueInput:p,fieldName:d,metaKey:h,collection:v,container:e}),sa({fieldValueInput:p,container:e,collection:v,uploadedIds:C}),w?.addEventListener("click",T=>{T.target.closest(".media-item")||_?.click()}),_?.addEventListener("change",T=>{Q(T.target.files)}),w?.addEventListener("dragover",T=>{T.preventDefault(),w.classList.add("dragover")}),w?.addEventListener("dragleave",()=>{w.classList.remove("dragover")}),w?.addEventListener("drop",T=>{T.preventDefault(),w.classList.remove("dragover"),Q(T.dataTransfer.files)});let W=!1,de=0;b?.addEventListener("mousedown",T=>{T.target.closest("[data-action]")||(W=!1,de=Date.now())}),b?.addEventListener("mousemove",()=>{Date.now()-de>200&&(W=!0)}),b?.addEventListener("mouseup",T=>{if(W){W=!1;return}const x=T.target.closest(".media-item");if(!x||T.target.closest("[data-action]"))return;const D=x.dataset.mediaId;D&&(x.classList.contains("selected")?(x.classList.remove("selected"),q.delete(parseInt(D))):(x.classList.add("selected"),q.add(parseInt(D))),lt())}),M?.addEventListener("click",T=>{const x=T.target.closest("[data-action]");x&&(x.dataset.action==="select-all"?wi():x.dataset.action==="deselect-all"?Ei():x.dataset.action==="delete-selected"&&Si())}),b?.addEventListener("click",T=>{const x=T.target.closest("[data-action]");if(!x)return;const D=x.closest(".media-item"),N=D?.dataset.mediaId;x.dataset.action==="delete"?(T.stopPropagation(),Ae(D,N)):x.dataset.action==="edit"?(T.stopPropagation(),Tt(D,N)):x.dataset.action==="crop"&&(T.stopPropagation(),Ce(D,N))}),n&&b&&I.create(b,{animation:gn.SORTABLE,easing:Ea.SORTABLE,handle:".media-drag-handle",onEnd:()=>{Me(),En()}});function Q(T){const x=Array.from(T);if(n){if(a&&b.querySelectorAll(".media-item").length+x.length>a){A("warning",g("media.max_files_reached",{count:a}));return}}else{if(x.length>1){A("warning",g("media.only_one_file"));return}b.querySelectorAll(".media-item").forEach(N=>{const O=N.dataset.mediaId;O?oe(O,N):N.remove()})}for(const D of x){if(r&&D.size>r*1024){A("warning",g("media.file_too_large",{name:D.name,size:(r/1024).toFixed(1)}));continue}ee(D)}_&&(_.value="")}function ee(T){const x=new FormData;x.append("files[]",T),x.append("collection",v),o&&x.append("model_type",o),s&&x.append("model_id",s),r&&x.append("max_size",r),l&&x.append("customPath",l);const D=e.dataset.pathStrategy;D&&x.append("pathStrategy",D),c&&x.append("pathPrefix",c);const N=w?.querySelector(".upload-progress"),O=N?.querySelector(".progress-fill"),F=N?.querySelector(".progress-text"),L=w?.querySelector(".upload-prompt");L&&(L.style.display="none"),N&&(N.style.display="block",N.classList.add("active"));const B=document.querySelector('meta[name="csrf-token"]')?.content,H=new XMLHttpRequest;H.upload.addEventListener("progress",ie=>{if(ie.lengthComputable&&O&&F){const Oe=ie.loaded/ie.total*100;O.style.width=Oe+"%",F.textContent=`Uploading... ${Math.round(Oe)}%`}}),H.addEventListener("load",()=>{if(H.status===is.OK)try{const ie=JSON.parse(H.responseText);ie.success&&ie.media?(ie.media.forEach(Oe=>{J(Oe),C.push(Oe.id)}),He(),A("success",g("media.upload_success"))):A("danger",g("media.upload_failed",{error:ie.message||g("media.upload_failed_unknown")}))}catch{A("danger",g("media.upload_failed_response"))}else A("danger",g("media.upload_failed",{error:H.statusText}));N&&(N.classList.remove("active"),N.style.display="none"),L&&(L.style.display="flex"),O&&(O.style.width="0%")}),H.addEventListener("error",()=>{A("danger",g("media.upload_failed_network")),N&&(N.classList.remove("active"),N.style.display="none"),L&&(L.style.display="flex")}),H.open("POST",i,!0),B&&H.setRequestHeader("X-CSRF-TOKEN",B),H.send(x)}function J(T){const x=document.getElementById("media-item-template-"+f);if(!x){console.error("Media item template not found:","media-item-template-"+f);return}const D=x.content.cloneNode(!0).querySelector(".media-item");D.dataset.mediaId=T.id;const N=T.mime_type&&T.mime_type.startsWith("image/");if(N){const L=D.querySelector(".media-image");L.src=T.url||T.preview_url,L.alt=T.file_name,L.style.display="block";const B=D.querySelector('[data-action="crop"]');B&&(B.style.display="flex")}else{const L=D.querySelector(".media-file-icon"),B=L.querySelector(".media-file-name");B.textContent=T.file_name,L.style.display="flex"}const O=D.querySelector('input[type="hidden"]');O.value=T.id;const F=D.querySelector(".media-item-footer");if(F){const L=F.querySelector(".media-filename");L&&(L.textContent=T.file_name);const B=F.querySelector(".media-size");B&&T.size&&(B.textContent=os(T.size),T.size>1048576&&B.classList.add("media-large-file"));const H=F.querySelector(".media-title i");H&&T.title&&(H.textContent=T.title)}if(b?.appendChild(D),N){const L=D.querySelector(".media-image");L&&L.src&&(e.dataset.previewUrl=L.src)}xe.emit("dom:updated",D),Me()}function oe(T,x){if(!T){x?.remove(),Me();return}const D=i.replace("/upload",`/${T}`),N=document.querySelector('meta[name="csrf-token"]')?.content;fetch(D,{method:"DELETE",headers:{"X-CSRF-TOKEN":N,Accept:"application/json","Content-Type":"application/json"}}).then(O=>O.json()).then(O=>{O.success?(x?.remove(),Me()):console.error("Failed to delete file:",O.message)}).catch(O=>{console.error("Delete error:",O)})}async function Ae(T,x){const D=T?.querySelector(".media-filename")?.textContent||"this file";if(!await Xt(g("media.confirm_remove"),{title:g("common.delete"),variant:"error",bodyParams:[D],confirmText:g("common.delete"),cancelText:g("common.cancel")}))return;if(!x){T?.remove(),Me(),He(),A("success",g("media.remove_success"));return}const O=i.replace("/upload",`/${x}`),F=document.querySelector('meta[name="csrf-token"]')?.content;fetch(O,{method:"DELETE",headers:{"X-CSRF-TOKEN":F,Accept:"application/json","Content-Type":"application/json"}}).then(L=>L.json()).then(L=>{if(L.success){T?.remove(),Me();const B=parseInt(x,10),H=C.indexOf(B);H!==-1&&C.splice(H,1),k.includes(B)||k.push(B),He(),A("success",g("media.delete_success"))}else A("danger",g("media.delete_failed",{error:L.message||g("media.delete_failed_unknown")}))}).catch(L=>{console.error("Delete error:",L),A("danger",g("media.delete_failed_network"))})}function Ce(T,x){const D=T?.querySelector(".media-filename")?.textContent||"Media",N=T?.querySelector("img");if(!N){A("danger",g("media.crop_load_failed"));return}const O=N.src,F=`
                <div class="cropper-modal-content">
                    <div class="cropper-image-container">
                        <img id="cropper-image-${x}" src="${O}" alt="Crop image" class="cropper-image">
                    </div>
                    <div class="cropper-options">
                        <div class="row">
                            <div class="col-6">
                                <div class="form-field">
                                    <label>Aspect Ratio:</label>
                                    <select id="cropper-ratio-${x}" class="form-control">
                                        <option value="">Free</option>
                                        <option value="16/9">16:9 (landscape)</option>
                                        <option value="9/16">9:16 (portrait)</option>
                                        <option value="4/3">4:3 (landscape)</option>
                                        <option value="3/4">3:4 (portrait)</option>
                                        <option value="1/1">1:1 (square)</option>
                                        <option value="3/2">3:2 (landscape)</option>
                                        <option value="2/3">2:3 (portrait)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-field">
                                    <label>Max Size (px):</label>
                                    <input type="number" id="cropper-max-size-${x}" class="form-control" placeholder="No limit" min="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `,L=fe({title:`Crop: ${D}`,body:F,type:"form",confirmText:g("media.crop_button"),cancelText:g("common.cancel"),size:"large",autoClose:!1,onConfirm:B=>{Ze(B,x,T)}});setTimeout(()=>{const B=document.getElementById(`cropper-image-${x}`),H=document.getElementById(`cropper-ratio-${x}`);if(!B){console.error("Cropper image element not found");return}const ie=new Vr(B,{aspectRatio:NaN,viewMode:1,autoCropArea:1,responsive:!0,guides:!0,grid:!0,highlight:!0,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0});L.cropper=ie,H?.addEventListener("change",Oe=>{const Sn=Oe.target.value;if(Sn==="")ie.setAspectRatio(NaN);else{const[Tn,xn]=Sn.split("/").map(Number);ie.setAspectRatio(Tn/xn)}})},100)}function Ze(T,x,D){const N=T.cropper;if(!N){A("danger",g("media.cropper_not_initialized"));return}N.getCanvasData();const O=N.getData(!0);if(O.width<=0||O.height<=0){A("danger",g("media.invalid_crop_area"));return}const F=Math.round(O.x),L=Math.round(O.y),B=Math.round(O.width),H=Math.round(O.height),ie=document.getElementById(`cropper-max-size-${x}`),Oe=ie?.value?parseInt(ie.value,10):null,Tn=document.getElementById(`cropper-ratio-${x}`)?.value||"",xn=document.querySelector('meta[name="csrf-token"]')?.content,Ti=i.replace("/upload",""),Ta={x:F,y:L,width:B,height:H,aspectRatio:Tn};Oe&&(Ta.maxSize=Oe),fetch(`${Ti}/${x}/crop`,{method:"POST",headers:{"X-CSRF-TOKEN":xn,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(Ta)}).then(Ee=>Ee.ok?Ee.json():Ee.json().then(jt=>{throw new Error(jt.message||`HTTP ${Ee.status}`)})).then(Ee=>{if(Ee.success){const jt=D.querySelector("img");if(jt){const zt=new Date().getTime();jt.src=Ee.media.url+"?t="+zt}if(Ee.media.size){const zt=D.querySelector(".media-size");if(zt){const xa=["B","KB","MB","GB"];let An=Ee.media.size,Cn=0;for(;An>=1024&&Cn<xa.length-1;)An/=1024,Cn++;const xi=An.toFixed(1)+xa[Cn];zt.textContent=xi}}A("success",g("media.crop_success")),Be(T)}else throw new Error(Ee.message||"Crop failed")}).catch(Ee=>{A("danger",g("media.crop_failed",{error:Ee.message}))})}function Tt(T,x){const D=T?.querySelector(".media-filename")?.textContent||"Media",N=T.querySelector(`input[data-media-props="true"][data-props-id="${x}"]`),O=N?JSON.parse(N.value||"{}"):{},F=m.map(L=>{const B=L.charAt(0).toUpperCase()+L.slice(1).replace(/_/g," "),H=`media-prop-${L}`;return`
                    <div class="form-field">
                        <label for="${H}">${B}</label>
                        <input type="text" id="${H}" name="${L}" class="form-control" value="${O[L]||""}" placeholder="Enter ${B.toLowerCase()}">
                    </div>
                `}).join("");fe({title:`Edit: ${D}`,body:F,type:"form",confirmText:g("common.save"),cancelText:g("common.cancel"),size:"default",autoClose:!1,onConfirm:L=>{Qe(L,x,T)}})}function Qe(T,x,D){const N=document.querySelector('meta[name="csrf-token"]')?.content,O={};T.querySelectorAll("input[name], textarea[name]").forEach(L=>{const B=L.getAttribute("name");B&&(O[B]=L.value||"")});const F=i.replace("/upload","");fetch(`${F}/${x}/props`,{method:"POST",headers:{"X-CSRF-TOKEN":N,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(O)}).then(L=>L.ok?L.json():L.json().then(B=>{throw new Error(B.message||`HTTP ${L.status}`)})).then(L=>{if(L.success){if(L.media?.props?.title){const ie=D.querySelector(".media-title i");ie&&(ie.textContent=L.media.props.title)}const B=e.dataset.metaKey||h||oa(d);let H=D.querySelector(`input[data-media-props="true"][data-props-id="${x}"]`);H?(H.name=`__media_props[${B}][${x}]`,H.setAttribute("data-media-props","true"),H.setAttribute("data-props-id",x)):(H=document.createElement("input"),H.type="hidden",H.name=`__media_props[${B}][${x}]`,H.setAttribute("data-media-props","true"),H.setAttribute("data-props-id",x),D.appendChild(H)),H.value=JSON.stringify(L.media.props),A("success",L.message||g("media.properties_saved")),Be(T)}else throw new Error(L.message||"Save failed")}).catch(L=>{A("danger",g("media.save_failed",{error:L.message}))})}function He(){E&&(E.value=C.join(",")),y&&(y.value=k.join(",")),sa({fieldValueInput:p,container:e,collection:v,uploadedIds:C})}function Me(){b?.querySelectorAll(".media-item")?.forEach((x,D)=>{const N=x.querySelector(".media-order");N&&(N.textContent=D+1)})}function En(){const T=b.querySelectorAll(".media-item"),x=[];if(T.forEach((O,F)=>{const L=O.dataset.mediaId;L&&x.push({id:parseInt(L),order:F})}),x.length===0)return;const D=document.querySelector('meta[name="csrf-token"]')?.content,N=i.replace("/upload","/reorder");fetch(N,{method:"POST",headers:{"X-CSRF-TOKEN":D,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({media:x,collection:v})}).then(O=>O.json()).then(O=>{O.success?A("success",g("media.reorder_success")):(console.error("Order update failed:",O.message),A("danger",g("media.reorder_failed")))}).catch(O=>{console.error("Order update error:",O),A("danger",g("media.reorder_failed"))})}function lt(){const T=q.size;T>0?(M.style.display="block",M.querySelector(".selected-count").textContent=T):(M.style.display="none",q.clear())}function wi(){b.querySelectorAll(".media-item").forEach(x=>{const D=x.dataset.mediaId;D&&(q.add(parseInt(D)),x.classList.add("selected"))}),lt()}function Ei(){b.querySelectorAll(".media-item").forEach(x=>{x.classList.remove("selected")}),q.clear(),lt()}async function Si(){const T=Array.from(q);if(T.length===0){A("warning",g("media.no_files_selected"));return}if(!await Xt(`You are going to remove ${T.length} file(s):`,{title:g("common.delete"),variant:"error",confirmText:g("common.delete"),cancelText:g("common.cancel")}))return;const D=document.querySelector('meta[name="csrf-token"]')?.content,N=i.replace("/upload","");fetch(`${N}/bulk-delete`,{method:"POST",headers:{"X-CSRF-TOKEN":D,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({ids:T})}).then(O=>O.ok?O.json():O.json().then(F=>{throw new Error(F.message||`HTTP ${O.status}`)})).then(O=>{if(O.success)T.forEach(F=>{const L=b.querySelector(`[data-media-id="${F}"]`);L&&L.remove();const B=parseInt(F,10),H=C.indexOf(B);H!==-1&&C.splice(H,1),k.includes(B)||k.push(B)}),q.clear(),lt(),Me(),He(),A("success",g("media.bulk_delete_success",{count:O.deleted}));else throw new Error(O.message||"Delete failed")}).catch(O=>{A("danger",g("media.bulk_delete_failed",{error:O.message}))})}xe.on("dom:updated",T=>{if(T.classList?.contains("media-field-container"))nr(T),vn(T);else{const x=T.querySelectorAll?.(".media-field-container")||[];x.forEach(D=>{nr(D)}),x.length>0&&vn(T)}})})}const ls="modulepreload",cs=function(t,e){return new URL(t,e).href},ar={},ds=function(e,n,a){let r=Promise.resolve();if(n&&n.length>0){let c=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),l=s?.nonce||s?.getAttribute("nonce");r=c(n.map(u=>{if(u=cs(u,a),u in ar)return;ar[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(a)for(let m=o.length-1;m>=0;m--){const v=o[m];if(v.href===u&&(!d||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":ls,d||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,v)=>{h.addEventListener("load",m),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return r.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})};function Zr(t=document){t.querySelectorAll("[data-ave-chips]").forEach(e=>{const n=e.querySelector("input");e.addEventListener("click",()=>{n?.focus()}),e.addEventListener("keydown",a=>{if(!n||a.key!=="Enter")return;const r=n.value.trim();if(!r)return;a.preventDefault();const i=document.createElement("span");i.className="chip",i.innerHTML=`${r} <span class="chip-remove" data-ave-chip-remove>&times;</span>`,e.insertBefore(i,n),n.value=""}),e.addEventListener("click",a=>{const r=a.target.closest("[data-ave-chip-remove]");if(!r)return;a.preventDefault(),r.closest(".chip")?.remove()})})}let la=[],rr=!1;const yn=t=>{la.forEach(e=>{e!==t&&e.classList.remove("is-open")})},us=(t,e,n,a,r)=>{const i=()=>{const o=r.filter(c=>c.querySelector("input")?.checked);if(!o.length){n.textContent=a,n.classList.add("select-dropdown__placeholder");return}const s=o.map(c=>c.getAttribute("data-label")||c.textContent.trim()),l=s.length>3?`${s.length} options selected`:s.join(", ");n.textContent=l,n.classList.remove("select-dropdown__placeholder")};r.forEach(o=>{const s=o.querySelector('input[type="checkbox"]');s&&(o.classList.toggle("is-selected",s.checked),s.addEventListener("change",()=>{o.classList.toggle("is-selected",s.checked),i()}),o.addEventListener("click",l=>{l.target!==s&&(s.checked=!s.checked,s.dispatchEvent(new Event("change",{bubbles:!0})))}))}),i(),e.addEventListener("click",o=>{o.preventDefault();const s=!t.classList.contains("is-open");yn(t),t.classList.toggle("is-open",s)})},fs=(t,e,n,a,r)=>{const i=()=>{const o=r.find(s=>s.querySelector("input")?.checked);o?(n.textContent=o.getAttribute("data-label")||o.textContent.trim(),n.classList.remove("select-dropdown__placeholder")):(n.textContent=a,n.classList.add("select-dropdown__placeholder")),r.forEach(s=>{const l=s.querySelector("input");s.classList.toggle("is-selected",!!l?.checked)})};r.forEach(o=>{const s=o.querySelector('input[type="radio"]');if(!s)return;o.classList.toggle("is-selected",s.checked);const l=()=>{s.checked&&(i(),t.classList.remove("is-open"))};s.addEventListener("change",l),o.addEventListener("click",c=>{c.target!==s&&(s.checked=!0,s.dispatchEvent(new Event("change",{bubbles:!0})))})}),i(),e.addEventListener("click",o=>{o.preventDefault();const s=!t.classList.contains("is-open");yn(t),t.classList.toggle("is-open",s)})},hs=(t,e)=>{const n=t.querySelector("[data-ave-select-dropdown-search]");n&&n.addEventListener("input",()=>{const a=n.value.trim().toLowerCase();e.forEach(r=>{const o=(r.getAttribute("data-label")||r.textContent||"").toLowerCase().includes(a);r.classList.toggle("is-hidden",!!a&&!o)})})};function Qr(t=document){const e=Array.from(t.querySelectorAll("[data-ave-select-dropdown]"));e.length&&(e.forEach(n=>{la.includes(n)||la.push(n)}),e.forEach(n=>{const a=n.querySelector("[data-ave-select-toggle]"),r=n.querySelector("[data-ave-select-label]"),i=n.querySelector("[data-ave-select-menu]");if(!a||!r||!i)return;const o=a.getAttribute("data-placeholder")||r.textContent.trim();r.classList.add("select-dropdown__placeholder");const s=Array.from(i.querySelectorAll("[data-ave-select-option]")),l=n.getAttribute("data-ave-select-dropdown")||"single";l==="multi"?us(n,a,r,o,s):fs(n,a,r,o,s),l==="search"&&hs(n,s)}),rr||(document.addEventListener("click",n=>{n.target.closest("[data-ave-select-dropdown]")||yn()}),document.addEventListener("keydown",n=>{n.key==="Escape"&&yn()}),rr=!0))}function ps(t){const n=t.closest(".slug-input-wrapper")?.querySelector(".slug-loader");n&&(n.style.display="block"),t.classList.add("is-loading")}function ms(t){const n=t.closest(".slug-input-wrapper")?.querySelector(".slug-loader");n&&(n.style.display="none"),t.classList.remove("is-loading")}async function gs(t,e,n,a){try{const r=document.querySelector('meta[name="csrf-token"]')?.content||"",i=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,Accept:"application/json"},body:JSON.stringify({text:t,separator:e,locale:n})});return i.ok?(await i.json()).slug||null:(console.error(`Slug API returned status ${i.status}`),null)}catch(r){return console.error("Failed to generate slug:",r),null}}function vs(t){const e=t.dataset.slugSource;if(!e){console.warn("Slug field missing data-slug-source:",t);return}const n=document.querySelector(`[name="${e}"]`);if(!n){console.warn(`Source field not found: ${e}`);return}const a=t.dataset.slugSeparator||"-",r=t.dataset.slugLocale||null,i=t.dataset.slugApiUrl;if(!i){console.error("Slug field missing data-slug-api-url");return}let o=null;t.addEventListener("focus",async function(){if(!this.value.trim()){const l=n.value.trim();if(l){o&&(o.abort(),o=null),ps(this);const c=new AbortController;o=c;try{const u=await gs(l,a,r,i);u!==null&&o===c&&(this.value=u)}finally{ms(this),o===c&&(o=null)}}}})}function ei(t=document){t.querySelectorAll("[data-slug-field]").forEach(vs)}function ti(t=document){t.querySelectorAll("[data-password-toggle]").forEach(n=>{n.addEventListener("click",function(a){a.preventDefault(),a.stopImmediatePropagation();const r=this.closest(".password-input-wrapper"),i=r?.querySelector("[data-password-input]"),o=this.querySelector(".icon-eye"),s=this.querySelector(".icon-eye-off");!r||!i||(i.type==="password"?(i.type="text",r.classList.add("password-shown"),o&&o.classList.add("hidden"),s&&s.classList.remove("hidden")):(i.type="password",r.classList.remove("password-shown"),o&&o.classList.remove("hidden"),s&&s.classList.add("hidden")))},!0)})}function ni(t=document){t.querySelectorAll("[data-ave-option-cards]").forEach(e=>{const n=e.querySelectorAll(".option-card"),a=()=>{n.forEach(r=>{const i=r.querySelector("input");r.classList.toggle("selected",!!i?.checked)})};n.forEach(r=>{const i=r.querySelector("input");i&&(i.addEventListener("change",()=>{if(i.type==="radio"){n.forEach(o=>{const s=o.querySelector("input");o.classList.toggle("selected",s===i)});return}r.classList.toggle("selected",i.checked)}),r.addEventListener("click",o=>{o.target!==i&&(i.type==="radio"?(i.checked=!0,i.dispatchEvent(new Event("change",{bubbles:!0}))):(i.checked=!i.checked,i.dispatchEvent(new Event("change",{bubbles:!0}))))}))}),a()})}function Xe(t,e=null,n=null){if(t){if(!e||!n){const a=t.querySelector(".fieldset-item-header, [data-head-title-field], [data-head-preview-field]");if(!a)return;e=e||a.dataset.headTitleField,n=n||a.dataset.headPreviewField}e&&ys(t,e),n&&bs(t,n)}}function ys(t,e){if(!t||!e)return;const n=t.querySelector("[data-item-title]");if(!n)return;let a=t.querySelector(`[name$="[${e}]"]`);a||(a=t.querySelector(`[name*="[${e}]"]`)),a&&a.value?(n.textContent=a.value,n.style.display="block"):n.style.display="none",ai(t)}function ai(t){const e=t.querySelector("[data-item-placeholder]");if(!e)return;const n=t.querySelector("[data-item-title]"),a=t.querySelector("[data-item-preview]"),r=n&&n.style.display!=="none"&&n.textContent.trim(),i=a&&a.style.display!=="none"&&a.style.backgroundImage;!r&&!i?e.style.display="flex":e.style.display="none"}function bs(t,e){if(!t||!e)return;const n=t.querySelector("[data-item-preview]");if(!n)return;const a=t.querySelector(`[data-field-name*="${e}"]`);if(!a){n.style.backgroundImage="",n.style.display="none";return}let r=null;if(r=a.dataset.previewUrl,!r){const i=a.querySelector(".media-preview img");i&&i.src&&(r=i.src)}r&&r.length>0?(n.style.backgroundImage=`url('${r}')`,n.style.display="block"):(n.style.backgroundImage="",n.style.display="none"),ai(t)}const ri=new WeakMap,ca=new Map;function ws(t,e,n){if(!t){console.error("Cannot register sortable: container is null");return}ri.set(t,n),ca.set(e,t)}function nn(t){const e=ca.get(t);return e?document.contains(e)?ri.get(e)||null:(ca.delete(t),null):null}let it=0;const ii="fieldset-editing";function Es(t="default"){return it++,it===1&&document.body.classList.add(ii),it}function Xn(t="default"){return it>0&&it--,it===0&&document.body.classList.remove(ii),it}function oi(t=document){t.querySelectorAll("[data-fieldset].fieldset-cards-view").forEach(e=>{if(e.dataset.cardsInitialized==="true")return;const n=e.querySelector("[data-fieldset-items]"),a=e.dataset.fieldName;e.dataset.cardsInitialized="true",e.addEventListener("input",r,!0),e.addEventListener("change",r,!0),e.addEventListener("mediaChanged",i,!0),e.addEventListener("click",o=>{const s=o.target.closest('[data-action="close-sidebar"]');if(s){const u=s.closest("[data-item-index]");if(u){o.stopPropagation(),u.classList.remove("is-editing"),Xn(),Xe(u);const d=nn(a);d&&d.option("disabled",!1),n.classList.remove("sortable-disabled")}return}if(o.target.closest('[data-action="delete"]'))return;const c=o.target.closest(".fieldset-card-header");if(c){const u=c.closest("[data-item-index]");if(u){u.classList.add("is-editing"),Es();const d=nn(a);d&&d.option("disabled",!0),n.classList.add("sortable-disabled")}return}}),document.addEventListener("keydown",o=>{if(o.key==="Escape"){const s=e.querySelector(".fieldset-item.is-editing");if(s){Xe(s),s.classList.remove("is-editing"),Xn();const l=nn(a);l&&l.option("disabled",!1),n.classList.remove("sortable-disabled")}}}),document.addEventListener("click",o=>{if(o.target===document.body||o.target.tagName==="HTML"){const s=e.querySelector(".fieldset-item.is-editing");if(s){Xe(s),s.classList.remove("is-editing"),Xn();const l=nn(a);l&&l.option("disabled",!1),n.classList.remove("sortable-disabled")}}});function r(o){const s=o.target.closest("[data-item-index]");s&&Xe(s)}function i(o){const s=o.target.closest("[data-item-index]");s&&Xe(s)}})}let Yn=null;async function Ss(){return Yn||(Yn=ds(()=>import("./editors.js"),[],import.meta.url)),Yn}function si(t){br(t),Zr(t),ni(t),Qr(t),ti(t),ei(t),vn(t),oi(t)}async function li(t){let e=null;try{e=await Ss()}catch(r){console.error("Failed to load editors bundle",r);return}const{initCodeEditor:n,initRichEditor:a}=e;typeof n=="function"&&n(t),typeof a=="function"&&a(t)}function Ts(){xe.on("dom:updated",t=>{si(t),li(t)})}function xs(t=document){t.querySelectorAll("[data-fieldset]").forEach(e=>{const n=e.dataset.fieldName,a=e.querySelector("[data-fieldset-items]"),r=document.getElementById(`fieldset-template-${n}`),i=e.querySelector('[data-action="add"]'),o=e.dataset.sortable==="true",s=e.dataset.collapsible==="true",l=parseInt(e.dataset.minItems)||0,c=parseInt(e.dataset.maxItems)||null;if(!r){console.error(`FieldSet template not found: fieldset-template-${n}`);return}let u=null;const d=()=>Array.from(a.querySelectorAll("[data-field-id]")).map(E=>parseInt(E.value,10)).filter(Number.isInteger),f=()=>{const E=new Set(d());let y=0;for(;E.has(y);)y++;return y},h=(E,y)=>E.replace(/__INDEX__/g,y).replace(/__index__/g,y).replace(/__ITEM__/g,y).replace(/__item__/g,y).replace(/__TEMPLATE__/g,y).replace(/__template__/g,y),m=(E,y,p)=>{[E,...E.querySelectorAll("*")].forEach(k=>{Array.from(k.attributes||[]).forEach(q=>{const K=h(q.value,p);K!==q.value&&k.setAttribute(q.name,K)}),Object.entries(k.dataset||{}).forEach(([q,K])=>{const W=h(K,p);W!==K&&(k.dataset[q]=W)})}),E.dataset.itemIndex=y,E.dataset.itemId=p};if(o){const E=e.classList.contains("fieldset-cards-view"),y={animation:gn.SORTABLE,easing:Ea.SORTABLE,ghostClass:"sortable-ghost",dragClass:"sortable-drag",disabled:!E,onEnd:()=>{b()}};E||(y.handle=".fieldset-drag-handle"),u=I.create(a,y),ws(e,n,u)}i&&i.addEventListener("click",()=>{const E=a.querySelectorAll(".fieldset-item").length;if(c&&E>=c){alert(g("fieldset.max_items_reached",{count:c}));return}const y=r.content.cloneNode(!0);a.appendChild(y);const p=a.lastElementChild;if(!p){console.error("Failed to add fieldset item");return}const C=f();m(p,E,C);const k=p.querySelector("[data-field-id]");k&&(k.value=C),p.querySelectorAll(".media-field-container").forEach(q=>{q.dataset.initialized="false"}),si(p),li(p),xe.emit("dom:updated",p),b(),Xe(p)}),a.addEventListener("click",async E=>{const y=E.target.closest('[data-action="delete"]');if(!y)return;const p=y.closest(".fieldset-item");if(!p)return;const C=a.querySelectorAll(".fieldset-item").length;if(l>0&&C<=l){ns(g("fieldset.min_items_required",{count:l}),{title:g("fieldset.deletion_blocked"),variant:"warning",confirmText:g("fieldset.ok_button")});return}await Xt(g("fieldset.confirm_delete"),{title:g("fieldset.delete_item"),variant:"error",confirmText:g("fieldset.delete_button"),cancelText:g("fieldset.cancel_button")})&&(p.remove(),b())}),s&&a.addEventListener("click",E=>{const y=E.target.closest('[data-action="collapse"]');if(!y)return;const p=y.closest(".fieldset-item");if(!p)return;const C=p.querySelector(".fieldset-item-fields");if(!C)return;p.classList.contains("collapsed")?(p.classList.remove("collapsed"),C.style.maxHeight=C.scrollHeight+"px",setTimeout(()=>{C.style.maxHeight=""},gn.COLLAPSE)):(C.style.maxHeight=C.scrollHeight+"px",C.offsetHeight,C.style.maxHeight="0",p.classList.add("collapsed"))});const v=e.querySelector('[data-action="collapse-all"]');v&&v.addEventListener("click",()=>{a.querySelectorAll(".fieldset-item").forEach(y=>{if(!y.classList.contains("collapsed")){const p=y.querySelector(".fieldset-item-fields");p&&(p.style.maxHeight=p.scrollHeight+"px",p.offsetHeight,p.style.maxHeight="0",y.classList.add("collapsed"))}})});const w=e.querySelector('[data-action="expand-all"]');w&&w.addEventListener("click",()=>{a.querySelectorAll(".fieldset-item").forEach(y=>{if(y.classList.contains("collapsed")){const p=y.querySelector(".fieldset-item-fields");p&&(y.classList.remove("collapsed"),p.style.maxHeight=p.scrollHeight+"px",setTimeout(()=>{p.style.maxHeight=""},300))}})});const _=e.querySelector('[data-action="toggle-sort"]');if(_&&u){const E=y=>{[v,w].forEach(p=>{p&&(p.disabled=!y,p.classList.toggle("is-disabled",!y))})};E(!_.checked),_.addEventListener("change",y=>{y.target.checked?(e.classList.add("sort-mode"),u.option("disabled",!1),E(!1),a.querySelectorAll(".fieldset-item").forEach(k=>{const q=k.querySelector(".fieldset-item-fields");q&&(q.style.maxHeight="0",k.classList.add("collapsed"))})):(e.classList.remove("sort-mode"),u.option("disabled",!0),E(!0),a.querySelectorAll(".fieldset-item").forEach(k=>{const q=k.querySelector(".fieldset-item-fields");q&&(k.classList.remove("collapsed"),q.style.maxHeight="")}))})}function b(){a.querySelectorAll(".fieldset-item").forEach((y,p)=>{y.dataset.itemIndex=p;const C=y.querySelector(".fieldset-item-number");C&&(C.textContent=p+1);const k=y.querySelector(".fieldset-item-order");k&&(k.textContent=p+1)})}b(),M(),a.addEventListener("input",E=>{const y=E.target.closest(".fieldset-item");y&&Xe(y)}),a.addEventListener("mediaChanged",E=>{const y=E.target.closest(".fieldset-item");y&&Xe(y)});function M(){a.querySelectorAll(".fieldset-item").forEach(y=>Xe(y))}})}function As(t=document){t.querySelectorAll('.toggle[data-toggle="toggle"]').forEach(n=>{if(n.dataset.initialized==="true")return;n.dataset.initialized="true";const a=n.querySelector('input[type="checkbox"]'),r=n.querySelector(".toggle-on"),i=n.querySelector(".toggle-off");if(!a||!r||!i)return;const o=()=>{n.classList.toggle("off",!a.checked),r.classList.toggle("active",a.checked),i.classList.toggle("active",!a.checked)};o(),ci(n),a.addEventListener("change",o),n.addEventListener("click",()=>{a.checked=!a.checked,a.dispatchEvent(new Event("change"))})}),Cs()}function ci(t){const e=t.querySelector(".toggle-on"),n=t.querySelector(".toggle-off");if(!e||!n)return;const a=e.offsetWidth,r=n.offsetWidth,i=Math.max(a,r);i>0&&(t.style.minWidth=i+5+"px",e.style.width=i+"px",e.style.minWidth=i+"px",n.style.width=i+"px",n.style.minWidth=i+"px")}let ir=!1;function Cs(){ir||(ir=!0,xe.on("tab:activated",({pane:t})=>{requestAnimationFrame(()=>{t.querySelectorAll('.toggle[data-toggle="toggle"]').forEach(n=>{ci(n)})})}))}function _s(t=document){t.querySelectorAll("[data-tags-field]").forEach(n=>{n.dataset.tagsField;const a=n.querySelector(".tags-input"),r=n.parentElement.querySelector(".tags-hidden-input"),i=a?.dataset.tagsSeparator||",";a&&(a.addEventListener("keydown",o=>{if(o.key==="Enter"||o.key===i){o.preventDefault();const s=a.value.trim();s&&($n(n,s,r,i),a.value="")}if(o.key==="Tab"){const s=a.value.trim();s&&(o.preventDefault(),$n(n,s,r,i),a.value="")}}),a.addEventListener("blur",()=>{const o=a.value.trim();o&&($n(n,o,r,i),a.value="")}),n.addEventListener("click",o=>{o.target.classList.contains("chip-remove")&&(o.target.closest(".chip").remove(),di(n,r,i))}))})}function $n(t,e,n,a){const r=t.querySelectorAll(".chip-text"),i=e.toLowerCase();for(const l of r)if(l.textContent.toLowerCase()===i)return;const o=document.createElement("div");o.className="chip",o.tabIndex=0,o.innerHTML=`
        <span class="chip-text">${Ls(e)}</span>
        <span class="chip-remove" data-tag-remove>&times;</span>
    `;const s=t.querySelector(".tags-input");s.parentElement.insertBefore(o,s),di(t,n,a)}function di(t,e,n){const a=t.querySelectorAll(".chip-text"),r=Array.from(a).map(i=>i.textContent.trim());e.value=r.join(n.trim()+" ")}function Ls(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,n=>e[n])}function Ds(t=document){t.querySelectorAll("[data-file-field]").forEach(n=>{const a=n.dataset.fileField,r=n.dataset.customPath||"",i=n.dataset.pathPrefix||"",o=n.querySelector("[data-file-input]"),s=n.querySelector("[data-file-delete]"),l=n.querySelector(".file-path-input"),c=n.querySelector("[data-file-progress]"),u=n.querySelector("[data-file-input-area]"),d=n.querySelector(".file-preview");if(!o||!l){console.error("[Ave] File upload: missing required elements for field",a);return}o.addEventListener("change",f=>{const h=f.target.files[0];if(!h)return;c.style.display="block";const m=c.querySelector(".progress-fill");m.style.width="0%";const v=new FormData;v.append("file",h),v.append("field",a);const w=n.closest("form"),_=w?.dataset.modelType||"",b=w?.dataset.modelId||"";_&&v.append("model_type",_),b&&v.append("model_id",b),r&&v.append("customPath",r),i&&v.append("pathPrefix",i);const M=document.querySelector('meta[name="csrf-token"]')?.content,E=new XMLHttpRequest;E.upload.addEventListener("progress",y=>{if(y.lengthComputable){const p=y.loaded/y.total*100;m.style.width=p+"%"}}),E.addEventListener("load",()=>{if(c.style.display="none",E.status===200)try{const y=JSON.parse(E.responseText);y.success&&y.path?(l.value=y.path,Ms(n,h.name,y.path),u.classList.add("hidden"),o.value=""):alert(g("upload.upload_failed_with_error",{error:y.message||g("media.upload_failed_unknown")}))}catch(y){console.error("[Ave] Error parsing upload response:",y),alert(g("upload.upload_processing_error"))}else console.error("[Ave] Upload failed with status:",E.status),alert(g("upload.upload_failed_with_status",{status:E.status}))}),E.addEventListener("error",()=>{c.style.display="none",console.error("[Ave] Upload error occurred"),alert(g("upload.upload_error"))}),E.open("POST","/admin/api/file-upload"),E.setRequestHeader("X-Requested-With","XMLHttpRequest"),M&&E.setRequestHeader("X-CSRF-TOKEN",M),E.send(v)}),s&&s.addEventListener("click",f=>{f.preventDefault(),f.stopPropagation(),l.value="",d&&d.remove(),u.classList.remove("hidden"),o.value=""})})}function Ms(t,e,n){const a=t.querySelector(".file-preview");a&&a.remove();const r=document.createElement("div");r.className="file-preview",r.innerHTML=`
        <div class="file-item">
            <div class="file-info">
                <span class="file-name">${or(e)}</span>
                <span class="file-size" data-file-path="${or(n)}"></span>
            </div>
            <button type="button" class="file-delete-btn" data-file-delete style="cursor: pointer;">
                <i class="voyager-trash"></i> Remove
            </button>
        </div>
    `;const i=t.querySelector("[data-file-input-area]");i.parentElement.insertBefore(r,i);const o=r.querySelector("[data-file-delete]");o&&o.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();const l=t.querySelector(".file-path-input");l.value="",r.remove(),t.querySelector("[data-file-input-area]").classList.remove("hidden");const u=t.querySelector("[data-file-input]");u.value=""})}function or(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,n=>e[n])}function Os(t=document){br(t),Zr(t),ni(t),Qr(t),ti(t),As(t),ei(t),_s(t),Ds(t),vn(t),xs(t),oi(t),t.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",()=>{ss()})})}function Is(){document.querySelectorAll('[data-ave-tabs="nav"]').forEach(e=>{const n=e.closest("[data-ave-tabs-root]"),a=n?Array.from(n.querySelectorAll("[data-ave-tab-pane]")):[],r=Array.from(e.querySelectorAll("[data-ave-tab-target]"));r.length===0||a.length===0||(ks(r,a,n),r.forEach(i=>{i.addEventListener("click",o=>{o.preventDefault();const s=i.getAttribute("data-ave-tab-target");if(!s)return;const l=a.find(c=>c.matches(s));l&&ui(r,a,i,l,n)})}))})}function ui(t,e,n,a,r){t.forEach(i=>{i.classList.toggle("active",i===n);const o=i.querySelector("a");o&&o.setAttribute("aria-selected",String(i===n))}),e.forEach(i=>{i.classList.toggle("active",i===a)}),xe.emit("tab:activated",{pane:a,tabsRoot:r})}function ks(t,e,n){const a=document.querySelector(".form-field.has-error");if(!a)return;const r=e.find(s=>s.contains(a));if(!r)return;const i=r.getAttribute("id"),o=t.find(s=>s.getAttribute("data-ave-tab-target")===`#${i}`);o&&ui(t,e,o,r,n)}function qs(){document.querySelectorAll(".alert-dismissible .close").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const n=t.closest(".alert");n&&n.remove()})})}function Ps(){document.querySelectorAll("[data-ave-accordion-toggle]").forEach(t=>{const e=t.getAttribute("data-ave-accordion-toggle");if(!e)return;const n=e.startsWith("#")?e:`#${e}`,a=document.querySelector(n);a&&t.addEventListener("click",r=>{r.preventDefault();const o=!(t.getAttribute("aria-expanded")==="true");t.setAttribute("aria-expanded",String(o)),a.classList.toggle("show",o)})})}const Ns=t=>{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();let n=!1;try{n=document.execCommand("copy")}catch{n=!1}return document.body.removeChild(e),n};function Rs(){document.querySelectorAll("[data-ave-copy]").forEach(t=>{t.addEventListener("click",async e=>{e.preventDefault();const n=t.getAttribute("data-ave-copy");if(!n)return;const a=document.querySelector(n);if(!a)return;const r=a.value??a.textContent??"";try{await navigator.clipboard.writeText(r),A("success",g("common.copied_to_clipboard"))}catch{Ns(r)?A("success",g("common.copied_to_clipboard")):A("danger",g("common.copy_failed"))}})})}function Bs(){rs(),Is(),qs(),as(),Ps(),Rs()}function Hs(){if(!document.body.classList.contains("ave-login"))return;const t=document.forms[0],e=t?.querySelector('button[type="submit"]'),n=t?.querySelector('[name="email"]'),a=t?.querySelector('[name="password"]');if(!t||!e||!n||!a)return;e.addEventListener("click",i=>{if(t.checkValidity()){const o=e.querySelector(".signingin"),s=e.querySelector(".signin");o&&s&&(o.classList.remove("hidden"),s.classList.add("hidden"))}else i.preventDefault()}),n.focus();const r=document.getElementById("emailGroup");r&&r.classList.add("focused")}function Xs(t){const{title:e,fetchUrl:n,saveUrl:a,fetchParams:r={},onSuccess:i=null,onError:o=null,confirmText:s=g("common.save"),cancelText:l=g("common.cancel"),size:c="default"}=t,u=fe({title:g("common.loading"),body:`<div class="spinner">${g("common.loading_form")}</div>`,type:"alert",size:"small"});Ys(n,r).then(({formHtml:d,currentData:f})=>{ke(u);const h=fe({title:e,body:d,type:"form",size:c,confirmText:s,cancelText:l,onConfirm:m=>{$s(m,a,i,o)}});xe.emit("dom:updated",h)}).catch(d=>{ke(u),A("danger",g("common.failed_to_load_form",{error:d.message})),o&&o(d)})}function Ys(t,e={}){const n=document.querySelector('meta[name="csrf-token"]')?.content,a=new URLSearchParams(e).toString(),r=a?`${t}?${a}`:t;return fetch(r,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":n}}).then(i=>{if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return i.json()}).then(i=>{if(!i.success)throw new Error(i.message||"Failed to load form");return{formHtml:i.formHtml||"",currentData:i.currentData||{}}})}function $s(t,e,n=null,a=null){const r=document.querySelector('meta[name="csrf-token"]')?.content,i=new FormData;t.querySelectorAll("input, textarea, select").forEach(o=>{o.name&&(o.type==="checkbox"?i.append(o.name,o.checked?"1":"0"):o.type==="radio"?o.checked&&i.append(o.name,o.value):i.append(o.name,o.value))}),fetch(e,{method:"POST",headers:{"X-CSRF-TOKEN":r,Accept:"application/json"},body:i}).then(o=>o.ok?o.json():o.json().then(s=>{throw new Error(s.message||`HTTP ${o.status}`)})).then(o=>{if(o.success)A("success",o.message||g("common.saved_successfully")),n&&n(o),ke(t);else throw new Error(o.message||"Save failed")}).catch(o=>{A("danger",g("common.failed_to_save",{error:o.message})),a&&a(o)})}const Ws="[data-ave-action]",sr=document.querySelector('meta[name="csrf-token"]'),Wn=sr?sr.content:"";function Fs(t){t.dataset.actionLoading="true",t.classList.add("is-loading"),t.setAttribute("aria-busy","true"),(t.tagName==="BUTTON"||t.tagName==="INPUT")&&(t.disabled=!0)}function js(t){t.dataset.actionLoading="false",t.classList.remove("is-loading"),t.removeAttribute("aria-busy"),(t.tagName==="BUTTON"||t.tagName==="INPUT")&&(t.disabled=!1)}function zs(){al(),document.addEventListener("click",Us,!0)}function Us(t){const e=t.target.closest(Ws);if(!e||(t.preventDefault(),e.dataset.actionLoading==="true"))return;const n=e.dataset.aveAction,a=e.dataset.actionEndpoint;if(!a){console.warn("Ave action missing endpoint",e);return}if(n==="bulk"&&hi().length===0){A("warning",g("actions.no_selection"));return}const r=Vs(e.dataset.actionConfig),i=e.dataset.actionConfirmMessage,o=async(s={},l={})=>{Fs(e);try{await Ks(e,a,s,l)}finally{js(e)}};if(Array.isArray(r.form)&&r.form.length>0){rl(e,r,o);return}if(e.dataset.actionConfirm==="true"){fe({title:r.label||g("actions.confirm"),body:i||g("actions.confirm"),type:"confirm",variant:e.dataset.variant||"primary",confirmText:r.label||g("common.confirm"),onConfirm:()=>o()});return}o()}async function Ks(t,e,n={},a={}){const r=t.dataset.aveAction,i=new FormData,o=t.dataset.actionMethod||"POST",s=t.dataset.actionAccept||"application/json";Wn&&!i.has("_token")&&i.append("_token",Wn),i.append("_action",t.dataset.aveActionKey||""),r==="bulk"&&hi().forEach(d=>i.append("ids[]",d)),r==="form"&&Gs(i,t.dataset.actionFormSelector||"#ave-resource-form"),r==="global"&&new URLSearchParams(window.location.search).forEach((f,h)=>{i.append(h,f)}),Js(i,n);const l=await fetch(e,{method:o,headers:{"X-Requested-With":"XMLHttpRequest",Accept:s,"X-CSRF-TOKEN":Wn},body:i}),c=await Zs(l);if(!l.ok){const d=Qs(l,c);throw a&&a.modal&&tl(a.modal,c?.errors??{},d),A("danger",d),new Error(d)}if(a&&a.modal&&fi(a.modal),c.modal_form===!0){Xs({title:c.title||"Form",fetchUrl:c.fetch_url,saveUrl:c.save_url,size:c.size||"large",onSuccess:d=>{d.reload&&setTimeout(()=>{window.location.reload()},500)}});return}c.message&&A("success",c.message);const u=c.redirect??null;if(u){window.location.href=u;return}c.reload!==!1&&(window.dispatchEvent(new CustomEvent("ave:action:completed",{detail:{type:r,key:t.dataset.aveActionKey,result:c.result??null}})),setTimeout(()=>{window.location.reload()},500))}function Vs(t){if(!t)return{};try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse action config",e),{}}}function Gs(t,e){const n=document.querySelector(e);if(!n)return;new FormData(n).forEach((r,i)=>{t.append(i,r)})}function Js(t,e){!e||typeof e!="object"||Object.entries(e).forEach(([n,a])=>{if(a!=null){if(Array.isArray(a)){a.forEach(r=>t.append(`${n}[]`,r));return}t.append(n,a)}})}async function Zs(t){const e=t.headers.get("content-type");return e&&e.includes("application/json")?t.json():{message:await t.text()}}function Qs(t,e){return t.status===422&&e?.errors?el(e.errors):e&&typeof e.message=="string"&&e.message.trim()!==""?e.message:t.statusText||FALLBACK_VALIDATION_MESSAGE}function el(t){if(!t||typeof t!="object")return FALLBACK_VALIDATION_MESSAGE;const e=Object.values(t).flatMap(a=>Array.isArray(a)?a:[a]).map(a=>(a??"").toString().trim()).filter(a=>a.length>0);if(e.length===0)return FALLBACK_VALIDATION_MESSAGE;const n=e.slice(0,3);return e.length>n.length&&n.push(` +${e.length-n.length} `),n.join(`
`)}function fi(t){const e=t.querySelector("[data-ave-action-form]");e&&(e.querySelectorAll(".form-error").forEach(n=>n.remove()),e.querySelectorAll(".form-group.has-error").forEach(n=>{n.classList.remove("has-error")}))}function tl(t,e={},n=""){const a=t.querySelector("[data-ave-action-form]");if(!a)return;fi(t);const r=Object.entries(e);if(r.length===0){if(n){const o=document.createElement("div");o.className="form-error text-danger small",o.textContent=n,a.prepend(o)}return}r.forEach(([o,s])=>{const l=`[name="${nl(o)}"]`,c=a.querySelectorAll(l);if(c.length===0)return;const d=(Array.isArray(s)?s:[s]).map(f=>(f??"").toString().trim()).filter(Boolean).join(" ")||FALLBACK_VALIDATION_MESSAGE;c.forEach(f=>{const h=f.closest(".form-group")||f.parentElement;if(!h)return;h.classList.add("has-error");const m=document.createElement("div");m.className="form-error text-danger small",m.textContent=d,h.appendChild(m)})});const i=a.querySelector(".form-group.has-error input, .form-group.has-error select, .form-group.has-error textarea");i&&i.focus()}function nl(t){return window.CSS&&typeof window.CSS.escape=="function"?window.CSS.escape(t):t.replace(/([ !"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\\\$1")}function al(){const t=document.getElementById("bulk-actions-toolbar"),e=document.getElementById("select-all"),n=Array.from(document.querySelectorAll(".row-selector")),a=document.getElementById("selected-count");if(!t||n.length===0)return;const r=()=>{const i=n.filter(o=>o.checked);if(a&&(a.textContent=i.length),t.classList.toggle("is-visible",i.length>0),e){const o=i.length===n.length;e.checked=o,e.indeterminate=i.length>0&&!o}};e&&e.addEventListener("change",i=>{n.forEach(o=>{o.checked=i.target.checked,Fn(o)}),r()}),n.forEach(i=>{i.addEventListener("change",()=>{Fn(i),r()}),Fn(i)}),r()}function hi(){return Array.from(document.querySelectorAll(".row-selector:checked")).map(t=>t.value)}function Fn(t){const e=t.closest(".resource-row");e&&e.classList.toggle("is-selected",t.checked)}function rl(t,e,n){const a=Array.isArray(e.form)?e.form:[],r=fe({title:e.label||g("actions.confirm"),body:il(a),type:"form",variant:t.dataset.variant||"primary",confirmText:e.label||g("common.confirm"),autoClose:!1,onConfirm:async()=>{const i=r.querySelector("[data-ave-action-form]"),o=ol(i);try{await n(o,{modal:r}),Be(r)}catch(s){console.warn("Ave action failed",s)}},onCancel:()=>Be(r)});return r}function il(t){return`
        <form data-ave-action-form>
            ${t.map(n=>{const a=n.name||n.key||"";if(!a)return"";const r=n.label||a,i=(n.type||"text").toLowerCase(),o=n.required?"required":"",s=n.placeholder||"",l=n.help?`<small class="help-block">${n.help}</small>`:"";if(i==="textarea")return`
                    <div class="form-group">
                        <label class="control-label">${r}</label>
                        <textarea class="form-control" name="${a}" ${o} placeholder="${s}"></textarea>
                        ${l}
                    </div>
                `;if(i==="select"&&Array.isArray(n.options)){const c=n.options.map(u=>`<option value="${u.value}">${u.label}</option>`).join("");return`
                    <div class="form-group">
                        <label class="control-label">${r}</label>
                        <select class="form-control" name="${a}" ${o}>
                            ${c}
                        </select>
                        ${l}
                    </div>
                `}return i==="checkbox"?`
                    <div class="form-group">
                        <label class="control-label">
                            <input type="checkbox" name="${a}" value="1" />
                            ${r}
                        </label>
                        ${l}
                    </div>
                `:`
                <div class="form-group">
                    <label class="control-label">${r}</label>
                    <input type="${i}" class="form-control" name="${a}" ${o} placeholder="${s}" />
                    ${l}
                </div>
            `}).join("")}
        </form>
    `}function ol(t){if(!t)return{};const e=new FormData(t),n={};return e.forEach((a,r)=>{n[r]!==void 0?(Array.isArray(n[r])||(n[r]=[n[r]]),n[r].push(a)):n[r]=a}),n}const lr=document.querySelector('meta[name="csrf-token"]'),sl=lr?lr.content:"";let cr=!1;function ll(){dr(),window.Ave?.events&&!window.Ave.inlineEditingBound&&(window.Ave.events.on("dom:updated",dr),window.Ave.inlineEditingBound=!0)}function dr(){cr||(document.addEventListener("click",cl,!0),cr=!0)}function cl(t){const e=t.target.closest("[data-ave-inline-toggle]");if(!e||(t.preventDefault(),e.dataset.loading==="true"))return;const n=e.dataset.endpoint,a=e.dataset.field;if(!n||!a){console.warn("Inline toggle missing endpoint or field",e);return}const r=e.dataset.trueValue??"1",i=e.dataset.falseValue??"0",s=(e.dataset.currentValue??i)===String(r)?i:r;ur(e,!0),dl(n,a,s).then(l=>{const c=l.canonical??l.value,u=String(c)===String(r);e.dataset.currentValue=String(c),e.classList.toggle("is-on",u),e.classList.toggle("is-off",!u);const d=e.querySelector(".toggle-dot"),f=u?e.dataset.onColor||"#16a34a":e.dataset.offColor||"#d1d5db";d&&(d.style.backgroundColor=f),A("success",g("inline.saved"))}).catch(l=>{console.error("Inline toggle failed",l),A("danger",l.message||g("inline.error"))}).finally(()=>ur(e,!1))}async function dl(t,e,n){const a=await fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":sl,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({field:e,value:n})});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.message||g("common.error"))}return a.json()}function ur(t,e){t.dataset.loading=e?"true":"false",t.classList.toggle("is-loading",e),t.setAttribute("aria-busy",e?"true":"false")}function ul(){fl(),hl()}function fl(){document.querySelectorAll(".per-page-select").forEach(e=>{e.addEventListener("change",function(){const n=parseInt(this.value,10);if(!n||n<1)return;const a=new URL(window.location.href);a.searchParams.set("per_page",n.toString()),a.searchParams.delete("page"),window.location.href=a.toString()})})}function hl(){document.querySelectorAll(".pagination-jump-input").forEach(e=>{e.addEventListener("keypress",function(n){n.key==="Enter"&&(n.preventDefault(),pl(this))}),e.addEventListener("blur",function(){const n=da();(this.value===""||parseInt(this.value,10)<1)&&(this.value=n)})})}function pl(t){const e=parseInt(t.value,10),n=parseInt(t.dataset.lastPage,10),a=t.dataset.baseUrl;if(!e||e<1||e>n){t.value=da();return}if(e===da())return;const r=new URL(window.location.href);new URL(a,window.location.origin),e===1?r.searchParams.delete("page"):r.searchParams.set("page",e),window.location.href=r.toString()}function da(){const t=new URLSearchParams(window.location.search);return parseInt(t.get("page")||"1",10)}const fr=document.querySelector('meta[name="csrf-token"]'),ml=fr?fr.content:"";function gl(t=document){t.querySelectorAll('[data-tree="true"]').forEach(e=>{vl(e)})}function vl(t){const e=t.dataset.slug,n=t.dataset.parentColumn,a=t.dataset.orderColumn,r=parseInt(t.dataset.maxDepth||"5"),i=t.dataset.updateEndpoint;yl(t),pi(t,r,e,n,a,i)}function yl(t){const e=document.querySelector(".tree-expand-all"),n=document.querySelector(".tree-collapse-all");e&&e.addEventListener("click",()=>{t.querySelectorAll(".tree-list").forEach(a=>{a.style.display=""}),t.querySelectorAll('[data-action="collapse"]').forEach(a=>{a.classList.remove("hidden")}),t.querySelectorAll('[data-action="expand"]').forEach(a=>{a.classList.add("hidden")})}),n&&n.addEventListener("click",()=>{t.querySelectorAll(".tree-item > .tree-list").forEach(a=>{a.style.display="none"}),t.querySelectorAll('[data-action="collapse"]').forEach(a=>{a.classList.add("hidden")}),t.querySelectorAll('[data-action="expand"]').forEach(a=>{a.classList.remove("hidden")})}),t.querySelectorAll(".dd-item-btns button").forEach(a=>{a.addEventListener("click",r=>{r.preventDefault();const i=a.dataset.action,o=a.closest(".tree-item"),s=o.querySelector(":scope > .tree-list");s&&(i==="collapse"?(s.style.display="none",a.classList.add("hidden"),o.querySelector('[data-action="expand"]')?.classList.remove("hidden")):(s.style.display="",a.classList.add("hidden"),o.querySelector('[data-action="collapse"]')?.classList.remove("hidden")))})})}let hr=new Map;function pi(t,e,n,a,r,i){t.querySelectorAll(".tree-list").forEach(s=>{if(hr.has(s))return;const l=I.create(s,{group:{name:"tree-nested",pull:!0,put:!0},animation:gn.SORTABLE,easing:Ea.SORTABLE,handle:".tree-drag-handle",fallbackOnBody:!0,swapThreshold:5,direction:"vertical",emptyInsertThreshold:1,ghostClass:"sortable-ghost",dragClass:"sortable-drag",onMove:c=>{const u=c.dragged,d=c.to,f=wl(d),h=mi(u);if(f+h>e)return!1},onEnd:c=>{bl(t),setTimeout(()=>{pi(t,e,n,a,r,i)},50),Sl(t,n,a,r,i)}});hr.set(s,l)})}function bl(t){t.querySelectorAll(".tree-item").forEach(e=>{const n=e.querySelector(":scope > .tree-list"),a=e.querySelector(".dd-item-btns");if(n&&n.querySelectorAll(":scope > .tree-item").length>0)if(n&&n.classList.remove("tree-list-empty"),a)a.style.display="";else{const i=e.querySelector(".dd-handle");if(i){const o=document.createElement("div");o.className="dd-item-btns",o.innerHTML=`
                        <button type="button" data-action="expand" class="hidden" aria-label="Expand">
                            <i class="voyager-angle-down"></i>
                        </button>
                        <button type="button" data-action="collapse" aria-label="Collapse">
                            <i class="voyager-angle-up"></i>
                        </button>
                    `,i.insertBefore(o,i.querySelector(".dd-content")),o.querySelectorAll("button").forEach(s=>{s.addEventListener("click",l=>{l.preventDefault();const c=s.dataset.action,u=s.closest(".tree-item"),d=u.querySelector(":scope > .tree-list");d&&(c==="collapse"?(d.style.display="none",s.classList.add("hidden"),u.querySelector('[data-action="expand"]')?.classList.remove("hidden")):(d.style.display="",s.classList.add("hidden"),u.querySelector('[data-action="collapse"]')?.classList.remove("hidden")))})})}}else n&&n.classList.add("tree-list-empty"),a&&(a.style.display="none")})}function wl(t){let e=0,n=t;for(;n&&!n.matches('[data-tree="true"]');)n.matches(".tree-list")&&e++,n=n.parentElement;return e}function mi(t){let e=1;const n=t.querySelector(":scope > .tree-list");return n&&n.querySelectorAll(":scope > .tree-item").forEach(r=>{const i=mi(r);e=Math.max(e,1+i)}),e}function El(t){const e=t.querySelector(":scope > .tree-list");return e?gi(e):[]}function gi(t){const e=[];return t.querySelectorAll(":scope > .tree-item").forEach(a=>{const r=parseInt(a.dataset.id),i=a.querySelector(":scope > .tree-list"),o={id:r};if(i){const s=gi(i);s.length>0&&(o.children=s)}e.push(o)}),e}function Sl(t,e,n,a,r){const i=El(t);fetch(r,{method:"POST",headers:{"X-CSRF-TOKEN":ml,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({tree:i,parent_column:n,order_column:a})}).then(o=>o.json()).then(o=>{o.success?A("success",o.message||g("tree.updated")):A("danger",o.message||g("tree.update_failed"))}).catch(o=>{console.error("Tree update error:",o),A("danger",g("tree.structure_update_failed"))})}const pr=document.querySelector('meta[name="csrf-token"]'),Tl=pr?pr.content:"";function xl(t=document){t.querySelectorAll('[data-sortable="true"]').forEach(e=>{Al(e)})}function Al(t){const e=t.dataset.slug,n=t.dataset.orderColumn||"order",a=t.dataset.updateEndpoint;if(t.sortableInstance)return;const r=I.create(t,{animation:150,handle:".sortable-drag-handle",ghostClass:"sortable-ghost",dragClass:"sortable-drag",onStart:function(i){console.log("Drag started:",i.item)},onEnd:function(i){console.log("Drag ended. Old index:",i.oldIndex,"New index:",i.newIndex),i.oldIndex!==i.newIndex&&_l(t,e,n,a)}});t.sortableInstance=r}function Cl(t,e){const n=t.querySelectorAll("tr[data-id]"),a=[];return n.forEach((r,i)=>{const o=parseInt(r.dataset.id);a.push({id:o,[e]:i})}),a}function _l(t,e,n,a){const r=Cl(t,n);fetch(a,{method:"POST",headers:{"X-CSRF-TOKEN":Tl,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({items:r})}).then(i=>i.json()).then(i=>{i.success?A("success",i.message||g("sortable.order_updated")):(A("danger",i.message||g("sortable.order_update_failed")),window.location.reload())}).catch(i=>{console.error("Sortable table update error:",i),A("danger",g("sortable.table_order_failed")),setTimeout(()=>window.location.reload(),1500)})}async function vi(t,e){const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"},body:JSON.stringify(e)});if(!n.ok){const a=await n.json().catch(()=>({}));throw new Error(a.message||"Request failed")}return n.json()}function Ll(){const t=document.querySelectorAll("tbody.group-items-tbody[data-group-id]");t.length!==0&&t.forEach(e=>{const n={slug:e.dataset.slug,groupId:e.dataset.groupId,groupColumn:e.dataset.groupColumn,orderColumn:e.dataset.orderColumn,updateEndpoint:e.dataset.updateEndpoint,groupUpdateEndpoint:e.dataset.groupUpdateEndpoint};I.create(e,{animation:150,handle:".sortable-drag-handle",ghostClass:"sortable-ghost",dragClass:"sortable-drag",group:{name:"shared-groups",pull:!0,put:!0},onEnd:a=>Dl(a,n)})})}function Dl(t,e){const n=t.item.dataset.id,a=t.to,r=t.from,i=a.dataset.groupId,o=r.dataset.groupId;i!==o?Ml(n,a,r,i,o,e,t):t.oldIndex!==t.newIndex&&Ol(a,i,e)}function Ml(t,e,n,a,r,i,o){Il(t,a,i.groupColumn,i.groupUpdateEndpoint).then(()=>ua(e,a,i.orderColumn,i.updateEndpoint)).then(()=>{if(n.querySelectorAll(".sortable-row").length>0)return ua(n,r,i.orderColumn,i.updateEndpoint)}).then(()=>{A("success",g("sortable.item_moved"))}).catch(s=>{console.error("Error updating groups:",s),A("danger",g("sortable.item_move_error")),n.insertBefore(o.item,n.children[o.oldIndex])})}function Ol(t,e,n){ua(t,e,n.orderColumn,n.updateEndpoint).then(()=>{A("success",g("sortable.order_updated"))}).catch(a=>{console.error("Error saving order:",a),A("danger",g("sortable.order_error"))})}async function Il(t,e,n,a){return vi(a,{item_id:t,group_column:n,group_id:e})}async function ua(t,e,n,a){const r=t.querySelectorAll(".sortable-row"),i={};return r.forEach((o,s)=>{i[o.dataset.id]=s+1}),vi(a,{order:i,order_column:n,group_id:e})}function kl(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}function ql(t){t.hasAttribute("required")&&(t.dataset.hadRequired="true",t.removeAttribute("required")),t.hasAttribute("minlength")&&(t.dataset.hadMinlength=t.getAttribute("minlength"),t.removeAttribute("minlength")),t.hasAttribute("maxlength")&&(t.dataset.hadMaxlength=t.getAttribute("maxlength"),t.removeAttribute("maxlength")),t.hasAttribute("pattern")&&(t.dataset.hadPattern=t.getAttribute("pattern"),t.removeAttribute("pattern")),t.hasAttribute("min")&&(t.dataset.hadMin=t.getAttribute("min"),t.removeAttribute("min")),t.hasAttribute("max")&&(t.dataset.hadMax=t.getAttribute("max"),t.removeAttribute("max")),t.hasAttribute("step")&&(t.dataset.hadStep=t.getAttribute("step"),t.removeAttribute("step"))}function Pl(){jn(),new MutationObserver(()=>{jn()}).observe(document.documentElement,{attributes:!0,attributeFilter:["style","class"],subtree:!0,characterData:!1}),document.addEventListener("submit",e=>{const n=e.target;n&&n.tagName==="FORM"&&jn(n)})}function jn(t=document){const e=t.querySelectorAll("input[required], input[minlength], input[maxlength], input[pattern], input[min], input[max], input[step], textarea[required], textarea[minlength], textarea[maxlength], textarea[pattern], select[required]");Array.from(e).forEach(n=>{kl(n)||ql(n)})}function Nl(){const t=document.querySelector('meta[name="ave-route-prefix"]')?.getAttribute("content")||"admin";document.querySelectorAll('a[href^="#cache-clear-"]').forEach(e=>{e.addEventListener("click",async n=>{n.preventDefault(),n.stopPropagation();const a=e.getAttribute("href").replace("#cache-clear-","");try{const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),o=await(await fetch(`/${t}/cache/clear/${a}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,Accept:"application/json"}})).json();o.success?A("success",o.message):A("danger",o.message||g("cache.error"))}catch(r){console.error("Cache clear error:",r),A("danger",g("cache.error"))}})})}let Sa="",st={},ce=null;function Rl(){if(!document.getElementById("fm-file-list"))return;const e=document.getElementById("fm-routes");e&&(st={list:e.dataset.list,read:e.dataset.read,save:e.dataset.save,directory:e.dataset.directory,upload:e.dataset.upload,delete:e.dataset.delete,rename:e.dataset.rename});const n=document.getElementById("fm-current-path-input");n&&(Sa=n.value),Bl(),Hl()}function Bl(){document.addEventListener("click",async t=>{const e=t.target.closest(".fm-navigate");if(!e)return;t.preventDefault();const n=e.dataset.fmPath??"";await Xl(n)})}function Hl(){document.addEventListener("click",async n=>{const a=n.target.closest(".fm-edit");if(!a)return;n.preventDefault();const r=a.dataset.fmPath;await Yl(r)}),document.addEventListener("click",async n=>{const a=n.target.closest(".fm-delete");if(!a)return;n.preventDefault();const r=a.dataset.fmPath;await Ul(r)}),document.addEventListener("click",n=>{const a=n.target.closest(".fm-rename-btn");if(!a)return;n.preventDefault();const r=a.dataset.fmPath,i=a.dataset.fmName;Vl(r,i)});const t=document.getElementById("fm-upload-btn");t&&t.addEventListener("click",jl);const e=document.getElementById("fm-new-folder-btn");e&&e.addEventListener("click",Wl)}async function Xl(t){window.location.href=`${window.location.pathname}?path=${encodeURIComponent(t)}`}async function Yl(t){try{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(`${st.read}?path=${encodeURIComponent(t)}`,{headers:{Accept:"application/json","X-CSRF-TOKEN":e}})).json();if(a.error){A("danger",a.error);return}ce=fe({title:a.name,body:`<div class="form-group">
                <textarea id="fm-editor-content" class="form-control" rows="20" style="font-family: monospace; width: 100%;">${yi(a.content)}</textarea>
            </div>`,type:"form",size:"large",confirmText:g("common.save"),cancelText:g("common.cancel"),autoClose:!1,onConfirm:async r=>{const i=r.querySelector("#fm-editor-content").value;await $l(t,i)}})}catch(e){console.error("Read error:",e),A("danger",g("file_manager.error"))}}async function $l(t,e){try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),r=await(await fetch(st.save,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({path:t,content:e})})).json();r.success?(A("success",g("file_manager.file_saved")),ce&&(Be(ce),ce=null)):A("danger",r.error||g("file_manager.error"))}catch(n){console.error("Save error:",n),A("danger",g("file_manager.error"))}}function Wl(){ce=fe({title:g("file_manager.new_folder"),body:`<div class="form-group">
            <label>${g("file_manager.folder_name")}</label>
            <input type="text" class="form-control" id="fm-folder-name" placeholder="${g("file_manager.folder_name_placeholder")}">
        </div>`,type:"form",confirmText:g("common.create"),cancelText:g("common.cancel"),autoClose:!1,onConfirm:async t=>{const e=t.querySelector("#fm-folder-name").value.trim();e&&await Fl(e)}})}async function Fl(t){try{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(st.directory,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":e},body:JSON.stringify({path:Sa,name:t})})).json();a.success?(A("success",g("file_manager.folder_created")),ce&&(Be(ce),ce=null),window.location.reload()):A("danger",a.error||g("file_manager.error"))}catch(e){console.error("Create folder error:",e),A("danger",g("file_manager.error"))}}function jl(){ce=fe({title:g("file_manager.upload_file"),body:`<div class="form-group">
            <input type="file" class="form-control" id="fm-upload-input">
        </div>`,type:"form",confirmText:g("file_manager.upload"),cancelText:g("common.cancel"),autoClose:!1,onConfirm:async t=>{const e=t.querySelector("#fm-upload-input");e&&e.files.length&&await zl(e.files[0])}})}async function zl(t){const e=new FormData;e.append("path",Sa),e.append("file",t);try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),r=await(await fetch(st.upload,{method:"POST",headers:{Accept:"application/json","X-CSRF-TOKEN":n},body:e})).json();r.success?(A("success",g("file_manager.file_uploaded")),ce&&(Be(ce),ce=null),window.location.reload()):A("danger",r.error||g("file_manager.error"))}catch(n){console.error("Upload error:",n),A("danger",g("file_manager.error"))}}async function Ul(t){ce=fe({title:g("modals.delete_confirm"),body:g("file_manager.confirm_delete"),type:"confirm",variant:"warning",confirmText:g("common.delete"),cancelText:g("common.cancel"),onConfirm:async()=>{await Kl(t)}})}async function Kl(t){try{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(st.delete,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":e},body:JSON.stringify({path:t})})).json();a.success?(A("success",g("file_manager.deleted")),window.location.reload()):A("danger",a.error||g("file_manager.error"))}catch(e){console.error("Delete error:",e),A("danger",g("file_manager.error"))}}function Vl(t,e){ce=fe({title:g("file_manager.rename"),body:`<div class="form-group">
            <label>${g("file_manager.new_name")}</label>
            <input type="text" class="form-control" id="fm-rename-input" value="${yi(e)}">
        </div>`,type:"form",confirmText:g("common.save"),cancelText:g("common.cancel"),autoClose:!1,onConfirm:async n=>{const a=n.querySelector("#fm-rename-input").value.trim();a&&await Gl(t,a)}})}async function Gl(t,e){try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),r=await(await fetch(st.rename,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({path:t,name:e})})).json();r.success?(A("success",g("file_manager.renamed")),ce&&(Be(ce),ce=null),window.location.reload()):A("danger",r.error||g("file_manager.error"))}catch(n){console.error("Rename error:",n),A("danger",g("file_manager.error"))}}function yi(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}function Jl(){const t=document.getElementById("ave-storage-link-data");if(t)try{const e=JSON.parse(t.textContent);e.missing&&Zl(e)}catch(e){console.error("Failed to parse storage link data:",e)}}function Zl(t){fe({title:t.title,body:t.message,type:"alert",variant:"warning",confirmText:t.createButton,size:"small",autoClose:!1,onConfirm:async e=>{const n=e.querySelector("[data-modal-confirm]");n&&(n.disabled=!0,n.textContent="...");try{const r=await(await fetch(t.createUrl,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"}})).json();r.success?(A("success",r.message),e.classList.remove("is-active"),setTimeout(()=>e.remove(),300)):(A("error",r.message),n&&(n.disabled=!1,n.textContent=t.createButton))}catch(a){console.error("Failed to create storage link:",a),A("error","Failed to create storage link"),n&&(n.disabled=!1,n.textContent=t.createButton)}}})}class bi{constructor(e={}){this.subscribers=new Map,this.computedCache=new Map,this.computedDeps=new Map,this.state=this.createReactive(e,[])}createReactive(e,n=[]){return this.isObject(e)?Array.isArray(e)?this.createReactiveArray(e,n):new Proxy(e,{get:(a,r)=>{this.trackDependency(n.concat(r));const i=a[r];return this.isObject(i)?this.createReactive(i,n.concat(r)):i},set:(a,r,i)=>(a[r]===i||(a[r]=i,this.notify(n.concat(r))),!0),deleteProperty:(a,r)=>(r in a&&(delete a[r],this.notify(n.concat(r))),!0)}):e}createReactiveArray(e,n){const a=this,r=["push","pop","shift","unshift","splice","sort","reverse"];return new Proxy(e,{get(o,s){if(a.trackDependency(n.concat(s)),r.includes(s))return function(...c){const u=Array.prototype[s].apply(o,c);return a.notify(n),u};const l=o[s];return a.isObject(l)?a.createReactive(l,n.concat(s)):l},set(o,s,l){return o[s]===l||(o[s]=l,a.notify(n.concat(s))),!0},deleteProperty(o,s){return s in o&&(delete o[s],a.notify(n)),!0}})}watch(e,n=null){typeof e=="function"&&(n=e,e=[]);const a=Array.isArray(e)?e:e.split("."),r=this.pathToKey(a);return this.subscribers.has(r)||this.subscribers.set(r,new Set),this.subscribers.get(r).add(n),()=>{const i=this.subscribers.get(r);i&&i.delete(n)}}notify(e){const n=this.pathToKey(e),a=this.subscribers.get(n);a&&a.forEach(i=>i(this.getByPath(e),e));for(let i=e.length-1;i>=0;i--){const o=e.slice(0,i),s=this.pathToKey(o),l=this.subscribers.get(s);l&&l.forEach(c=>c(this.getByPath(o),o))}const r=this.subscribers.get("");r&&r.forEach(i=>i(this.state,[]))}trackDependency(e){}getByPath(e){return e.reduce((n,a)=>n?.[a],this.state)}pathToKey(e){return Array.isArray(e)?e.join("."):e}isObject(e){return e!==null&&(typeof e=="object"||Array.isArray(e))}}window.Reactive=bi;class Ql{constructor(e){this.config=e,this.translations=e.translations,console.log("DatabaseTableEditor init"),console.log("config.table:",e.table),console.log("config.oldTable:",e.oldTable),this.state=new bi({table:e.oldTable||e.table,errors:{},isDirty:!1}),console.log("Reactive state initialized"),console.log("state.table:",this.state.state.table),console.log("state.table.columns:",this.state.state.table.columns),this.state.watch("table",()=>{this.state.state.isDirty=!0,this.validateTable(),this.render()}),window.dbConfig.table=this.state.state.table,this.init()}init(){this.render(),this.attachEventListeners(),this.validateTable()}attachEventListeners(){document.getElementById("btn-add-column")?.addEventListener("click",()=>{this.addColumn()}),document.getElementById("btn-add-timestamps")?.addEventListener("click",()=>{this.addTimestamps()}),document.getElementById("btn-add-softdeletes")?.addEventListener("click",()=>{this.addSoftDeletes()}),document.getElementById("database-form")?.addEventListener("submit",e=>{if(!this.validateTable())return e.preventDefault(),toastr.error("Please fix validation errors before saving"),!1;console.log("Submitting table data:",this.state.state.table);const n=JSON.stringify(this.state.state.table);console.log("Table JSON:",n),document.getElementById("table-data").value=n,window.dbConfig.table=this.state.state.table})}render(){const e=document.getElementById("columns-container"),n=document.getElementById("columns-table"),a=document.getElementById("no-columns-message");if(!e)return;const r=this.state.state.table.columns||[];if(r.length===0){a.style.display="block",n&&(n.style.display="none");return}a.style.display="none",n&&(n.style.display="table"),e.innerHTML="",r.forEach((i,o)=>{const s=this.renderColumn(i,o);e.appendChild(s)})}renderColumn(e,n){const a=document.createElement("tr");a.className="newTableRow",a.dataset.index=n;const r=this.state.state.errors[`columns.${n}`]||{};Object.keys(r).length>0&&a.classList.add("has-error");const i=document.createElement("td"),o=document.createElement("input");o.type="text",o.className="form-control",o.value=e.name||"",o.required=!0,o.pattern=this.config.identifierRegex,o.addEventListener("input",y=>this.updateColumn(n,"name",y.target.value)),i.appendChild(o);const s=document.createElement("td");s.appendChild(this.createTypeSelectSimple(e,n));const l=document.createElement("td"),c=document.createElement("input");c.type="number",c.className="form-control",c.value=e.length||"",c.min="0",c.addEventListener("input",y=>this.updateColumn(n,"length",y.target.value)),l.appendChild(c);const u=document.createElement("td"),d=document.createElement("input");d.type="checkbox",d.checked=!!e.notnull,d.addEventListener("change",y=>this.updateColumn(n,"notnull",y.target.checked)),u.appendChild(d);const f=document.createElement("td"),h=document.createElement("input");h.type="checkbox",h.checked=!!e.unsigned,h.addEventListener("change",y=>this.updateColumn(n,"unsigned",y.target.checked)),f.appendChild(h);const m=document.createElement("td"),v=document.createElement("input");v.type="checkbox",v.checked=!!e.autoincrement,v.addEventListener("change",y=>this.updateColumn(n,"autoincrement",y.target.checked)),m.appendChild(v);const w=document.createElement("td");w.appendChild(this.createIndexSelectSimple(e,n));const _=document.createElement("td"),b=document.createElement("input");b.type="text",b.className="form-control",b.value=e.default||"",b.addEventListener("input",y=>this.updateColumn(n,"default",y.target.value)),_.appendChild(b);const M=document.createElement("td"),E=document.createElement("div");return E.className="btn btn-danger delete-row",E.innerHTML='<i class="voyager-trash"></i>',E.addEventListener("click",()=>this.removeColumn(n)),M.appendChild(E),a.appendChild(i),a.appendChild(s),a.appendChild(l),a.appendChild(u),a.appendChild(f),a.appendChild(m),a.appendChild(w),a.appendChild(_),a.appendChild(M),a}createField(e,n,a,r,i,o={}){const s=document.createElement("div");s.className="db-field-group";const l=document.createElement("label");l.textContent=a,s.appendChild(l);const c=document.createElement("input");return c.type=e,c.value=r||"",c.className="form-control",Object.keys(o).forEach(u=>{c.setAttribute(u,o[u])}),c.addEventListener("input",u=>{this.updateColumn(i,n,u.target.value)}),s.appendChild(c),s}createCheckbox(e,n,a,r){const i=document.createElement("div");i.className="db-field-group checkbox";const o=document.createElement("input");o.type="checkbox",o.checked=!!a,o.id=`col-${r}-${e}`,o.addEventListener("change",l=>{this.updateColumn(r,e,l.target.checked)});const s=document.createElement("label");return s.htmlFor=o.id,s.textContent=n,i.appendChild(o),i.appendChild(s),i}createTypeSelectSimple(e,n){const a=document.createElement("select");a.className="form-control";const r=typeof e.type=="object"?e.type.name:e.type;return Object.keys(this.config.types).forEach(i=>{const o=document.createElement("optgroup");o.label=i,this.config.types[i].forEach(s=>{const l=document.createElement("option");l.value=s.name,l.textContent=s.name,l.selected=r===s.name,s.supported||(l.disabled=!0,l.textContent+=` (${this.translations.typeNotSupported})`),o.appendChild(l)}),a.appendChild(o)}),a.addEventListener("change",i=>{let o=null;for(const s in this.config.types){const l=this.config.types[s].find(c=>c.name===i.target.value);if(l){o=l;break}}o&&this.updateColumn(n,"type",{name:o.name,notSupported:o.supported===!1,notSupportIndex:o.notSupportIndex})}),a}createIndexSelectSimple(e,n){const a=document.createElement("select");return a.className="form-control",[{value:"",label:""},{value:"index",label:"INDEX"},{value:"unique",label:"UNIQUE"},{value:"primary",label:"PRIMARY"}].forEach(i=>{const o=document.createElement("option");o.value=i.value,o.textContent=i.label,o.selected=e.index===i.value,a.appendChild(o)}),a.addEventListener("change",i=>{this.updateColumn(n,"index",i.target.value)}),a}getTypeInfo(e){for(const n in this.config.types){const a=this.config.types[n].find(r=>r.name===e);if(a)return{...a,category:n}}return null}updateColumn(e,n,a){const r=this.state.state.table.columns;if(!r[e]){console.error("Column not found:",e);return}r[e][n]=a,this.state.notify(["table","columns",e,n])}addColumn(){const e=this.state.state.table.columns||[],n={name:`column_${e.length+1}`,type:{name:"string",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null};e.push(n),this.state.notify(["table","columns"])}removeColumn(e){if(!confirm("Are you sure you want to remove this column?"))return;this.state.state.table.columns.splice(e,1),this.state.notify(["table","columns"])}addTimestamps(){const e=this.state.state.table.columns||[],n=e.some(r=>r.name==="created_at"),a=e.some(r=>r.name==="updated_at");if(n&&a){toastr.info("Timestamps already exist");return}n||e.push({name:"created_at",type:{name:"datetime",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null}),a||e.push({name:"updated_at",type:{name:"datetime",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null}),this.state.notify(["table","columns"]),toastr.success("Timestamps added")}addSoftDeletes(){const e=this.state.state.table.columns||[];if(e.some(a=>a.name==="deleted_at")){toastr.info("Soft deletes already exist");return}e.push({name:"deleted_at",type:{name:"datetime",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null}),this.state.notify(["table","columns"]),toastr.success("Soft deletes added")}validateTable(){const e={},n=this.state.state.table.columns||[],a={};n.forEach((i,o)=>{(!i.name||i.name.trim()==="")&&(e[`columns.${o}`]=e[`columns.${o}`]||{},e[`columns.${o}`].name=this.translations.nameWarning),a[i.name]&&(e[`columns.${o}`]=e[`columns.${o}`]||{},e[`columns.${o}`].duplicate=this.translations.columnAlreadyExists.replace(":column",i.name)),a[i.name]=!0});const r=n.filter(i=>i.index==="primary");return r.length>1&&r.forEach((i,o)=>{if(o>0){const s=n.indexOf(i);e[`columns.${s}`]=e[`columns.${s}`]||{},e[`columns.${s}`].primary=this.translations.tableHasIndex}}),this.state.state.errors=e,Object.keys(e).length===0}}document.addEventListener("DOMContentLoaded",()=>{window.dbConfig&&(window.dbEditor=new Ql(window.dbConfig))});window.aveEvents=xe;window.Ave=window.Ave||{};window.Ave.events=xe;document.addEventListener("DOMContentLoaded",()=>{Pl(),Ts(),Hi(),Xi(),Bs(),Os(),Hs(),zs(),ll(),ul(),Ll(),gl(),xl(),Nl(),Rl(),Jl(),xe.emit("dom:updated",document);const t={confirm:Xt,createModal:fe,closeModal:ke,destroyModal:Be};xe.emit("ave:loaded",t),window.Ave=window.Ave||{},Object.assign(window.Ave,t)});window.addEventListener("load",()=>{const t=document.getElementById("ave-loader");t&&setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.style.display="none"},300)},200)});
