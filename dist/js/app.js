class Ci{constructor(){this.listeners={}}on(e,n){typeof e=="string"&&(e=[e]),e.forEach(a=>{this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(n)})}once(e,n){typeof e=="string"&&(e=[e]);const a=(...i)=>{n(...i),this.off(e,a)};this.on(e,a)}off(e,n){typeof e=="string"&&(e=[e]),e.forEach(a=>{this.listeners[a]&&(this.listeners[a]=this.listeners[a].filter(i=>i!==n))})}emit(e,n){this.listeners[e]&&this.listeners[e].forEach(a=>{try{a(n)}catch(i){console.error(`Error in event listener for '${e}':`,i)}})}listeners(e){return this.listeners[e]||[]}hasListeners(e){return(this.listeners[e]||[]).length>0}flush(e){e?this.listeners[e]=[]:this.listeners={}}}const xe=new Ci;/*!
 * perfect-scrollbar v1.5.6
 * Copyright 2024 Hyunje Jun, MDBootstrap and Contributors
 * Licensed under MIT
 */function Oe(t){return getComputedStyle(t)}function ve(t,e){for(var n in e){var a=e[n];typeof a=="number"&&(a=a+"px"),t.style[n]=a}return t}function Ut(t){var e=document.createElement("div");return e.className=t,e}var Ca=typeof Element<"u"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function Ke(t,e){if(!Ca)throw new Error("No element matching method supported");return Ca.call(t,e)}function pt(t){t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)}function _a(t,e){return Array.prototype.filter.call(t.children,function(n){return Ke(n,e)})}var ne={main:"ps",rtl:"ps__rtl",element:{thumb:function(t){return"ps__thumb-"+t},rail:function(t){return"ps__rail-"+t},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(t){return"ps--active-"+t},scrolling:function(t){return"ps--scrolling-"+t}}},gr={x:null,y:null};function vr(t,e){var n=t.element.classList,a=ne.state.scrolling(e);n.contains(a)?clearTimeout(gr[e]):n.add(a)}function yr(t,e){gr[e]=setTimeout(function(){return t.isAlive&&t.element.classList.remove(ne.state.scrolling(e))},t.settings.scrollingThreshold)}function _i(t,e){vr(t,e),yr(t,e)}var $t=function(e){this.element=e,this.handlers={}},br={isEmpty:{configurable:!0}};$t.prototype.bind=function(e,n){typeof this.handlers[e]>"u"&&(this.handlers[e]=[]),this.handlers[e].push(n),this.element.addEventListener(e,n,!1)};$t.prototype.unbind=function(e,n){var a=this;this.handlers[e]=this.handlers[e].filter(function(i){return n&&i!==n?!0:(a.element.removeEventListener(e,i,!1),!1)})};$t.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)};br.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return t.handlers[e].length===0})};Object.defineProperties($t.prototype,br);var St=function(){this.eventElements=[]};St.prototype.eventElement=function(e){var n=this.eventElements.filter(function(a){return a.element===e})[0];return n||(n=new $t(e),this.eventElements.push(n)),n};St.prototype.bind=function(e,n,a){this.eventElement(e).bind(n,a)};St.prototype.unbind=function(e,n,a){var i=this.eventElement(e);i.unbind(n,a),i.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(i),1)};St.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]};St.prototype.once=function(e,n,a){var i=this.eventElement(e),r=function(o){i.unbind(n,r),a(o)};i.bind(n,r)};function Kt(t){if(typeof window.CustomEvent=="function")return new CustomEvent(t);var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,void 0),e}function cn(t,e,n,a,i){a===void 0&&(a=!0),i===void 0&&(i=!1);var r;if(e==="top")r=["contentHeight","containerHeight","scrollTop","y","up","down"];else if(e==="left")r=["contentWidth","containerWidth","scrollLeft","x","left","right"];else throw new Error("A proper axis should be provided");Li(t,n,r,a,i)}function Li(t,e,n,a,i){var r=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5];a===void 0&&(a=!0),i===void 0&&(i=!1);var d=t.element;t.reach[l]=null,d[s]<1&&(t.reach[l]="start"),d[s]>t[r]-t[o]-1&&(t.reach[l]="end"),e&&(d.dispatchEvent(Kt("ps-scroll-"+l)),e<0?d.dispatchEvent(Kt("ps-scroll-"+c)):e>0&&d.dispatchEvent(Kt("ps-scroll-"+u)),a&&_i(t,l)),t.reach[l]&&(e||i)&&d.dispatchEvent(Kt("ps-"+l+"-reach-"+t.reach[l]))}function G(t){return parseInt(t,10)||0}function Di(t){return Ke(t,"input,[contenteditable]")||Ke(t,"select,[contenteditable]")||Ke(t,"textarea,[contenteditable]")||Ke(t,"button,[contenteditable]")}function Mi(t){var e=Oe(t);return G(e.width)+G(e.paddingLeft)+G(e.paddingRight)+G(e.borderLeftWidth)+G(e.borderRightWidth)}var ft={isWebKit:typeof document<"u"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window<"u"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator<"u"&&navigator.msMaxTouchPoints,isChrome:typeof navigator<"u"&&/Chrome/i.test(navigator&&navigator.userAgent)};function Ye(t){var e=t.element,n=Math.floor(e.scrollTop),a=e.getBoundingClientRect();t.containerWidth=Math.floor(a.width),t.containerHeight=Math.floor(a.height),t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,e.contains(t.scrollbarXRail)||(_a(e,ne.element.rail("x")).forEach(function(i){return pt(i)}),e.appendChild(t.scrollbarXRail)),e.contains(t.scrollbarYRail)||(_a(e,ne.element.rail("y")).forEach(function(i){return pt(i)}),e.appendChild(t.scrollbarYRail)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=La(t,G(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=G((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=La(t,G(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=G(n*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),Ii(e,t),t.scrollbarXActive?e.classList.add(ne.state.active("x")):(e.classList.remove(ne.state.active("x")),t.scrollbarXWidth=0,t.scrollbarXLeft=0,e.scrollLeft=t.isRtl===!0?t.contentWidth:0),t.scrollbarYActive?e.classList.add(ne.state.active("y")):(e.classList.remove(ne.state.active("y")),t.scrollbarYHeight=0,t.scrollbarYTop=0,e.scrollTop=0)}function La(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}function Ii(t,e){var n={width:e.railXWidth},a=Math.floor(t.scrollTop);e.isRtl?n.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth-e.contentWidth:n.left=t.scrollLeft,e.isScrollbarXUsingBottom?n.bottom=e.scrollbarXBottom-a:n.top=e.scrollbarXTop+a,ve(e.scrollbarXRail,n);var i={top:a,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?i.right=e.contentWidth-(e.negativeScrollAdjustment+t.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth-9:i.right=e.scrollbarYRight-t.scrollLeft:e.isRtl?i.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth*2-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:i.left=e.scrollbarYLeft+t.scrollLeft,ve(e.scrollbarYRail,i),ve(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),ve(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}function Oi(t){t.event.bind(t.scrollbarY,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarYRail,"mousedown",function(e){var n=e.pageY-window.pageYOffset-t.scrollbarYRail.getBoundingClientRect().top,a=n>t.scrollbarYTop?1:-1;t.element.scrollTop+=a*t.containerHeight,Ye(t),e.stopPropagation()}),t.event.bind(t.scrollbarX,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarXRail,"mousedown",function(e){var n=e.pageX-window.pageXOffset-t.scrollbarXRail.getBoundingClientRect().left,a=n>t.scrollbarXLeft?1:-1;t.element.scrollLeft+=a*t.containerWidth,Ye(t),e.stopPropagation()})}var Vt=null;function ki(t){Da(t,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"]),Da(t,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"])}function Da(t,e){var n=e[0],a=e[1],i=e[2],r=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=t.element,f=null,h=null,g=null;function v(w){w.touches&&w.touches[0]&&(w[i]=w.touches[0]["page"+c.toUpperCase()]),Vt===o&&(d[l]=f+g*(w[i]-h),vr(t,c),Ye(t),w.stopPropagation(),w.preventDefault())}function b(){yr(t,c),t[u].classList.remove(ne.state.clicking),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",b),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",b),Vt=null}function _(w){Vt===null&&(Vt=o,f=d[l],w.touches&&(w[i]=w.touches[0]["page"+c.toUpperCase()]),h=w[i],g=(t[a]-t[n])/(t[r]-t[s]),w.touches?(document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",v),document.addEventListener("mouseup",b)),t[u].classList.add(ne.state.clicking)),w.stopPropagation(),w.cancelable&&w.preventDefault()}t[o].addEventListener("mousedown",_),t[o].addEventListener("touchstart",_)}function Ni(t){var e=t.element,n=function(){return Ke(e,":hover")},a=function(){return Ke(t.scrollbarX,":focus")||Ke(t.scrollbarY,":focus")};function i(r,o){var s=Math.floor(e.scrollTop);if(r===0){if(!t.scrollbarYActive)return!1;if(s===0&&o>0||s>=t.contentHeight-t.containerHeight&&o<0)return!t.settings.wheelPropagation}var l=e.scrollLeft;if(o===0){if(!t.scrollbarXActive)return!1;if(l===0&&r<0||l>=t.contentWidth-t.containerWidth&&r>0)return!t.settings.wheelPropagation}return!0}t.event.bind(t.ownerDocument,"keydown",function(r){if(!(r.isDefaultPrevented&&r.isDefaultPrevented()||r.defaultPrevented)&&!(!n()&&!a())){var o=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(o){if(o.tagName==="IFRAME")o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(Di(o))return}var s=0,l=0;switch(r.which){case 37:r.metaKey?s=-t.contentWidth:r.altKey?s=-t.containerWidth:s=-30;break;case 38:r.metaKey?l=t.contentHeight:r.altKey?l=t.containerHeight:l=30;break;case 39:r.metaKey?s=t.contentWidth:r.altKey?s=t.containerWidth:s=30;break;case 40:r.metaKey?l=-t.contentHeight:r.altKey?l=-t.containerHeight:l=-30;break;case 32:r.shiftKey?l=t.containerHeight:l=-t.containerHeight;break;case 33:l=t.containerHeight;break;case 34:l=-t.containerHeight;break;case 36:l=t.contentHeight;break;case 35:l=-t.contentHeight;break;default:return}t.settings.suppressScrollX&&s!==0||t.settings.suppressScrollY&&l!==0||(e.scrollTop-=l,e.scrollLeft+=s,Ye(t),i(s,l)&&r.preventDefault())}})}function Pi(t){var e=t.element;function n(o,s){var l=Math.floor(e.scrollTop),c=e.scrollTop===0,u=l+e.offsetHeight===e.scrollHeight,d=e.scrollLeft===0,f=e.scrollLeft+e.offsetWidth===e.scrollWidth,h;return Math.abs(s)>Math.abs(o)?h=c||u:h=d||f,h?!t.settings.wheelPropagation:!0}function a(o){var s=o.deltaX,l=-1*o.deltaY;return(typeof s>"u"||typeof l>"u")&&(s=-1*o.wheelDeltaX/6,l=o.wheelDeltaY/6),o.deltaMode&&o.deltaMode===1&&(s*=10,l*=10),s!==s&&l!==l&&(s=0,l=o.wheelDelta),o.shiftKey?[-l,-s]:[s,l]}function i(o,s,l){if(!ft.isWebKit&&e.querySelector("select:focus"))return!0;if(!e.contains(o))return!1;for(var c=o;c&&c!==e;){if(c.classList.contains(ne.element.consuming))return!0;var u=Oe(c);if(l&&u.overflowY.match(/(scroll|auto)/)){var d=c.scrollHeight-c.clientHeight;if(d>0&&(c.scrollTop>0&&l<0||c.scrollTop<d&&l>0))return!0}if(s&&u.overflowX.match(/(scroll|auto)/)){var f=c.scrollWidth-c.clientWidth;if(f>0&&(c.scrollLeft>0&&s<0||c.scrollLeft<f&&s>0))return!0}c=c.parentNode}return!1}function r(o){var s=a(o),l=s[0],c=s[1];if(!i(o.target,l,c)){var u=!1;t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(c?e.scrollTop-=c*t.settings.wheelSpeed:e.scrollTop+=l*t.settings.wheelSpeed,u=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(l?e.scrollLeft+=l*t.settings.wheelSpeed:e.scrollLeft-=c*t.settings.wheelSpeed,u=!0):(e.scrollTop-=c*t.settings.wheelSpeed,e.scrollLeft+=l*t.settings.wheelSpeed),Ye(t),u=u||n(l,c),u&&!o.ctrlKey&&(o.stopPropagation(),o.preventDefault())}}typeof window.onwheel<"u"?t.event.bind(e,"wheel",r):typeof window.onmousewheel<"u"&&t.event.bind(e,"mousewheel",r)}function qi(t){if(!ft.supportsTouch&&!ft.supportsIePointer)return;var e=t.element,n={startOffset:{},startTime:0,speed:{},easingLoop:null};function a(d,f){var h=Math.floor(e.scrollTop),g=e.scrollLeft,v=Math.abs(d),b=Math.abs(f);if(b>v){if(f<0&&h===t.contentHeight-t.containerHeight||f>0&&h===0)return window.scrollY===0&&f>0&&ft.isChrome}else if(v>b&&(d<0&&g===t.contentWidth-t.containerWidth||d>0&&g===0))return!0;return!0}function i(d,f){e.scrollTop-=f,e.scrollLeft-=d,Ye(t)}function r(d){return d.targetTouches?d.targetTouches[0]:d}function o(d){return d.target===t.scrollbarX||d.target===t.scrollbarY||d.pointerType&&d.pointerType==="pen"&&d.buttons===0?!1:!!(d.targetTouches&&d.targetTouches.length===1||d.pointerType&&d.pointerType!=="mouse"&&d.pointerType!==d.MSPOINTER_TYPE_MOUSE)}function s(d){if(o(d)){var f=r(d);n.startOffset.pageX=f.pageX,n.startOffset.pageY=f.pageY,n.startTime=new Date().getTime(),n.easingLoop!==null&&clearInterval(n.easingLoop)}}function l(d,f,h){if(!e.contains(d))return!1;for(var g=d;g&&g!==e;){if(g.classList.contains(ne.element.consuming))return!0;var v=Oe(g);if(h&&v.overflowY.match(/(scroll|auto)/)){var b=g.scrollHeight-g.clientHeight;if(b>0&&(g.scrollTop>0&&h<0||g.scrollTop<b&&h>0))return!0}if(f&&v.overflowX.match(/(scroll|auto)/)){var _=g.scrollWidth-g.clientWidth;if(_>0&&(g.scrollLeft>0&&f<0||g.scrollLeft<_&&f>0))return!0}g=g.parentNode}return!1}function c(d){if(o(d)){var f=r(d),h={pageX:f.pageX,pageY:f.pageY},g=h.pageX-n.startOffset.pageX,v=h.pageY-n.startOffset.pageY;if(l(d.target,g,v))return;i(g,v),n.startOffset=h;var b=new Date().getTime(),_=b-n.startTime;_>0&&(n.speed.x=g/_,n.speed.y=v/_,n.startTime=b),a(g,v)&&d.cancelable&&d.preventDefault()}}function u(){t.settings.swipeEasing&&(clearInterval(n.easingLoop),n.easingLoop=setInterval(function(){if(t.isInitialized){clearInterval(n.easingLoop);return}if(!n.speed.x&&!n.speed.y){clearInterval(n.easingLoop);return}if(Math.abs(n.speed.x)<.01&&Math.abs(n.speed.y)<.01){clearInterval(n.easingLoop);return}i(n.speed.x*30,n.speed.y*30),n.speed.x*=.8,n.speed.y*=.8},10))}ft.supportsTouch?(t.event.bind(e,"touchstart",s),t.event.bind(e,"touchmove",c),t.event.bind(e,"touchend",u)):ft.supportsIePointer&&(window.PointerEvent?(t.event.bind(e,"pointerdown",s),t.event.bind(e,"pointermove",c),t.event.bind(e,"pointerup",u)):window.MSPointerEvent&&(t.event.bind(e,"MSPointerDown",s),t.event.bind(e,"MSPointerMove",c),t.event.bind(e,"MSPointerUp",u)))}var Ri=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1}},Bi={"click-rail":Oi,"drag-thumb":ki,keyboard:Ni,wheel:Pi,touch:qi},Yt=function(e,n){var a=this;if(n===void 0&&(n={}),typeof e=="string"&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=e,e.classList.add(ne.main),this.settings=Ri();for(var i in n)this.settings[i]=n[i];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var r=function(){return e.classList.add(ne.state.focus)},o=function(){return e.classList.remove(ne.state.focus)};this.isRtl=Oe(e).direction==="rtl",this.isRtl===!0&&e.classList.add(ne.rtl),this.isNegativeScroll=(function(){var c=e.scrollLeft,u=null;return e.scrollLeft=-1,u=e.scrollLeft<0,e.scrollLeft=c,u})(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new St,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=Ut(ne.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=Ut(ne.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",r),this.event.bind(this.scrollbarX,"blur",o),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var s=Oe(this.scrollbarXRail);this.scrollbarXBottom=parseInt(s.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=G(s.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=G(s.borderLeftWidth)+G(s.borderRightWidth),ve(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=G(s.marginLeft)+G(s.marginRight),ve(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=Ut(ne.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=Ut(ne.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",r),this.event.bind(this.scrollbarY,"blur",o),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var l=Oe(this.scrollbarYRail);this.scrollbarYRight=parseInt(l.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=G(l.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?Mi(this.scrollbarY):null,this.railBorderYWidth=G(l.borderTopWidth)+G(l.borderBottomWidth),ve(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=G(l.marginTop)+G(l.marginBottom),ve(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(c){return Bi[c](a)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(c){return a.onScroll(c)}),Ye(this)};Yt.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,ve(this.scrollbarXRail,{display:"block"}),ve(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=G(Oe(this.scrollbarXRail).marginLeft)+G(Oe(this.scrollbarXRail).marginRight),this.railYMarginHeight=G(Oe(this.scrollbarYRail).marginTop)+G(Oe(this.scrollbarYRail).marginBottom),ve(this.scrollbarXRail,{display:"none"}),ve(this.scrollbarYRail,{display:"none"}),Ye(this),cn(this,"top",0,!1,!0),cn(this,"left",0,!1,!0),ve(this.scrollbarXRail,{display:""}),ve(this.scrollbarYRail,{display:""}))};Yt.prototype.onScroll=function(e){this.isAlive&&(Ye(this),cn(this,"top",this.element.scrollTop-this.lastScrollTop),cn(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)};Yt.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),pt(this.scrollbarX),pt(this.scrollbarY),pt(this.scrollbarXRail),pt(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)};Yt.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};const _n="ave.stickySidebar",Ma=()=>{try{return window.localStorage}catch{return null}},Hi=(t,e)=>{const n=t.map(a=>({element:a,transition:a?.style.transition,webkit:a?.style.WebkitTransition,moz:a?.style.MozTransition}));n.forEach(({element:a})=>{a&&(a.style.WebkitTransition="none",a.style.MozTransition="none",a.style.transition="none")}),e(),n.forEach(({element:a,transition:i,webkit:r,moz:o})=>{a&&(a.style.WebkitTransition=r||"",a.style.MozTransition=o||"",a.style.transition=i||"")})};function Xi(){const t=document.querySelector(".app"),e=document.querySelector(".side-menu"),n=document.querySelector(".ave-navbar"),a=document.getElementById("ave-loader"),i=document.querySelector(".hamburger"),r=document.querySelector(".fadetoblack"),o=e?.querySelector('[data-ave-menu="container"]')||document.querySelector(".ave-sidebar__menu");if(!t||!e||!n||!i)return;let s=null;const l=()=>{s&&window.requestAnimationFrame(()=>{s?.update()})},c=h=>{const g=Ma();if(g){if(h){g.setItem(_n,"true");return}g.removeItem(_n)}},u=(h,g={suppressPersist:!1})=>{t.classList.toggle("expanded",h),i.classList.toggle("is-active",h),g.suppressPersist||c(h),l()};Hi([e,t,n],()=>{if(!(window.innerWidth>768&&Ma()?.getItem(_n)==="true")){u(!1,{suppressPersist:!0});return}t.classList.add("expanded","no-animation"),i.classList.add("is-active","no-animation"),a&&(a.style.left=`${e.clientWidth/2}px`)}),r&&r.addEventListener("click",()=>{u(!1)}),i.addEventListener("click",h=>{h.preventDefault();const g=!t.classList.contains("expanded");u(g)}),o&&(s=new Yt(o,{wheelPropagation:!1,suppressScrollX:!0}),window.addEventListener("resize",()=>{l()},{passive:!0}));const d=document.querySelectorAll(".ave-sidebar__toggle"),f=(h,g)=>{if(!h)return;if(h.removeAttribute("data-ave-animating"),g){h.classList.add("ave-sidebar__submenu--open"),h.style.maxHeight="0px",requestAnimationFrame(()=>{const w=h.scrollHeight;h.style.maxHeight=`${w}px`,l()});const _=w=>{w.propertyName==="max-height"&&(h.style.maxHeight="none",h.removeEventListener("transitionend",_),l())};h.addEventListener("transitionend",_);return}const v=h.scrollHeight;h.style.maxHeight=`${v}px`,requestAnimationFrame(()=>{h.classList.remove("ave-sidebar__submenu--open"),h.style.maxHeight="0px",l()});const b=_=>{_.propertyName==="max-height"&&(h.style.maxHeight="0px",h.removeEventListener("transitionend",b),l())};h.addEventListener("transitionend",b)};d.forEach(h=>{const g=h.closest('[data-ave-menu="item"]'),v=h.getAttribute("data-ave-submenu"),b=v?document.getElementById(v):null;if(!g||!b)return;const _=h.getAttribute("aria-expanded")==="true";g.classList.toggle("ave-sidebar__item--expanded",_),b.classList.toggle("ave-sidebar__submenu--open",_),b.style.maxHeight=_?"none":"0px",h.setAttribute("aria-expanded",String(_)),l(),h.addEventListener("click",w=>{w.preventDefault();const k=h.getAttribute("aria-expanded")!=="true";h.setAttribute("aria-expanded",String(k)),g.classList.toggle("ave-sidebar__item--expanded",k),f(b,k)})})}function $i(){const t=document.querySelector(".ave-navbar__right .dropdown.profile"),e=t?.querySelector(".dropdown-toggle"),n=t?.querySelector(".dropdown-menu");if(!t||!e||!n)return;const a=()=>{t.classList.remove("open"),e.setAttribute("aria-expanded","false")};e.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation();const r=t.classList.toggle("open");e.setAttribute("aria-expanded",String(r))}),document.addEventListener("click",i=>{t.contains(i.target)||a()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&a()})}function wr(t=document){t.querySelectorAll(".form-field-default").forEach(e=>{const n=e.querySelector("input");n&&(n.addEventListener("focus",()=>e.classList.add("focused")),n.addEventListener("blur",()=>e.classList.remove("focused")))})}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Ia(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function qe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ia(Object(n),!0).forEach(function(a){Yi(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ia(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function an(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?an=function(e){return typeof e}:an=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(t)}function Yi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function We(){return We=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},We.apply(this,arguments)}function Wi(t,e){if(t==null)return{};var n={},a=Object.keys(t),i,r;for(r=0;r<a.length;r++)i=a[r],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Fi(t,e){if(t==null)return{};var n=Wi(t,e),a,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}var ji="1.15.6";function $e(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Fe=$e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Wt=$e(/Edge/i),Oa=$e(/firefox/i),Ot=$e(/safari/i)&&!$e(/chrome/i)&&!$e(/android/i),fa=$e(/iP(ad|od|hone)/i),Er=$e(/chrome/i)&&$e(/android/i),Sr={capture:!1,passive:!1};function Y(t,e,n){t.addEventListener(e,n,!Fe&&Sr)}function X(t,e,n){t.removeEventListener(e,n,!Fe&&Sr)}function dn(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Tr(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function De(t,e,n,a){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&dn(t,e):dn(t,e))||a&&t===n)return t;if(t===n)break}while(t=Tr(t))}return null}var ka=/\s+/g;function be(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var a=(" "+t.className+" ").replace(ka," ").replace(" "+e+" "," ");t.className=(a+(n?" "+e:"")).replace(ka," ")}}function P(t,e,n){var a=t&&t.style;if(a){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in a)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),a[e]=n+(typeof n=="string"?"":"px")}}function yt(t,e){var n="";if(typeof t=="string")n=t;else do{var a=P(t,"transform");a&&a!=="none"&&(n=a+" "+n)}while(!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function xr(t,e,n){if(t){var a=t.getElementsByTagName(e),i=0,r=a.length;if(n)for(;i<r;i++)n(a[i],i);return a}return[]}function Ne(){var t=document.scrollingElement;return t||document.documentElement}function ae(t,e,n,a,i){if(!(!t.getBoundingClientRect&&t!==window)){var r,o,s,l,c,u,d;if(t!==window&&t.parentNode&&t!==Ne()?(r=t.getBoundingClientRect(),o=r.top,s=r.left,l=r.bottom,c=r.right,u=r.height,d=r.width):(o=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(e||n)&&t!==window&&(i=i||t.parentNode,!Fe))do if(i&&i.getBoundingClientRect&&(P(i,"transform")!=="none"||n&&P(i,"position")!=="static")){var f=i.getBoundingClientRect();o-=f.top+parseInt(P(i,"border-top-width")),s-=f.left+parseInt(P(i,"border-left-width")),l=o+r.height,c=s+r.width;break}while(i=i.parentNode);if(a&&t!==window){var h=yt(i||t),g=h&&h.a,v=h&&h.d;h&&(o/=v,s/=g,d/=g,u/=v,l=o+u,c=s+d)}return{top:o,left:s,bottom:l,right:c,width:d,height:u}}}function Na(t,e,n){for(var a=Ve(t,!0),i=ae(t)[e];a;){var r=ae(a)[n],o=void 0;if(o=i>=r,!o)return a;if(a===Ne())break;a=Ve(a,!1)}return!1}function Et(t,e,n,a){for(var i=0,r=0,o=t.children;r<o.length;){if(o[r].style.display!=="none"&&o[r]!==I.ghost&&(a||o[r]!==I.dragged)&&De(o[r],n.draggable,t,!1)){if(i===e)return o[r];i++}r++}return null}function ha(t,e){for(var n=t.lastElementChild;n&&(n===I.ghost||P(n,"display")==="none"||e&&!dn(n,e));)n=n.previousElementSibling;return n||null}function Te(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==I.clone&&(!e||dn(t,e))&&n++;return n}function Pa(t){var e=0,n=0,a=Ne();if(t)do{var i=yt(t),r=i.a,o=i.d;e+=t.scrollLeft*r,n+=t.scrollTop*o}while(t!==a&&(t=t.parentNode));return[e,n]}function zi(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var a in e)if(e.hasOwnProperty(a)&&e[a]===t[n][a])return Number(n)}return-1}function Ve(t,e){if(!t||!t.getBoundingClientRect)return Ne();var n=t,a=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=P(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Ne();if(a||e)return n;a=!0}}while(n=n.parentNode);return Ne()}function Ui(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Ln(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var kt;function Ar(t,e){return function(){if(!kt){var n=arguments,a=this;n.length===1?t.call(a,n[0]):t.apply(a,n),kt=setTimeout(function(){kt=void 0},e)}}}function Ki(){clearTimeout(kt),kt=void 0}function Cr(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function _r(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function Lr(t,e,n){var a={};return Array.from(t.children).forEach(function(i){var r,o,s,l;if(!(!De(i,e.draggable,t,!1)||i.animated||i===n)){var c=ae(i);a.left=Math.min((r=a.left)!==null&&r!==void 0?r:1/0,c.left),a.top=Math.min((o=a.top)!==null&&o!==void 0?o:1/0,c.top),a.right=Math.max((s=a.right)!==null&&s!==void 0?s:-1/0,c.right),a.bottom=Math.max((l=a.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var ye="Sortable"+new Date().getTime();function Vi(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(i){if(!(P(i,"display")==="none"||i===I.ghost)){t.push({target:i,rect:ae(i)});var r=qe({},t[t.length-1].rect);if(i.thisAnimationDuration){var o=yt(i,!0);o&&(r.top-=o.f,r.left-=o.e)}i.fromRect=r}})}},addAnimationState:function(a){t.push(a)},removeAnimationState:function(a){t.splice(zi(t,{target:a}),1)},animateAll:function(a){var i=this;if(!this.options.animation){clearTimeout(e),typeof a=="function"&&a();return}var r=!1,o=0;t.forEach(function(s){var l=0,c=s.target,u=c.fromRect,d=ae(c),f=c.prevFromRect,h=c.prevToRect,g=s.rect,v=yt(c,!0);v&&(d.top-=v.f,d.left-=v.e),c.toRect=d,c.thisAnimationDuration&&Ln(f,d)&&!Ln(u,d)&&(g.top-d.top)/(g.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(l=Ji(g,f,h,i.options)),Ln(d,u)||(c.prevFromRect=u,c.prevToRect=d,l||(l=i.options.animation),i.animate(c,g,d,l)),l&&(r=!0,o=Math.max(o,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),r?e=setTimeout(function(){typeof a=="function"&&a()},o):typeof a=="function"&&a(),t=[]},animate:function(a,i,r,o){if(o){P(a,"transition",""),P(a,"transform","");var s=yt(this.el),l=s&&s.a,c=s&&s.d,u=(i.left-r.left)/(l||1),d=(i.top-r.top)/(c||1);a.animatingX=!!u,a.animatingY=!!d,P(a,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=Gi(a),P(a,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),P(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){P(a,"transition",""),P(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},o)}}}}function Gi(t){return t.offsetWidth}function Ji(t,e,n,a){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*a.animation}var ct=[],Dn={initializeByDefault:!0},Ft={mount:function(e){for(var n in Dn)Dn.hasOwnProperty(n)&&!(n in e)&&(e[n]=Dn[n]);ct.forEach(function(a){if(a.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),ct.push(e)},pluginEvent:function(e,n,a){var i=this;this.eventCanceled=!1,a.cancel=function(){i.eventCanceled=!0};var r=e+"Global";ct.forEach(function(o){n[o.pluginName]&&(n[o.pluginName][r]&&n[o.pluginName][r](qe({sortable:n},a)),n.options[o.pluginName]&&n[o.pluginName][e]&&n[o.pluginName][e](qe({sortable:n},a)))})},initializePlugins:function(e,n,a,i){ct.forEach(function(s){var l=s.pluginName;if(!(!e.options[l]&&!s.initializeByDefault)){var c=new s(e,n,e.options);c.sortable=e,c.options=e.options,e[l]=c,We(a,c.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var o=this.modifyOption(e,r,e.options[r]);typeof o<"u"&&(e.options[r]=o)}},getEventProperties:function(e,n){var a={};return ct.forEach(function(i){typeof i.eventProperties=="function"&&We(a,i.eventProperties.call(n[i.pluginName],e))}),a},modifyOption:function(e,n,a){var i;return ct.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[n]=="function"&&(i=r.optionListeners[n].call(e[r.pluginName],a))}),i}};function Zi(t){var e=t.sortable,n=t.rootEl,a=t.name,i=t.targetEl,r=t.cloneEl,o=t.toEl,s=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,d=t.newDraggableIndex,f=t.originalEvent,h=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[ye],!!e){var v,b=e.options,_="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Fe&&!Wt?v=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent(a,!0,!0)),v.to=o||n,v.from=s||n,v.item=i||n,v.clone=r,v.oldIndex=l,v.newIndex=c,v.oldDraggableIndex=u,v.newDraggableIndex=d,v.originalEvent=f,v.pullMode=h?h.lastPutMode:void 0;var w=qe(qe({},g),Ft.getEventProperties(a,e));for(var k in w)v[k]=w[k];n&&n.dispatchEvent(v),b[_]&&b[_].call(e,v)}}var Qi=["evt"],pe=function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=a.evt,r=Fi(a,Qi);Ft.pluginEvent.bind(I)(e,n,qe({dragEl:E,parentEl:Z,ghostEl:R,rootEl:j,nextEl:rt,lastDownEl:rn,cloneEl:V,cloneHidden:Ue,dragStarted:Lt,putSortable:le,activeSortable:I.active,originalEvent:i,oldIndex:mt,oldDraggableIndex:Nt,newIndex:we,newDraggableIndex:ze,hideGhostForTarget:Or,unhideGhostForTarget:kr,cloneNowHidden:function(){Ue=!0},cloneNowShown:function(){Ue=!1},dispatchSortableEvent:function(s){he({sortable:n,name:s,originalEvent:i})}},r))};function he(t){Zi(qe({putSortable:le,cloneEl:V,targetEl:E,rootEl:j,oldIndex:mt,oldDraggableIndex:Nt,newIndex:we,newDraggableIndex:ze},t))}var E,Z,R,j,rt,rn,V,Ue,mt,we,Nt,ze,Gt,le,ht=!1,un=!1,fn=[],et,_e,Mn,In,qa,Ra,Lt,dt,Pt,qt=!1,Jt=!1,on,ue,On=[],zn=!1,hn=[],bn=typeof document<"u",Zt=fa,Ba=Wt||Fe?"cssFloat":"float",eo=bn&&!Er&&!fa&&"draggable"in document.createElement("div"),Dr=(function(){if(bn){if(Fe)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}})(),Mr=function(e,n){var a=P(e),i=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),r=Et(e,0,n),o=Et(e,1,n),s=r&&P(r),l=o&&P(o),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+ae(r).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+ae(o).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&s.float!=="none"){var d=s.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return r&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=i&&a[Ba]==="none"||o&&a[Ba]==="none"&&c+u>i)?"vertical":"horizontal"},to=function(e,n,a){var i=a?e.left:e.top,r=a?e.right:e.bottom,o=a?e.width:e.height,s=a?n.left:n.top,l=a?n.right:n.bottom,c=a?n.width:n.height;return i===s||r===l||i+o/2===s+c/2},no=function(e,n){var a;return fn.some(function(i){var r=i[ye].options.emptyInsertThreshold;if(!(!r||ha(i))){var o=ae(i),s=e>=o.left-r&&e<=o.right+r,l=n>=o.top-r&&n<=o.bottom+r;if(s&&l)return a=i}}),a},Ir=function(e){function n(r,o){return function(s,l,c,u){var d=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(r==null&&(o||d))return!0;if(r==null||r===!1)return!1;if(o&&r==="clone")return r;if(typeof r=="function")return n(r(s,l,c,u),o)(s,l,c,u);var f=(o?s:l).options.group.name;return r===!0||typeof r=="string"&&r===f||r.join&&r.indexOf(f)>-1}}var a={},i=e.group;(!i||an(i)!="object")&&(i={name:i}),a.name=i.name,a.checkPull=n(i.pull,!0),a.checkPut=n(i.put),a.revertClone=i.revertClone,e.group=a},Or=function(){!Dr&&R&&P(R,"display","none")},kr=function(){!Dr&&R&&P(R,"display","")};bn&&!Er&&document.addEventListener("click",function(t){if(un)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),un=!1,!1},!0);var tt=function(e){if(E){e=e.touches?e.touches[0]:e;var n=no(e.clientX,e.clientY);if(n){var a={};for(var i in e)e.hasOwnProperty(i)&&(a[i]=e[i]);a.target=a.rootEl=n,a.preventDefault=void 0,a.stopPropagation=void 0,n[ye]._onDragOver(a)}}},ao=function(e){E&&E.parentNode[ye]._isOutsideThisEl(e.target)};function I(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=We({},e),t[ye]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Mr(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,s){o.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:I.supportPointer!==!1&&"PointerEvent"in window&&(!Ot||fa),emptyInsertThreshold:5};Ft.initializePlugins(this,t,n);for(var a in n)!(a in e)&&(e[a]=n[a]);Ir(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:eo,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Y(t,"pointerdown",this._onTapStart):(Y(t,"mousedown",this._onTapStart),Y(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Y(t,"dragover",this),Y(t,"dragenter",this)),fn.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),We(this,Vi())}I.prototype={constructor:I,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(dt=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,E):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,a=this.el,i=this.options,r=i.preventOnFilter,o=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(s||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=i.filter;if(fo(a),!E&&!(/mousedown|pointerdown/.test(o)&&e.button!==0||i.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Ot&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=De(l,i.draggable,a,!1),!(l&&l.animated)&&rn!==l)){if(mt=Te(l),Nt=Te(l,i.draggable),typeof u=="function"){if(u.call(this,e,l,this)){he({sortable:n,rootEl:c,name:"filter",targetEl:l,toEl:a,fromEl:a}),pe("filter",n,{evt:e}),r&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=De(c,d.trim(),a,!1),d)return he({sortable:n,rootEl:d,name:"filter",targetEl:l,fromEl:a,toEl:a}),pe("filter",n,{evt:e}),!0}),u)){r&&e.preventDefault();return}i.handle&&!De(c,i.handle,a,!1)||this._prepareDragStart(e,s,l)}}},_prepareDragStart:function(e,n,a){var i=this,r=i.el,o=i.options,s=r.ownerDocument,l;if(a&&!E&&a.parentNode===r){var c=ae(a);if(j=r,E=a,Z=E.parentNode,rt=E.nextSibling,rn=a,Gt=o.group,I.dragged=E,et={target:E,clientX:(n||e).clientX,clientY:(n||e).clientY},qa=et.clientX-c.left,Ra=et.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,E.style["will-change"]="all",l=function(){if(pe("delayEnded",i,{evt:e}),I.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Oa&&i.nativeDraggable&&(E.draggable=!0),i._triggerDragStart(e,n),he({sortable:i,name:"choose",originalEvent:e}),be(E,o.chosenClass,!0)},o.ignore.split(",").forEach(function(u){xr(E,u.trim(),kn)}),Y(s,"dragover",tt),Y(s,"mousemove",tt),Y(s,"touchmove",tt),o.supportPointer?(Y(s,"pointerup",i._onDrop),!this.nativeDraggable&&Y(s,"pointercancel",i._onDrop)):(Y(s,"mouseup",i._onDrop),Y(s,"touchend",i._onDrop),Y(s,"touchcancel",i._onDrop)),Oa&&this.nativeDraggable&&(this.options.touchStartThreshold=4,E.draggable=!0),pe("delayStart",this,{evt:e}),o.delay&&(!o.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Wt||Fe))){if(I.eventCanceled){this._onDrop();return}o.supportPointer?(Y(s,"pointerup",i._disableDelayedDrag),Y(s,"pointercancel",i._disableDelayedDrag)):(Y(s,"mouseup",i._disableDelayedDrag),Y(s,"touchend",i._disableDelayedDrag),Y(s,"touchcancel",i._disableDelayedDrag)),Y(s,"mousemove",i._delayedDragTouchMoveHandler),Y(s,"touchmove",i._delayedDragTouchMoveHandler),o.supportPointer&&Y(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&kn(E),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;X(e,"mouseup",this._disableDelayedDrag),X(e,"touchend",this._disableDelayedDrag),X(e,"touchcancel",this._disableDelayedDrag),X(e,"pointerup",this._disableDelayedDrag),X(e,"pointercancel",this._disableDelayedDrag),X(e,"mousemove",this._delayedDragTouchMoveHandler),X(e,"touchmove",this._delayedDragTouchMoveHandler),X(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?Y(document,"pointermove",this._onTouchMove):n?Y(document,"touchmove",this._onTouchMove):Y(document,"mousemove",this._onTouchMove):(Y(E,"dragend",this),Y(j,"dragstart",this._onDragStart));try{document.selection?sn(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(ht=!1,j&&E){pe("dragStarted",this,{evt:n}),this.nativeDraggable&&Y(document,"dragover",ao);var a=this.options;!e&&be(E,a.dragClass,!1),be(E,a.ghostClass,!0),I.active=this,e&&this._appendGhost(),he({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(_e){this._lastX=_e.clientX,this._lastY=_e.clientY,Or();for(var e=document.elementFromPoint(_e.clientX,_e.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(_e.clientX,_e.clientY),e!==n);)n=e;if(E.parentNode[ye]._isOutsideThisEl(e),n)do{if(n[ye]){var a=void 0;if(a=n[ye]._onDragOver({clientX:_e.clientX,clientY:_e.clientY,target:e,rootEl:n}),a&&!this.options.dragoverBubble)break}e=n}while(n=Tr(n));kr()}},_onTouchMove:function(e){if(et){var n=this.options,a=n.fallbackTolerance,i=n.fallbackOffset,r=e.touches?e.touches[0]:e,o=R&&yt(R,!0),s=R&&o&&o.a,l=R&&o&&o.d,c=Zt&&ue&&Pa(ue),u=(r.clientX-et.clientX+i.x)/(s||1)+(c?c[0]-On[0]:0)/(s||1),d=(r.clientY-et.clientY+i.y)/(l||1)+(c?c[1]-On[1]:0)/(l||1);if(!I.active&&!ht){if(a&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<a)return;this._onDragStart(e,!0)}if(R){o?(o.e+=u-(Mn||0),o.f+=d-(In||0)):o={a:1,b:0,c:0,d:1,e:u,f:d};var f="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");P(R,"webkitTransform",f),P(R,"mozTransform",f),P(R,"msTransform",f),P(R,"transform",f),Mn=u,In=d,_e=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!R){var e=this.options.fallbackOnBody?document.body:j,n=ae(E,!0,Zt,!0,e),a=this.options;if(Zt){for(ue=e;P(ue,"position")==="static"&&P(ue,"transform")==="none"&&ue!==document;)ue=ue.parentNode;ue!==document.body&&ue!==document.documentElement?(ue===document&&(ue=Ne()),n.top+=ue.scrollTop,n.left+=ue.scrollLeft):ue=Ne(),On=Pa(ue)}R=E.cloneNode(!0),be(R,a.ghostClass,!1),be(R,a.fallbackClass,!0),be(R,a.dragClass,!0),P(R,"transition",""),P(R,"transform",""),P(R,"box-sizing","border-box"),P(R,"margin",0),P(R,"top",n.top),P(R,"left",n.left),P(R,"width",n.width),P(R,"height",n.height),P(R,"opacity","0.8"),P(R,"position",Zt?"absolute":"fixed"),P(R,"zIndex","100000"),P(R,"pointerEvents","none"),I.ghost=R,e.appendChild(R),P(R,"transform-origin",qa/parseInt(R.style.width)*100+"% "+Ra/parseInt(R.style.height)*100+"%")}},_onDragStart:function(e,n){var a=this,i=e.dataTransfer,r=a.options;if(pe("dragStart",this,{evt:e}),I.eventCanceled){this._onDrop();return}pe("setupClone",this),I.eventCanceled||(V=_r(E),V.removeAttribute("id"),V.draggable=!1,V.style["will-change"]="",this._hideClone(),be(V,this.options.chosenClass,!1),I.clone=V),a.cloneId=sn(function(){pe("clone",a),!I.eventCanceled&&(a.options.removeCloneOnHide||j.insertBefore(V,E),a._hideClone(),he({sortable:a,name:"clone"}))}),!n&&be(E,r.dragClass,!0),n?(un=!0,a._loopId=setInterval(a._emulateDragOver,50)):(X(document,"mouseup",a._onDrop),X(document,"touchend",a._onDrop),X(document,"touchcancel",a._onDrop),i&&(i.effectAllowed="move",r.setData&&r.setData.call(a,i,E)),Y(document,"drop",a),P(E,"transform","translateZ(0)")),ht=!0,a._dragStartId=sn(a._dragStarted.bind(a,n,e)),Y(document,"selectstart",a),Lt=!0,window.getSelection().removeAllRanges(),Ot&&P(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,a=e.target,i,r,o,s=this.options,l=s.group,c=I.active,u=Gt===l,d=s.sort,f=le||c,h,g=this,v=!1;if(zn)return;function b(Ce,Ze){pe(Ce,g,qe({evt:e,isOwner:u,axis:h?"vertical":"horizontal",revert:o,dragRect:i,targetRect:r,canSort:d,fromSortable:f,target:a,completed:w,onMove:function(Qe,He){return Qt(j,n,E,i,Qe,ae(Qe),e,He)},changed:k},Ze))}function _(){b("dragOverAnimationCapture"),g.captureAnimationState(),g!==f&&f.captureAnimationState()}function w(Ce){return b("dragOverCompleted",{insertion:Ce}),Ce&&(u?c._hideClone():c._showClone(g),g!==f&&(be(E,le?le.options.ghostClass:c.options.ghostClass,!1),be(E,s.ghostClass,!0)),le!==g&&g!==I.active?le=g:g===I.active&&le&&(le=null),f===g&&(g._ignoreWhileAnimating=a),g.animateAll(function(){b("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(a===E&&!E.animated||a===n&&!a.animated)&&(dt=null),!s.dragoverBubble&&!e.rootEl&&a!==document&&(E.parentNode[ye]._isOutsideThisEl(e.target),!Ce&&tt(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function k(){we=Te(E),ze=Te(E,s.draggable),he({sortable:g,name:"change",toEl:n,newIndex:we,newDraggableIndex:ze,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),a=De(a,s.draggable,n,!0),b("dragOver"),I.eventCanceled)return v;if(E.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||g._ignoreWhileAnimating===a)return w(!1);if(un=!1,c&&!s.disabled&&(u?d||(o=Z!==j):le===this||(this.lastPutMode=Gt.checkPull(this,c,E,e))&&l.checkPut(this,c,E,e))){if(h=this._getDirection(e,a)==="vertical",i=ae(E),b("dragOverValid"),I.eventCanceled)return v;if(o)return Z=j,_(),this._hideClone(),b("revert"),I.eventCanceled||(rt?j.insertBefore(E,rt):j.appendChild(E)),w(!0);var T=ha(n,s.draggable);if(!T||so(e,h,this)&&!T.animated){if(T===E)return w(!1);if(T&&n===e.target&&(a=T),a&&(r=ae(a)),Qt(j,n,E,i,a,r,e,!!a)!==!1)return _(),T&&T.nextSibling?n.insertBefore(E,T.nextSibling):n.appendChild(E),Z=n,k(),w(!0)}else if(T&&oo(e,h,this)){var y=Et(n,0,s,!0);if(y===E)return w(!1);if(a=y,r=ae(a),Qt(j,n,E,i,a,r,e,!1)!==!1)return _(),n.insertBefore(E,y),Z=n,k(),w(!0)}else if(a.parentNode===n){r=ae(a);var p=0,C,O=E.parentNode!==n,N=!to(E.animated&&E.toRect||i,a.animated&&a.toRect||r,h),K=h?"top":"left",W=Na(a,"top","top")||Na(E,"top","top"),de=W?W.scrollTop:void 0;dt!==a&&(C=r[K],qt=!1,Jt=!N&&s.invertSwap||O),p=lo(e,a,r,h,N?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Jt,dt===a);var Q;if(p!==0){var ee=Te(E);do ee-=p,Q=Z.children[ee];while(Q&&(P(Q,"display")==="none"||Q===R))}if(p===0||Q===a)return w(!1);dt=a,Pt=p;var J=a.nextElementSibling,oe=!1;oe=p===1;var Ae=Qt(j,n,E,i,a,r,e,oe);if(Ae!==!1)return(Ae===1||Ae===-1)&&(oe=Ae===1),zn=!0,setTimeout(io,30),_(),oe&&!J?n.appendChild(E):a.parentNode.insertBefore(E,oe?J:a),W&&Cr(W,0,de-W.scrollTop),Z=E.parentNode,C!==void 0&&!Jt&&(on=Math.abs(C-ae(a)[K])),k(),w(!0)}if(n.contains(E))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){X(document,"mousemove",this._onTouchMove),X(document,"touchmove",this._onTouchMove),X(document,"pointermove",this._onTouchMove),X(document,"dragover",tt),X(document,"mousemove",tt),X(document,"touchmove",tt)},_offUpEvents:function(){var e=this.el.ownerDocument;X(e,"mouseup",this._onDrop),X(e,"touchend",this._onDrop),X(e,"pointerup",this._onDrop),X(e,"pointercancel",this._onDrop),X(e,"touchcancel",this._onDrop),X(document,"selectstart",this)},_onDrop:function(e){var n=this.el,a=this.options;if(we=Te(E),ze=Te(E,a.draggable),pe("drop",this,{evt:e}),Z=E&&E.parentNode,we=Te(E),ze=Te(E,a.draggable),I.eventCanceled){this._nulling();return}ht=!1,Jt=!1,qt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Un(this.cloneId),Un(this._dragStartId),this.nativeDraggable&&(X(document,"drop",this),X(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ot&&P(document.body,"user-select",""),P(E,"transform",""),e&&(Lt&&(e.cancelable&&e.preventDefault(),!a.dropBubble&&e.stopPropagation()),R&&R.parentNode&&R.parentNode.removeChild(R),(j===Z||le&&le.lastPutMode!=="clone")&&V&&V.parentNode&&V.parentNode.removeChild(V),E&&(this.nativeDraggable&&X(E,"dragend",this),kn(E),E.style["will-change"]="",Lt&&!ht&&be(E,le?le.options.ghostClass:this.options.ghostClass,!1),be(E,this.options.chosenClass,!1),he({sortable:this,name:"unchoose",toEl:Z,newIndex:null,newDraggableIndex:null,originalEvent:e}),j!==Z?(we>=0&&(he({rootEl:Z,name:"add",toEl:Z,fromEl:j,originalEvent:e}),he({sortable:this,name:"remove",toEl:Z,originalEvent:e}),he({rootEl:Z,name:"sort",toEl:Z,fromEl:j,originalEvent:e}),he({sortable:this,name:"sort",toEl:Z,originalEvent:e})),le&&le.save()):we!==mt&&we>=0&&(he({sortable:this,name:"update",toEl:Z,originalEvent:e}),he({sortable:this,name:"sort",toEl:Z,originalEvent:e})),I.active&&((we==null||we===-1)&&(we=mt,ze=Nt),he({sortable:this,name:"end",toEl:Z,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){pe("nulling",this),j=E=Z=R=rt=V=rn=Ue=et=_e=Lt=we=ze=mt=Nt=dt=Pt=le=Gt=I.dragged=I.ghost=I.clone=I.active=null,hn.forEach(function(e){e.checked=!0}),hn.length=Mn=In=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":E&&(this._onDragOver(e),ro(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,a=this.el.children,i=0,r=a.length,o=this.options;i<r;i++)n=a[i],De(n,o.draggable,this.el,!1)&&e.push(n.getAttribute(o.dataIdAttr)||uo(n));return e},sort:function(e,n){var a={},i=this.el;this.toArray().forEach(function(r,o){var s=i.children[o];De(s,this.options.draggable,i,!1)&&(a[r]=s)},this),n&&this.captureAnimationState(),e.forEach(function(r){a[r]&&(i.removeChild(a[r]),i.appendChild(a[r]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return De(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var a=this.options;if(n===void 0)return a[e];var i=Ft.modifyOption(this,e,n);typeof i<"u"?a[e]=i:a[e]=n,e==="group"&&Ir(a)},destroy:function(){pe("destroy",this);var e=this.el;e[ye]=null,X(e,"mousedown",this._onTapStart),X(e,"touchstart",this._onTapStart),X(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(e,"dragover",this),X(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),fn.splice(fn.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ue){if(pe("hideClone",this),I.eventCanceled)return;P(V,"display","none"),this.options.removeCloneOnHide&&V.parentNode&&V.parentNode.removeChild(V),Ue=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Ue){if(pe("showClone",this),I.eventCanceled)return;E.parentNode==j&&!this.options.group.revertClone?j.insertBefore(V,E):rt?j.insertBefore(V,rt):j.appendChild(V),this.options.group.revertClone&&this.animate(E,V),P(V,"display",""),Ue=!1}}};function ro(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Qt(t,e,n,a,i,r,o,s){var l,c=t[ye],u=c.options.onMove,d;return window.CustomEvent&&!Fe&&!Wt?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=n,l.draggedRect=a,l.related=i||e,l.relatedRect=r||ae(e),l.willInsertAfter=s,l.originalEvent=o,t.dispatchEvent(l),u&&(d=u.call(c,l,o)),d}function kn(t){t.draggable=!1}function io(){zn=!1}function oo(t,e,n){var a=ae(Et(n.el,0,n.options,!0)),i=Lr(n.el,n.options,R),r=10;return e?t.clientX<i.left-r||t.clientY<a.top&&t.clientX<a.right:t.clientY<i.top-r||t.clientY<a.bottom&&t.clientX<a.left}function so(t,e,n){var a=ae(ha(n.el,n.options.draggable)),i=Lr(n.el,n.options,R),r=10;return e?t.clientX>i.right+r||t.clientY>a.bottom&&t.clientX>a.left:t.clientY>i.bottom+r||t.clientX>a.right&&t.clientY>a.top}function lo(t,e,n,a,i,r,o,s){var l=a?t.clientY:t.clientX,c=a?n.height:n.width,u=a?n.top:n.left,d=a?n.bottom:n.right,f=!1;if(!o){if(s&&on<c*i){if(!qt&&(Pt===1?l>u+c*r/2:l<d-c*r/2)&&(qt=!0),qt)f=!0;else if(Pt===1?l<u+on:l>d-on)return-Pt}else if(l>u+c*(1-i)/2&&l<d-c*(1-i)/2)return co(e)}return f=f||o,f&&(l<u+c*r/2||l>d-c*r/2)?l>u+c/2?1:-1:0}function co(t){return Te(E)<Te(t)?1:-1}function uo(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,a=0;n--;)a+=e.charCodeAt(n);return a.toString(36)}function fo(t){hn.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var a=e[n];a.checked&&hn.push(a)}}function sn(t){return setTimeout(t,0)}function Un(t){return clearTimeout(t)}bn&&Y(document,"touchmove",function(t){(I.active||ht)&&t.cancelable&&t.preventDefault()});I.utils={on:Y,off:X,css:P,find:xr,is:function(e,n){return!!De(e,n,e,!1)},extend:Ui,throttle:Ar,closest:De,toggleClass:be,clone:_r,index:Te,nextTick:sn,cancelNextTick:Un,detectDirection:Mr,getChild:Et,expando:ye};I.get=function(t){return t[ye]};I.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(I.utils=qe(qe({},I.utils),a.utils)),Ft.mount(a)})};I.create=function(t,e){return new I(t,e)};I.version=ji;var te=[],Dt,Kn,Vn=!1,Nn,Pn,pn,Mt;function ho(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var a=n.originalEvent;this.sortable.nativeDraggable?Y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Y(document,"pointermove",this._handleFallbackAutoScroll):a.touches?Y(document,"touchmove",this._handleFallbackAutoScroll):Y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var a=n.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?X(document,"dragover",this._handleAutoScroll):(X(document,"pointermove",this._handleFallbackAutoScroll),X(document,"touchmove",this._handleFallbackAutoScroll),X(document,"mousemove",this._handleFallbackAutoScroll)),Ha(),ln(),Ki()},nulling:function(){pn=Kn=Dt=Vn=Mt=Nn=Pn=null,te.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,a){var i=this,r=(n.touches?n.touches[0]:n).clientX,o=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(r,o);if(pn=n,a||this.options.forceAutoScrollFallback||Wt||Fe||Ot){qn(n,this.options,s,a);var l=Ve(s,!0);Vn&&(!Mt||r!==Nn||o!==Pn)&&(Mt&&Ha(),Mt=setInterval(function(){var c=Ve(document.elementFromPoint(r,o),!0);c!==l&&(l=c,ln()),qn(n,i.options,c,a)},10),Nn=r,Pn=o)}else{if(!this.options.bubbleScroll||Ve(s,!0)===Ne()){ln();return}qn(n,this.options,Ve(s,!1),!1)}}},We(t,{pluginName:"scroll",initializeByDefault:!0})}function ln(){te.forEach(function(t){clearInterval(t.pid)}),te=[]}function Ha(){clearInterval(Mt)}var qn=Ar(function(t,e,n,a){if(e.scroll){var i=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,o=e.scrollSensitivity,s=e.scrollSpeed,l=Ne(),c=!1,u;Kn!==n&&(Kn=n,ln(),Dt=e.scroll,u=e.scrollFn,Dt===!0&&(Dt=Ve(n,!0)));var d=0,f=Dt;do{var h=f,g=ae(h),v=g.top,b=g.bottom,_=g.left,w=g.right,k=g.width,T=g.height,y=void 0,p=void 0,C=h.scrollWidth,O=h.scrollHeight,N=P(h),K=h.scrollLeft,W=h.scrollTop;h===l?(y=k<C&&(N.overflowX==="auto"||N.overflowX==="scroll"||N.overflowX==="visible"),p=T<O&&(N.overflowY==="auto"||N.overflowY==="scroll"||N.overflowY==="visible")):(y=k<C&&(N.overflowX==="auto"||N.overflowX==="scroll"),p=T<O&&(N.overflowY==="auto"||N.overflowY==="scroll"));var de=y&&(Math.abs(w-i)<=o&&K+k<C)-(Math.abs(_-i)<=o&&!!K),Q=p&&(Math.abs(b-r)<=o&&W+T<O)-(Math.abs(v-r)<=o&&!!W);if(!te[d])for(var ee=0;ee<=d;ee++)te[ee]||(te[ee]={});(te[d].vx!=de||te[d].vy!=Q||te[d].el!==h)&&(te[d].el=h,te[d].vx=de,te[d].vy=Q,clearInterval(te[d].pid),(de!=0||Q!=0)&&(c=!0,te[d].pid=setInterval((function(){a&&this.layer===0&&I.active._onTouchMove(pn);var J=te[this.layer].vy?te[this.layer].vy*s:0,oe=te[this.layer].vx?te[this.layer].vx*s:0;typeof u=="function"&&u.call(I.dragged.parentNode[ye],oe,J,t,pn,te[this.layer].el)!=="continue"||Cr(te[this.layer].el,oe,J)}).bind({layer:d}),24))),d++}while(e.bubbleScroll&&f!==l&&(f=Ve(f,!1)));Vn=c}},30),Nr=function(e){var n=e.originalEvent,a=e.putSortable,i=e.dragEl,r=e.activeSortable,o=e.dispatchSortableEvent,s=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(n){var c=a||r;s();var u=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,d=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(d)&&(o("spill"),this.onSpill({dragEl:i,putSortable:a}))}};function pa(){}pa.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,a=e.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var i=Et(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),a&&a.animateAll()},drop:Nr};We(pa,{pluginName:"revertOnSpill"});function ma(){}ma.prototype={onSpill:function(e){var n=e.dragEl,a=e.putSortable,i=a||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:Nr};We(ma,{pluginName:"removeOnSpill"});I.mount(new ho);I.mount(ma,pa);/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function Xa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,a)}return n}function Pr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Xa(Object(n),!0).forEach(function(a){vo(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xa(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function po(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,e);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function qr(t){var e=po(t,"string");return typeof e=="symbol"?e:e+""}function Gn(t){"@babel/helpers - typeof";return Gn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gn(t)}function mo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,qr(a.key),a)}}function go(t,e,n){return e&&$a(t.prototype,e),n&&$a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vo(t,e,n){return e=qr(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rr(t){return yo(t)||bo(t)||wo(t)||Eo()}function yo(t){if(Array.isArray(t))return Jn(t)}function bo(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wo(t,e){if(t){if(typeof t=="string")return Jn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jn(t,e)}}function Jn(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Eo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var wn=typeof window<"u"&&typeof window.document<"u",Re=wn?window:{},ga=wn&&Re.document.documentElement?"ontouchstart"in Re.document.documentElement:!1,va=wn?"PointerEvent"in Re:!1,z="cropper",ya="all",Br="crop",Hr="move",Xr="zoom",nt="e",at="w",ut="s",je="n",xt="ne",At="nw",Ct="se",_t="sw",Zn="".concat(z,"-crop"),Ya="".concat(z,"-disabled"),ge="".concat(z,"-hidden"),Wa="".concat(z,"-hide"),So="".concat(z,"-invisible"),mn="".concat(z,"-modal"),Qn="".concat(z,"-move"),Bt="".concat(z,"Action"),en="".concat(z,"Preview"),ba="crop",$r="move",Yr="none",ea="crop",ta="cropend",na="cropmove",aa="cropstart",Fa="dblclick",To=ga?"touchstart":"mousedown",xo=ga?"touchmove":"mousemove",Ao=ga?"touchend touchcancel":"mouseup",ja=va?"pointerdown":To,za=va?"pointermove":xo,Ua=va?"pointerup pointercancel":Ao,Ka="ready",Va="resize",Ga="wheel",ra="zoom",Ja="image/jpeg",Co=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,_o=/^data:/,Lo=/^data:image\/jpeg;base64,/,Do=/^img|canvas$/i,Wr=200,Fr=100,Za={viewMode:0,dragMode:ba,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Wr,minContainerHeight:Fr,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Mo='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',Io=Number.isNaN||Re.isNaN;function $(t){return typeof t=="number"&&!Io(t)}var Qa=function(e){return e>0&&e<1/0};function Rn(t){return typeof t>"u"}function ot(t){return Gn(t)==="object"&&t!==null}var Oo=Object.prototype.hasOwnProperty;function gt(t){if(!ot(t))return!1;try{var e=t.constructor,n=e.prototype;return e&&n&&Oo.call(n,"isPrototypeOf")}catch{return!1}}function me(t){return typeof t=="function"}var ko=Array.prototype.slice;function jr(t){return Array.from?Array.from(t):ko.call(t)}function re(t,e){return t&&me(e)&&(Array.isArray(t)||$(t.length)?jr(t).forEach(function(n,a){e.call(t,n,a,t)}):ot(t)&&Object.keys(t).forEach(function(n){e.call(t,t[n],n,t)})),t}var U=Object.assign||function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return ot(e)&&a.length>0&&a.forEach(function(r){ot(r)&&Object.keys(r).forEach(function(o){e[o]=r[o]})}),e},No=/\.\d*(?:0|9){12}\d*$/;function bt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return No.test(t)?Math.round(t*e)/e:t}var Po=/^width|height|left|top|marginLeft|marginTop$/;function Ge(t,e){var n=t.style;re(e,function(a,i){Po.test(i)&&$(a)&&(a="".concat(a,"px")),n[i]=a})}function qo(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function se(t,e){if(e){if($(t.length)){re(t,function(a){se(a,e)});return}if(t.classList){t.classList.add(e);return}var n=t.className.trim();n?n.indexOf(e)<0&&(t.className="".concat(n," ").concat(e)):t.className=e}}function Pe(t,e){if(e){if($(t.length)){re(t,function(n){Pe(n,e)});return}if(t.classList){t.classList.remove(e);return}t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,""))}}function vt(t,e,n){if(e){if($(t.length)){re(t,function(a){vt(a,e,n)});return}n?se(t,e):Pe(t,e)}}var Ro=/([a-z\d])([A-Z])/g;function wa(t){return t.replace(Ro,"$1-$2").toLowerCase()}function ia(t,e){return ot(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(wa(e)))}function Ht(t,e,n){ot(n)?t[e]=n:t.dataset?t.dataset[e]=n:t.setAttribute("data-".concat(wa(e)),n)}function Bo(t,e){if(ot(t[e]))try{delete t[e]}catch{t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch{t.dataset[e]=void 0}else t.removeAttribute("data-".concat(wa(e)))}var zr=/\s\s*/,Ur=(function(){var t=!1;if(wn){var e=!1,n=function(){},a=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(r){e=r}});Re.addEventListener("test",n,a),Re.removeEventListener("test",n,a)}return t})();function Le(t,e,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=n;e.trim().split(zr).forEach(function(r){if(!Ur){var o=t.listeners;o&&o[r]&&o[r][n]&&(i=o[r][n],delete o[r][n],Object.keys(o[r]).length===0&&delete o[r],Object.keys(o).length===0&&delete t.listeners)}t.removeEventListener(r,i,a)})}function Se(t,e,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=n;e.trim().split(zr).forEach(function(r){if(a.once&&!Ur){var o=t.listeners,s=o===void 0?{}:o;i=function(){delete s[r][n],t.removeEventListener(r,i,a);for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];n.apply(t,u)},s[r]||(s[r]={}),s[r][n]&&t.removeEventListener(r,s[r][n],a),s[r][n]=i,t.listeners=s}t.addEventListener(r,i,a)})}function wt(t,e,n){var a;return me(Event)&&me(CustomEvent)?a=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!0,!0,n)),t.dispatchEvent(a)}function Kr(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Bn=Re.location,Ho=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function er(t){var e=t.match(Ho);return e!==null&&(e[1]!==Bn.protocol||e[2]!==Bn.hostname||e[3]!==Bn.port)}function tr(t){var e="timestamp=".concat(new Date().getTime());return t+(t.indexOf("?")===-1?"?":"&")+e}function Rt(t){var e=t.rotate,n=t.scaleX,a=t.scaleY,i=t.translateX,r=t.translateY,o=[];$(i)&&i!==0&&o.push("translateX(".concat(i,"px)")),$(r)&&r!==0&&o.push("translateY(".concat(r,"px)")),$(e)&&e!==0&&o.push("rotate(".concat(e,"deg)")),$(n)&&n!==1&&o.push("scaleX(".concat(n,")")),$(a)&&a!==1&&o.push("scaleY(".concat(a,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function Xo(t){var e=Pr({},t),n=0;return re(t,function(a,i){delete e[i],re(e,function(r){var o=Math.abs(a.startX-r.startX),s=Math.abs(a.startY-r.startY),l=Math.abs(a.endX-r.endX),c=Math.abs(a.endY-r.endY),u=Math.sqrt(o*o+s*s),d=Math.sqrt(l*l+c*c),f=(d-u)/u;Math.abs(f)>Math.abs(n)&&(n=f)})}),n}function tn(t,e){var n=t.pageX,a=t.pageY,i={endX:n,endY:a};return e?i:Pr({startX:n,startY:a},i)}function $o(t){var e=0,n=0,a=0;return re(t,function(i){var r=i.startX,o=i.startY;e+=r,n+=o,a+=1}),e/=a,n/=a,{pageX:e,pageY:n}}function Je(t){var e=t.aspectRatio,n=t.height,a=t.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",r=Qa(a),o=Qa(n);if(r&&o){var s=n*e;i==="contain"&&s>a||i==="cover"&&s<a?n=a/e:a=n*e}else r?n=a/e:o&&(a=n*e);return{width:a,height:n}}function Yo(t){var e=t.width,n=t.height,a=t.degree;if(a=Math.abs(a)%180,a===90)return{width:n,height:e};var i=a%90*Math.PI/180,r=Math.sin(i),o=Math.cos(i),s=e*o+n*r,l=e*r+n*o;return a>90?{width:l,height:s}:{width:s,height:l}}function Wo(t,e,n,a){var i=e.aspectRatio,r=e.naturalWidth,o=e.naturalHeight,s=e.rotate,l=s===void 0?0:s,c=e.scaleX,u=c===void 0?1:c,d=e.scaleY,f=d===void 0?1:d,h=n.aspectRatio,g=n.naturalWidth,v=n.naturalHeight,b=a.fillColor,_=b===void 0?"transparent":b,w=a.imageSmoothingEnabled,k=w===void 0?!0:w,T=a.imageSmoothingQuality,y=T===void 0?"low":T,p=a.maxWidth,C=p===void 0?1/0:p,O=a.maxHeight,N=O===void 0?1/0:O,K=a.minWidth,W=K===void 0?0:K,de=a.minHeight,Q=de===void 0?0:de,ee=document.createElement("canvas"),J=ee.getContext("2d"),oe=Je({aspectRatio:h,width:C,height:N}),Ae=Je({aspectRatio:h,width:W,height:Q},"cover"),Ce=Math.min(oe.width,Math.max(Ae.width,g)),Ze=Math.min(oe.height,Math.max(Ae.height,v)),Tt=Je({aspectRatio:i,width:C,height:N}),Qe=Je({aspectRatio:i,width:W,height:Q},"cover"),He=Math.min(Tt.width,Math.max(Qe.width,r)),Me=Math.min(Tt.height,Math.max(Qe.height,o)),En=[-He/2,-Me/2,He,Me];return ee.width=bt(Ce),ee.height=bt(Ze),J.fillStyle=_,J.fillRect(0,0,Ce,Ze),J.save(),J.translate(Ce/2,Ze/2),J.rotate(l*Math.PI/180),J.scale(u,f),J.imageSmoothingEnabled=k,J.imageSmoothingQuality=y,J.drawImage.apply(J,[t].concat(Rr(En.map(function(lt){return Math.floor(bt(lt))})))),J.restore(),ee}var Vr=String.fromCharCode;function Fo(t,e,n){var a="";n+=e;for(var i=e;i<n;i+=1)a+=Vr(t.getUint8(i));return a}var jo=/^data:.*,/;function zo(t){var e=t.replace(jo,""),n=atob(e),a=new ArrayBuffer(n.length),i=new Uint8Array(a);return re(i,function(r,o){i[o]=n.charCodeAt(o)}),a}function Uo(t,e){for(var n=[],a=8192,i=new Uint8Array(t);i.length>0;)n.push(Vr.apply(null,jr(i.subarray(0,a)))),i=i.subarray(a);return"data:".concat(e,";base64,").concat(btoa(n.join("")))}function Ko(t){var e=new DataView(t),n;try{var a,i,r;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var o=e.byteLength,s=2;s+1<o;){if(e.getUint8(s)===255&&e.getUint8(s+1)===225){i=s;break}s+=1}if(i){var l=i+4,c=i+10;if(Fo(e,l,4)==="Exif"){var u=e.getUint16(c);if(a=u===18761,(a||u===19789)&&e.getUint16(c+2,a)===42){var d=e.getUint32(c+4,a);d>=8&&(r=c+d)}}}if(r){var f=e.getUint16(r,a),h,g;for(g=0;g<f;g+=1)if(h=r+g*12+2,e.getUint16(h,a)===274){h+=8,n=e.getUint16(h,a),e.setUint16(h,1,a);break}}}catch{n=1}return n}function Vo(t){var e=0,n=1,a=1;switch(t){case 2:n=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,n=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:n,scaleY:a}}var Go={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,n=this.options,a=this.container,i=this.cropper,r=Number(n.minContainerWidth),o=Number(n.minContainerHeight);se(i,ge),Pe(e,ge);var s={width:Math.max(a.offsetWidth,r>=0?r:Wr),height:Math.max(a.offsetHeight,o>=0?o:Fr)};this.containerData=s,Ge(i,{width:s.width,height:s.height}),se(e,ge),Pe(i,ge)},initCanvas:function(){var e=this.containerData,n=this.imageData,a=this.options.viewMode,i=Math.abs(n.rotate)%180===90,r=i?n.naturalHeight:n.naturalWidth,o=i?n.naturalWidth:n.naturalHeight,s=r/o,l=e.width,c=e.height;e.height*s>e.width?a===3?l=e.height*s:c=e.width/s:a===3?c=e.width/s:l=e.height*s;var u={aspectRatio:s,naturalWidth:r,naturalHeight:o,width:l,height:c};this.canvasData=u,this.limited=a===1||a===2,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(e.width-u.width)/2,u.top=(e.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=U({},u)},limitCanvas:function(e,n){var a=this.options,i=this.containerData,r=this.canvasData,o=this.cropBoxData,s=a.viewMode,l=r.aspectRatio,c=this.cropped&&o;if(e){var u=Number(a.minCanvasWidth)||0,d=Number(a.minCanvasHeight)||0;s>1?(u=Math.max(u,i.width),d=Math.max(d,i.height),s===3&&(d*l>u?u=d*l:d=u/l)):s>0&&(u?u=Math.max(u,c?o.width:0):d?d=Math.max(d,c?o.height:0):c&&(u=o.width,d=o.height,d*l>u?u=d*l:d=u/l));var f=Je({aspectRatio:l,width:u,height:d});u=f.width,d=f.height,r.minWidth=u,r.minHeight=d,r.maxWidth=1/0,r.maxHeight=1/0}if(n)if(s>(c?0:1)){var h=i.width-r.width,g=i.height-r.height;r.minLeft=Math.min(0,h),r.minTop=Math.min(0,g),r.maxLeft=Math.max(0,h),r.maxTop=Math.max(0,g),c&&this.limited&&(r.minLeft=Math.min(o.left,o.left+(o.width-r.width)),r.minTop=Math.min(o.top,o.top+(o.height-r.height)),r.maxLeft=o.left,r.maxTop=o.top,s===2&&(r.width>=i.width&&(r.minLeft=Math.min(0,h),r.maxLeft=Math.max(0,h)),r.height>=i.height&&(r.minTop=Math.min(0,g),r.maxTop=Math.max(0,g))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=i.width,r.maxTop=i.height},renderCanvas:function(e,n){var a=this.canvasData,i=this.imageData;if(n){var r=Yo({width:i.naturalWidth*Math.abs(i.scaleX||1),height:i.naturalHeight*Math.abs(i.scaleY||1),degree:i.rotate||0}),o=r.width,s=r.height,l=a.width*(o/a.naturalWidth),c=a.height*(s/a.naturalHeight);a.left-=(l-a.width)/2,a.top-=(c-a.height)/2,a.width=l,a.height=c,a.aspectRatio=o/s,a.naturalWidth=o,a.naturalHeight=s,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,Ge(this.canvas,U({width:a.width,height:a.height},Rt({translateX:a.left,translateY:a.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var n=this.canvasData,a=this.imageData,i=a.naturalWidth*(n.width/n.naturalWidth),r=a.naturalHeight*(n.height/n.naturalHeight);U(a,{width:i,height:r,left:(n.width-i)/2,top:(n.height-r)/2}),Ge(this.image,U({width:a.width,height:a.height},Rt(U({translateX:a.left,translateY:a.top},a)))),e&&this.output()},initCropBox:function(){var e=this.options,n=this.canvasData,a=e.aspectRatio||e.initialAspectRatio,i=Number(e.autoCropArea)||.8,r={width:n.width,height:n.height};a&&(n.height*a>n.width?r.height=r.width/a:r.width=r.height*a),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*i),r.height=Math.max(r.minHeight,r.height*i),r.left=n.left+(n.width-r.width)/2,r.top=n.top+(n.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=U({},r)},limitCropBox:function(e,n){var a=this.options,i=this.containerData,r=this.canvasData,o=this.cropBoxData,s=this.limited,l=a.aspectRatio;if(e){var c=Number(a.minCropBoxWidth)||0,u=Number(a.minCropBoxHeight)||0,d=s?Math.min(i.width,r.width,r.width+r.left,i.width-r.left):i.width,f=s?Math.min(i.height,r.height,r.height+r.top,i.height-r.top):i.height;c=Math.min(c,i.width),u=Math.min(u,i.height),l&&(c&&u?u*l>c?u=c/l:c=u*l:c?u=c/l:u&&(c=u*l),f*l>d?f=d/l:d=f*l),o.minWidth=Math.min(c,d),o.minHeight=Math.min(u,f),o.maxWidth=d,o.maxHeight=f}n&&(s?(o.minLeft=Math.max(0,r.left),o.minTop=Math.max(0,r.top),o.maxLeft=Math.min(i.width,r.left+r.width)-o.width,o.maxTop=Math.min(i.height,r.top+r.height)-o.height):(o.minLeft=0,o.minTop=0,o.maxLeft=i.width-o.width,o.maxTop=i.height-o.height))},renderCropBox:function(){var e=this.options,n=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,e.movable&&e.cropBoxMovable&&Ht(this.face,Bt,a.width>=n.width&&a.height>=n.height?Hr:ya),Ge(this.cropBox,U({width:a.width,height:a.height},Rt({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),wt(this.element,ea,this.getData())}},Jo={initPreview:function(){var e=this.element,n=this.crossOrigin,a=this.options.preview,i=n?this.crossOriginUrl:this.url,r=e.alt||"The image to preview",o=document.createElement("img");if(n&&(o.crossOrigin=n),o.src=i,o.alt=r,this.viewBox.appendChild(o),this.viewBoxImage=o,!!a){var s=a;typeof a=="string"?s=e.ownerDocument.querySelectorAll(a):a.querySelector&&(s=[a]),this.previews=s,re(s,function(l){var c=document.createElement("img");Ht(l,en,{width:l.offsetWidth,height:l.offsetHeight,html:l.innerHTML}),n&&(c.crossOrigin=n),c.src=i,c.alt=r,c.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',l.innerHTML="",l.appendChild(c)})}},resetPreview:function(){re(this.previews,function(e){var n=ia(e,en);Ge(e,{width:n.width,height:n.height}),e.innerHTML=n.html,Bo(e,en)})},preview:function(){var e=this.imageData,n=this.canvasData,a=this.cropBoxData,i=a.width,r=a.height,o=e.width,s=e.height,l=a.left-n.left-e.left,c=a.top-n.top-e.top;!this.cropped||this.disabled||(Ge(this.viewBoxImage,U({width:o,height:s},Rt(U({translateX:-l,translateY:-c},e)))),re(this.previews,function(u){var d=ia(u,en),f=d.width,h=d.height,g=f,v=h,b=1;i&&(b=f/i,v=r*b),r&&v>h&&(b=h/r,g=i*b,v=h),Ge(u,{width:g,height:v}),Ge(u.getElementsByTagName("img")[0],U({width:o*b,height:s*b},Rt(U({translateX:-l*b,translateY:-c*b},e))))}))}},Zo={bind:function(){var e=this.element,n=this.options,a=this.cropper;me(n.cropstart)&&Se(e,aa,n.cropstart),me(n.cropmove)&&Se(e,na,n.cropmove),me(n.cropend)&&Se(e,ta,n.cropend),me(n.crop)&&Se(e,ea,n.crop),me(n.zoom)&&Se(e,ra,n.zoom),Se(a,ja,this.onCropStart=this.cropStart.bind(this)),n.zoomable&&n.zoomOnWheel&&Se(a,Ga,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&Se(a,Fa,this.onDblclick=this.dblclick.bind(this)),Se(e.ownerDocument,za,this.onCropMove=this.cropMove.bind(this)),Se(e.ownerDocument,Ua,this.onCropEnd=this.cropEnd.bind(this)),n.responsive&&Se(window,Va,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,n=this.options,a=this.cropper;me(n.cropstart)&&Le(e,aa,n.cropstart),me(n.cropmove)&&Le(e,na,n.cropmove),me(n.cropend)&&Le(e,ta,n.cropend),me(n.crop)&&Le(e,ea,n.crop),me(n.zoom)&&Le(e,ra,n.zoom),Le(a,ja,this.onCropStart),n.zoomable&&n.zoomOnWheel&&Le(a,Ga,this.onWheel,{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&Le(a,Fa,this.onDblclick),Le(e.ownerDocument,za,this.onCropMove),Le(e.ownerDocument,Ua,this.onCropEnd),n.responsive&&Le(window,Va,this.onResize)}},Qo={resize:function(){if(!this.disabled){var e=this.options,n=this.container,a=this.containerData,i=n.offsetWidth/a.width,r=n.offsetHeight/a.height,o=Math.abs(i-1)>Math.abs(r-1)?i:r;if(o!==1){var s,l;e.restore&&(s=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(re(s,function(c,u){s[u]=c*o})),this.setCropBoxData(re(l,function(c,u){l[u]=c*o})))}}},dblclick:function(){this.disabled||this.options.dragMode===Yr||this.setDragMode(qo(this.dragBox,Zn)?$r:ba)},wheel:function(e){var n=this,a=Number(this.options.wheelZoomRatio)||.1,i=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){n.wheeling=!1},50),e.deltaY?i=e.deltaY>0?1:-1:e.wheelDelta?i=-e.wheelDelta/120:e.detail&&(i=e.detail>0?1:-1),this.zoom(-i*a,e)))},cropStart:function(e){var n=e.buttons,a=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&($(n)&&n!==1||$(a)&&a!==0||e.ctrlKey))){var i=this.options,r=this.pointers,o;e.changedTouches?re(e.changedTouches,function(s){r[s.identifier]=tn(s)}):r[e.pointerId||0]=tn(e),Object.keys(r).length>1&&i.zoomable&&i.zoomOnTouch?o=Xr:o=ia(e.target,Bt),Co.test(o)&&wt(this.element,aa,{originalEvent:e,action:o})!==!1&&(e.preventDefault(),this.action=o,this.cropping=!1,o===Br&&(this.cropping=!0,se(this.dragBox,mn)))}},cropMove:function(e){var n=this.action;if(!(this.disabled||!n)){var a=this.pointers;e.preventDefault(),wt(this.element,na,{originalEvent:e,action:n})!==!1&&(e.changedTouches?re(e.changedTouches,function(i){U(a[i.identifier]||{},tn(i,!0))}):U(a[e.pointerId||0]||{},tn(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var n=this.action,a=this.pointers;e.changedTouches?re(e.changedTouches,function(i){delete a[i.identifier]}):delete a[e.pointerId||0],n&&(e.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,vt(this.dragBox,mn,this.cropped&&this.options.modal)),wt(this.element,ta,{originalEvent:e,action:n}))}}},es={change:function(e){var n=this.options,a=this.canvasData,i=this.containerData,r=this.cropBoxData,o=this.pointers,s=this.action,l=n.aspectRatio,c=r.left,u=r.top,d=r.width,f=r.height,h=c+d,g=u+f,v=0,b=0,_=i.width,w=i.height,k=!0,T;!l&&e.shiftKey&&(l=d&&f?d/f:1),this.limited&&(v=r.minLeft,b=r.minTop,_=v+Math.min(i.width,a.width,a.left+a.width),w=b+Math.min(i.height,a.height,a.top+a.height));var y=o[Object.keys(o)[0]],p={x:y.endX-y.startX,y:y.endY-y.startY},C=function(N){switch(N){case nt:h+p.x>_&&(p.x=_-h);break;case at:c+p.x<v&&(p.x=v-c);break;case je:u+p.y<b&&(p.y=b-u);break;case ut:g+p.y>w&&(p.y=w-g);break}};switch(s){case ya:c+=p.x,u+=p.y;break;case nt:if(p.x>=0&&(h>=_||l&&(u<=b||g>=w))){k=!1;break}C(nt),d+=p.x,d<0&&(s=at,d=-d,c-=d),l&&(f=d/l,u+=(r.height-f)/2);break;case je:if(p.y<=0&&(u<=b||l&&(c<=v||h>=_))){k=!1;break}C(je),f-=p.y,u+=p.y,f<0&&(s=ut,f=-f,u-=f),l&&(d=f*l,c+=(r.width-d)/2);break;case at:if(p.x<=0&&(c<=v||l&&(u<=b||g>=w))){k=!1;break}C(at),d-=p.x,c+=p.x,d<0&&(s=nt,d=-d,c-=d),l&&(f=d/l,u+=(r.height-f)/2);break;case ut:if(p.y>=0&&(g>=w||l&&(c<=v||h>=_))){k=!1;break}C(ut),f+=p.y,f<0&&(s=je,f=-f,u-=f),l&&(d=f*l,c+=(r.width-d)/2);break;case xt:if(l){if(p.y<=0&&(u<=b||h>=_)){k=!1;break}C(je),f-=p.y,u+=p.y,d=f*l}else C(je),C(nt),p.x>=0?h<_?d+=p.x:p.y<=0&&u<=b&&(k=!1):d+=p.x,p.y<=0?u>b&&(f-=p.y,u+=p.y):(f-=p.y,u+=p.y);d<0&&f<0?(s=_t,f=-f,d=-d,u-=f,c-=d):d<0?(s=At,d=-d,c-=d):f<0&&(s=Ct,f=-f,u-=f);break;case At:if(l){if(p.y<=0&&(u<=b||c<=v)){k=!1;break}C(je),f-=p.y,u+=p.y,d=f*l,c+=r.width-d}else C(je),C(at),p.x<=0?c>v?(d-=p.x,c+=p.x):p.y<=0&&u<=b&&(k=!1):(d-=p.x,c+=p.x),p.y<=0?u>b&&(f-=p.y,u+=p.y):(f-=p.y,u+=p.y);d<0&&f<0?(s=Ct,f=-f,d=-d,u-=f,c-=d):d<0?(s=xt,d=-d,c-=d):f<0&&(s=_t,f=-f,u-=f);break;case _t:if(l){if(p.x<=0&&(c<=v||g>=w)){k=!1;break}C(at),d-=p.x,c+=p.x,f=d/l}else C(ut),C(at),p.x<=0?c>v?(d-=p.x,c+=p.x):p.y>=0&&g>=w&&(k=!1):(d-=p.x,c+=p.x),p.y>=0?g<w&&(f+=p.y):f+=p.y;d<0&&f<0?(s=xt,f=-f,d=-d,u-=f,c-=d):d<0?(s=Ct,d=-d,c-=d):f<0&&(s=At,f=-f,u-=f);break;case Ct:if(l){if(p.x>=0&&(h>=_||g>=w)){k=!1;break}C(nt),d+=p.x,f=d/l}else C(ut),C(nt),p.x>=0?h<_?d+=p.x:p.y>=0&&g>=w&&(k=!1):d+=p.x,p.y>=0?g<w&&(f+=p.y):f+=p.y;d<0&&f<0?(s=At,f=-f,d=-d,u-=f,c-=d):d<0?(s=_t,d=-d,c-=d):f<0&&(s=xt,f=-f,u-=f);break;case Hr:this.move(p.x,p.y),k=!1;break;case Xr:this.zoom(Xo(o),e),k=!1;break;case Br:if(!p.x||!p.y){k=!1;break}T=Kr(this.cropper),c=y.startX-T.left,u=y.startY-T.top,d=r.minWidth,f=r.minHeight,p.x>0?s=p.y>0?Ct:xt:p.x<0&&(c-=d,s=p.y>0?_t:At),p.y<0&&(u-=f),this.cropped||(Pe(this.cropBox,ge),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}k&&(r.width=d,r.height=f,r.left=c,r.top=u,this.action=s,this.renderCropBox()),re(o,function(O){O.startX=O.endX,O.startY=O.endY})}},ts={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&se(this.dragBox,mn),Pe(this.cropBox,ge),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=U({},this.initialImageData),this.canvasData=U({},this.initialCanvasData),this.cropBoxData=U({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(U(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Pe(this.dragBox,mn),se(this.cropBox,ge)),this},replace:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),n?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,re(this.previews,function(a){a.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Pe(this.cropper,Ya)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,se(this.cropper,Ya)),this},destroy:function(){var e=this.element;return e[z]?(e[z]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,i=a.left,r=a.top;return this.moveTo(Rn(e)?e:i+Number(e),Rn(n)?n:r+Number(n))},moveTo:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.canvasData,i=!1;return e=Number(e),n=Number(n),this.ready&&!this.disabled&&this.options.movable&&($(e)&&(a.left=e,i=!0),$(n)&&(a.top=n,i=!0),i&&this.renderCanvas(!0)),this},zoom:function(e,n){var a=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(a.width*e/a.naturalWidth,null,n)},zoomTo:function(e,n,a){var i=this.options,r=this.canvasData,o=r.width,s=r.height,l=r.naturalWidth,c=r.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&i.zoomable){var u=l*e,d=c*e;if(wt(this.element,ra,{ratio:e,oldRatio:o/l,originalEvent:a})===!1)return this;if(a){var f=this.pointers,h=Kr(this.cropper),g=f&&Object.keys(f).length?$o(f):{pageX:a.pageX,pageY:a.pageY};r.left-=(u-o)*((g.pageX-h.left-r.left)/o),r.top-=(d-s)*((g.pageY-h.top-r.top)/s)}else gt(n)&&$(n.x)&&$(n.y)?(r.left-=(u-o)*((n.x-r.left)/o),r.top-=(d-s)*((n.y-r.top)/s)):(r.left-=(u-o)/2,r.top-=(d-s)/2);r.width=u,r.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),$(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var n=this.imageData.scaleY;return this.scale(e,$(n)?n:1)},scaleY:function(e){var n=this.imageData.scaleX;return this.scale($(n)?n:1,e)},scale:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,a=this.imageData,i=!1;return e=Number(e),n=Number(n),this.ready&&!this.disabled&&this.options.scalable&&($(e)&&(a.scaleX=e,i=!0),$(n)&&(a.scaleY=n,i=!0),i&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.options,a=this.imageData,i=this.canvasData,r=this.cropBoxData,o;if(this.ready&&this.cropped){o={x:r.left-i.left,y:r.top-i.top,width:r.width,height:r.height};var s=a.width/a.naturalWidth;if(re(o,function(u,d){o[d]=u/s}),e){var l=Math.round(o.y+o.height),c=Math.round(o.x+o.width);o.x=Math.round(o.x),o.y=Math.round(o.y),o.width=c-o.x,o.height=l-o.y}}else o={x:0,y:0,width:0,height:0};return n.rotatable&&(o.rotate=a.rotate||0),n.scalable&&(o.scaleX=a.scaleX||1,o.scaleY=a.scaleY||1),o},setData:function(e){var n=this.options,a=this.imageData,i=this.canvasData,r={};if(this.ready&&!this.disabled&&gt(e)){var o=!1;n.rotatable&&$(e.rotate)&&e.rotate!==a.rotate&&(a.rotate=e.rotate,o=!0),n.scalable&&($(e.scaleX)&&e.scaleX!==a.scaleX&&(a.scaleX=e.scaleX,o=!0),$(e.scaleY)&&e.scaleY!==a.scaleY&&(a.scaleY=e.scaleY,o=!0)),o&&this.renderCanvas(!0,!0);var s=a.width/a.naturalWidth;$(e.x)&&(r.left=e.x*s+i.left),$(e.y)&&(r.top=e.y*s+i.top),$(e.width)&&(r.width=e.width*s),$(e.height)&&(r.height=e.height*s),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?U({},this.containerData):{}},getImageData:function(){return this.sized?U({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,n={};return this.ready&&re(["left","top","width","height","naturalWidth","naturalHeight"],function(a){n[a]=e[a]}),n},setCanvasData:function(e){var n=this.canvasData,a=n.aspectRatio;return this.ready&&!this.disabled&&gt(e)&&($(e.left)&&(n.left=e.left),$(e.top)&&(n.top=e.top),$(e.width)?(n.width=e.width,n.height=e.width/a):$(e.height)&&(n.height=e.height,n.width=e.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,n;return this.ready&&this.cropped&&(n={left:e.left,top:e.top,width:e.width,height:e.height}),n||{}},setCropBoxData:function(e){var n=this.cropBoxData,a=this.options.aspectRatio,i,r;return this.ready&&this.cropped&&!this.disabled&&gt(e)&&($(e.left)&&(n.left=e.left),$(e.top)&&(n.top=e.top),$(e.width)&&e.width!==n.width&&(i=!0,n.width=e.width),$(e.height)&&e.height!==n.height&&(r=!0,n.height=e.height),a&&(i?n.height=n.width/a:r&&(n.width=n.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var n=this.canvasData,a=Wo(this.image,this.imageData,n,e);if(!this.cropped)return a;var i=this.getData(e.rounded),r=i.x,o=i.y,s=i.width,l=i.height,c=a.width/Math.floor(n.naturalWidth);c!==1&&(r*=c,o*=c,s*=c,l*=c);var u=s/l,d=Je({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=Je({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),h=Je({aspectRatio:u,width:e.width||(c!==1?a.width:s),height:e.height||(c!==1?a.height:l)}),g=h.width,v=h.height;g=Math.min(d.width,Math.max(f.width,g)),v=Math.min(d.height,Math.max(f.height,v));var b=document.createElement("canvas"),_=b.getContext("2d");b.width=bt(g),b.height=bt(v),_.fillStyle=e.fillColor||"transparent",_.fillRect(0,0,g,v);var w=e.imageSmoothingEnabled,k=w===void 0?!0:w,T=e.imageSmoothingQuality;_.imageSmoothingEnabled=k,T&&(_.imageSmoothingQuality=T);var y=a.width,p=a.height,C=r,O=o,N,K,W,de,Q,ee;C<=-s||C>y?(C=0,N=0,W=0,Q=0):C<=0?(W=-C,C=0,N=Math.min(y,s+C),Q=N):C<=y&&(W=0,N=Math.min(s,y-C),Q=N),N<=0||O<=-l||O>p?(O=0,K=0,de=0,ee=0):O<=0?(de=-O,O=0,K=Math.min(p,l+O),ee=K):O<=p&&(de=0,K=Math.min(l,p-O),ee=K);var J=[C,O,N,K];if(Q>0&&ee>0){var oe=g/s;J.push(W*oe,de*oe,Q*oe,ee*oe)}return _.drawImage.apply(_,[a].concat(Rr(J.map(function(Ae){return Math.floor(bt(Ae))})))),b},setAspectRatio:function(e){var n=this.options;return!this.disabled&&!Rn(e)&&(n.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var n=this.options,a=this.dragBox,i=this.face;if(this.ready&&!this.disabled){var r=e===ba,o=n.movable&&e===$r;e=r||o?e:Yr,n.dragMode=e,Ht(a,Bt,e),vt(a,Zn,r),vt(a,Qn,o),n.cropBoxMovable||(Ht(i,Bt,e),vt(i,Zn,r),vt(i,Qn,o))}return this}},ns=Re.Cropper,Gr=(function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(mo(this,t),!e||!Do.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=U({},Za,gt(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return go(t,[{key:"init",value:function(){var n=this.element,a=n.tagName.toLowerCase(),i;if(!n[z]){if(n[z]=this,a==="img"){if(this.isImg=!0,i=n.getAttribute("src")||"",this.originalUrl=i,!i)return;i=n.src}else a==="canvas"&&window.HTMLCanvasElement&&(i=n.toDataURL());this.load(i)}}},{key:"load",value:function(n){var a=this;if(n){this.url=n,this.imageData={};var i=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer){this.clone();return}if(_o.test(n)){Lo.test(n)?this.read(zo(n)):this.clone();return}var o=new XMLHttpRequest,s=this.clone.bind(this);this.reloading=!0,this.xhr=o,o.onabort=s,o.onerror=s,o.ontimeout=s,o.onprogress=function(){o.getResponseHeader("content-type")!==Ja&&o.abort()},o.onload=function(){a.read(o.response)},o.onloadend=function(){a.reloading=!1,a.xhr=null},r.checkCrossOrigin&&er(n)&&i.crossOrigin&&(n=tr(n)),o.open("GET",n,!0),o.responseType="arraybuffer",o.withCredentials=i.crossOrigin==="use-credentials",o.send()}}},{key:"read",value:function(n){var a=this.options,i=this.imageData,r=Ko(n),o=0,s=1,l=1;if(r>1){this.url=Uo(n,Ja);var c=Vo(r);o=c.rotate,s=c.scaleX,l=c.scaleY}a.rotatable&&(i.rotate=o),a.scalable&&(i.scaleX=s,i.scaleY=l),this.clone()}},{key:"clone",value:function(){var n=this.element,a=this.url,i=n.crossOrigin,r=a;this.options.checkCrossOrigin&&er(a)&&(i||(i="anonymous"),r=tr(a)),this.crossOrigin=i,this.crossOriginUrl=r;var o=document.createElement("img");i&&(o.crossOrigin=i),o.src=r||a,o.alt=n.alt||"The image to crop",this.image=o,o.onload=this.start.bind(this),o.onerror=this.stop.bind(this),se(o,Wa),n.parentNode.insertBefore(o,n.nextSibling)}},{key:"start",value:function(){var n=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var i=Re.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Re.navigator.userAgent),r=function(c,u){U(n.imageData,{naturalWidth:c,naturalHeight:u,aspectRatio:c/u}),n.initialImageData=U({},n.imageData),n.sizing=!1,n.sized=!0,n.build()};if(a.naturalWidth&&!i){r(a.naturalWidth,a.naturalHeight);return}var o=document.createElement("img"),s=document.body||document.documentElement;this.sizingImage=o,o.onload=function(){r(o.width,o.height),i||s.removeChild(o)},o.src=a.src,i||(o.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",s.appendChild(o))}},{key:"stop",value:function(){var n=this.image;n.onload=null,n.onerror=null,n.parentNode.removeChild(n),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var n=this.element,a=this.options,i=this.image,r=n.parentNode,o=document.createElement("div");o.innerHTML=Mo;var s=o.querySelector(".".concat(z,"-container")),l=s.querySelector(".".concat(z,"-canvas")),c=s.querySelector(".".concat(z,"-drag-box")),u=s.querySelector(".".concat(z,"-crop-box")),d=u.querySelector(".".concat(z,"-face"));this.container=r,this.cropper=s,this.canvas=l,this.dragBox=c,this.cropBox=u,this.viewBox=s.querySelector(".".concat(z,"-view-box")),this.face=d,l.appendChild(i),se(n,ge),r.insertBefore(s,n.nextSibling),Pe(i,Wa),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,se(u,ge),a.guides||se(u.getElementsByClassName("".concat(z,"-dashed")),ge),a.center||se(u.getElementsByClassName("".concat(z,"-center")),ge),a.background&&se(s,"".concat(z,"-bg")),a.highlight||se(d,So),a.cropBoxMovable&&(se(d,Qn),Ht(d,Bt,ya)),a.cropBoxResizable||(se(u.getElementsByClassName("".concat(z,"-line")),ge),se(u.getElementsByClassName("".concat(z,"-point")),ge)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),me(a.ready)&&Se(n,Ka,a.ready,{once:!0}),wt(n,Ka)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var n=this.cropper.parentNode;n&&n.removeChild(this.cropper),Pe(this.element,ge)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ns,t}},{key:"setDefaults",value:function(n){U(Za,gt(n)&&n)}}])})();U(Gr.prototype,Go,Jo,Zo,Qo,es,ts);function m(t,e={}){if(!window.AveTranslations)return console.warn("AveTranslations not loaded"),t;const n=t.split(".");let a=window.AveTranslations;for(const r of n)if(a&&typeof a=="object"&&r in a)a=a[r];else return console.warn(`Translation key not found: ${t}`),t;if(typeof a!="string")return console.warn(`Translation value is not a string: ${t}`),t;let i=a;for(const[r,o]of Object.entries(e))i=i.replace(`:${r}`,o);return i}const Jr=t=>{if(!t)return;t.classList.add("is-active"),t.setAttribute("aria-hidden","false"),t.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},ke=t=>{t&&(t.classList.remove("is-active"),t.setAttribute("aria-hidden","true"))},Be=t=>{t&&(ke(t),setTimeout(()=>t.remove(),300))},fe=t=>{const{title:e="Modal",body:n="",bodyParams:a=null,type:i="default",variant:r="default",confirmText:o="OK",cancelText:s="Cancel",onConfirm:l=null,onCancel:c=null,size:u="default",autoClose:d=!0}=t,f=document.createElement("div");f.className="modal",f.setAttribute("data-ave-modal",""),f.setAttribute("data-modal-dynamic","true");const h=u==="small"?"modal-sm":u==="large"?"modal-lg":"",g=r!=="default"?`modal-${r}`:"";let v=n;if(a&&Array.isArray(a)&&a.length>0){const y=a.map(p=>`<span class="modal-param">"${p}"</span>`).join(", ");v=`<p class="modal-message">${n} ${y}</p>`}else n&&!n.startsWith("<")&&(v=`<p>${n}</p>`);f.innerHTML=`
        <div class="modal-background" data-ave-modal-close></div>
        <div class="modal-dialog ${h} ${g}">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">${e}</h4>
                    <button class="close" data-ave-modal-dismiss type="button">&times;</button>
                </div>
                <div class="modal-body">
                    ${v}
                </div>
                <div class="modal-footer">
                    ${i==="alert"?`
                        <button class="btn btn-modal-confirm" data-modal-confirm type="button">${o}</button>
                    `:i==="confirm"?`
                        <button class="btn btn-default" data-modal-cancel type="button">${s}</button>
                        <button class="btn btn-modal-confirm" data-modal-confirm type="button">${o}</button>
                    `:i==="form"?`
                        <button class="btn btn-default" data-modal-cancel type="button">${s}</button>
                        <button class="btn btn-modal-confirm" data-modal-confirm type="button">${o}</button>
                    `:""}
                </div>
            </div>
        </div>
    `;const b=f.querySelector("[data-modal-confirm]"),_=f.querySelector("[data-modal-cancel]"),w=f.querySelector("[data-ave-modal-dismiss]"),k=f.querySelector("[data-ave-modal-close]"),T=()=>{ke(f),setTimeout(()=>f.remove(),300)};return b&&b.addEventListener("click",()=>{l&&l(f),d&&setTimeout(()=>T(),0)}),_&&_.addEventListener("click",()=>{c&&c(),T()}),w&&w.addEventListener("click",T),k&&k.addEventListener("click",()=>{c&&c(),T()}),document.body.appendChild(f),requestAnimationFrame(()=>{Jr(f),xe.emit("dom:updated",f)}),f},Xt=(t,e={})=>new Promise(n=>{fe({title:e.title||m("common.confirm"),body:t,bodyParams:e.bodyParams||null,type:"confirm",variant:e.variant||"default",confirmText:e.confirmText||m("common.yes"),cancelText:e.cancelText||m("common.cancel"),size:e.size||"small",onConfirm:()=>n(!0),onCancel:()=>n(!1)})}),as=(t,e={})=>{fe({title:e.title||m("common.alert"),body:t,bodyParams:e.bodyParams||null,type:"alert",variant:e.variant||"default",confirmText:e.confirmText||m("common.ok"),size:e.size||"small"})};function rs(){window.Ave=window.Ave||{},window.Ave.confirm=Xt,window.Ave.createModal=fe,window.Ave.closeModal=ke,window.Ave.destroyModal=Be,document.querySelectorAll("[data-ave-modal-trigger]").forEach(t=>{const e=t.getAttribute("data-ave-modal-trigger"),n=e?document.querySelector(e):null;n&&t.addEventListener("click",a=>{a.preventDefault(),Jr(n)})}),document.querySelectorAll("[data-ave-modal]").forEach(t=>{t.addEventListener("click",e=>{e.target.hasAttribute("data-ave-modal-close")&&ke(t)}),t.querySelectorAll("[data-ave-modal-dismiss]").forEach(e=>{e.addEventListener("click",n=>{n.preventDefault(),ke(t)})})}),document.addEventListener("keydown",t=>{if(t.key==="Escape"){const e=document.querySelector("[data-ave-modal].is-active");e&&ke(e)}})}let It=null;const A=(t="success",e="",n=4e3)=>{if(!It&&(It=document.getElementById("toast-container"),!It)){console.error(m("toast.container_not_found"));return}const a={success:m("toast.defaults.success"),danger:m("toast.defaults.error"),warning:m("toast.defaults.warning"),info:m("toast.defaults.info")},i={success:m("toast.titles.success"),danger:m("toast.titles.error"),warning:m("toast.titles.warning"),info:m("toast.titles.info")},r=document.createElement("div");r.className=`toast toast-${t}`;const s=(e||a[t]||a.info).split(`
`).map(c=>`<p>${c}</p>`).join("");r.innerHTML=`
        <div class="toast-title">${i[t]||i.info}</div>
        <div class="toast-message">${s}</div>
    `,It.appendChild(r),requestAnimationFrame(()=>{r.classList.add("show")});const l=t==="danger"?Math.max(n,6e3):n;window.setTimeout(()=>{r.classList.remove("show"),window.setTimeout(()=>r.remove(),200)},l)};function is(){It=document.getElementById("toast-container");const t=document.getElementById("ave-toast-data");if(t)try{const e=JSON.parse(t.textContent);e.type&&e.message&&A(e.type,e.message)}catch(e){console.error(m("toast.parse_error"),e)}document.querySelectorAll("[data-ave-toast-trigger]").forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();const a=e.getAttribute("data-ave-toast-trigger")||"success",i=e.getAttribute("data-ave-toast-message")||"";A(a,i)})})}const gn={SORTABLE:400,COLLAPSE:300},Ea={SORTABLE:"cubic-bezier(0.25, 0.8, 0.25, 1)"},os={OK:200},Hn={BYTE_FACTOR:1024,DECIMAL_PLACES:1};function ss(t,e=Hn.DECIMAL_PLACES){const n=["B","KB","MB","GB","TB"];if(t<=0)return"0B";const a=Math.floor(Math.log(t)/Math.log(Hn.BYTE_FACTOR));return(t/Math.pow(Hn.BYTE_FACTOR,a)).toFixed(e)+n[a]}const Zr=new Map,oa=(t="")=>t?t.replace(/\]/g,"").replace(/\[/g,".").replace(/\.+/g,".").replace(/^\./,"").replace(/\.$/,"").toLowerCase():"",nr=(t,e)=>t.replace(/__INDEX__/g,e).replace(/__index__/g,e).replace(/__ITEM__/g,e).replace(/__item__/g,e).replace(/__TEMPLATE__/g,e).replace(/__template__/g,e);function ar(t){if(!t||!t.classList.contains("media-field-container"))return;const e=t.dataset.metaKey;if(!e||!e.includes("__item__")&&!e.includes("__template__"))return;const n=t.closest("[data-fieldset-item]");if(!n)return;const a=n.dataset.itemId;if(a===void 0)return;const i=nr(e,a),r=oa(i);if(t.dataset.metaKey=r,t.dataset.collection&&/__(ITEM|TEMPLATE)__/.test(t.dataset.collection)){const o=nr(t.dataset.collection,a);t.dataset.collection=o}t.querySelectorAll('input[data-uploaded-ids], input[data-deleted-ids], input[data-media-props="true"]').forEach(o=>{o.name&&o.name.includes(e)&&(o.name=o.name.replace(e,r))}),delete t.dataset.initialized}function ls(){Zr.forEach(t=>{t.uploadedIdsInput&&(t.uploadedIdsInput.value=t.uploadedIds.join(",")),t.deletedIdsInput&&(t.deletedIdsInput.value=t.deletedIds.join(",")),sa(t)})}function sa(t){const{fieldValueInput:e,container:n,collection:a,uploadedIds:i}=t;if(!e||!n)return;const r=n.querySelector("[data-media-grid]"),s=(r?r.querySelectorAll(".media-item"):[]).length>0||(i??[]).length>0;e.value=s?a:""}function vn(t=document){t.querySelectorAll(".media-field-container").forEach(e=>{if(e.dataset.initialized==="true")return;e.dataset.initialized="true";const n=e.dataset.multiple==="true",a=parseInt(e.dataset.maxFiles)||null,i=parseInt(e.dataset.maxSize)||null;e.dataset.accept;const r=e.dataset.uploadUrl,o=e.dataset.modelType||"",s=e.dataset.modelId||"",l=e.dataset.customPath||"",c=e.dataset.pathPrefix||"",u=e.closest("[data-field-name]"),d=u?.dataset.fieldName||"media",f=u?.dataset.fieldId||d.replace(/[^A-Za-z0-9_-]+/g,"-");let h=oa(e.dataset.metaKey||d);e.dataset.metaKey=h;const g=JSON.parse(e.dataset.propNames||"[]"),v=e.dataset.collection||"default",b=e.querySelector("[data-media-dropzone]"),_=e.querySelector(".media-file-input"),w=e.querySelector("[data-media-grid]"),k=e.querySelector(".media-bulk-actions"),T=e.querySelector("[data-uploaded-ids]"),y=e.querySelector("[data-deleted-ids]"),p=e.querySelector("[data-media-value]"),C=[],O=[],N=new Set,K=h||d;Zr.set(K,{uploadedIds:C,deletedIds:O,uploadedIdsInput:T,deletedIdsInput:y,fieldValueInput:p,fieldName:d,metaKey:h,collection:v,container:e}),sa({fieldValueInput:p,container:e,collection:v,uploadedIds:C}),b?.addEventListener("click",S=>{S.target.closest(".media-item")||_?.click()}),_?.addEventListener("change",S=>{Q(S.target.files)}),b?.addEventListener("dragover",S=>{S.preventDefault(),b.classList.add("dragover")}),b?.addEventListener("dragleave",()=>{b.classList.remove("dragover")}),b?.addEventListener("drop",S=>{S.preventDefault(),b.classList.remove("dragover"),Q(S.dataTransfer.files)});let W=!1,de=0;w?.addEventListener("mousedown",S=>{S.target.closest("[data-action]")||(W=!1,de=Date.now())}),w?.addEventListener("mousemove",()=>{Date.now()-de>200&&(W=!0)}),w?.addEventListener("mouseup",S=>{if(W){W=!1;return}const x=S.target.closest(".media-item");if(!x||S.target.closest("[data-action]"))return;const D=x.dataset.mediaId;D&&(x.classList.contains("selected")?(x.classList.remove("selected"),N.delete(parseInt(D))):(x.classList.add("selected"),N.add(parseInt(D))),lt())}),k?.addEventListener("click",S=>{const x=S.target.closest("[data-action]");x&&(x.dataset.action==="select-all"?Ei():x.dataset.action==="deselect-all"?Si():x.dataset.action==="delete-selected"&&Ti())}),w?.addEventListener("click",S=>{const x=S.target.closest("[data-action]");if(!x)return;const D=x.closest(".media-item"),q=D?.dataset.mediaId;x.dataset.action==="delete"?(S.stopPropagation(),Ae(D,q)):x.dataset.action==="edit"?(S.stopPropagation(),Tt(D,q)):x.dataset.action==="crop"&&(S.stopPropagation(),Ce(D,q))}),n&&w&&I.create(w,{animation:gn.SORTABLE,easing:Ea.SORTABLE,handle:".media-drag-handle",onEnd:()=>{Me(),En()}});function Q(S){const x=Array.from(S);if(n){if(a&&w.querySelectorAll(".media-item").length+x.length>a){A("warning",m("media.max_files_reached",{count:a}));return}}else{if(x.length>1){A("warning",m("media.only_one_file"));return}w.querySelectorAll(".media-item").forEach(q=>{const M=q.dataset.mediaId;M?oe(M,q):q.remove()})}for(const D of x){if(i&&D.size>i*1024){A("warning",m("media.file_too_large",{name:D.name,size:(i/1024).toFixed(1)}));continue}ee(D)}_&&(_.value="")}function ee(S){const x=new FormData;x.append("files[]",S),x.append("collection",v),o&&x.append("model_type",o),s&&x.append("model_id",s),i&&x.append("max_size",i),l&&x.append("customPath",l);const D=e.dataset.pathStrategy;D&&x.append("pathStrategy",D),c&&x.append("pathPrefix",c);const q=b?.querySelector(".upload-progress"),M=q?.querySelector(".progress-fill"),F=q?.querySelector(".progress-text"),L=b?.querySelector(".upload-prompt");L&&(L.style.display="none"),q&&(q.style.display="block",q.classList.add("active"));const B=document.querySelector('meta[name="csrf-token"]')?.content,H=new XMLHttpRequest;H.upload.addEventListener("progress",ie=>{if(ie.lengthComputable&&M&&F){const Ie=ie.loaded/ie.total*100;M.style.width=Ie+"%",F.textContent=`Uploading... ${Math.round(Ie)}%`}}),H.addEventListener("load",()=>{if(H.status===os.OK)try{const ie=JSON.parse(H.responseText);ie.success&&ie.media?(ie.media.forEach(Ie=>{J(Ie),C.push(Ie.id)}),He(),A("success",m("media.upload_success"))):A("danger",m("media.upload_failed",{error:ie.message||m("media.upload_failed_unknown")}))}catch{A("danger",m("media.upload_failed_response"))}else A("danger",m("media.upload_failed",{error:H.statusText}));q&&(q.classList.remove("active"),q.style.display="none"),L&&(L.style.display="flex"),M&&(M.style.width="0%")}),H.addEventListener("error",()=>{A("danger",m("media.upload_failed_network")),q&&(q.classList.remove("active"),q.style.display="none"),L&&(L.style.display="flex")}),H.open("POST",r,!0),B&&H.setRequestHeader("X-CSRF-TOKEN",B),H.send(x)}function J(S){const x=document.getElementById("media-item-template-"+f);if(!x){console.error("Media item template not found:","media-item-template-"+f);return}const D=x.content.cloneNode(!0).querySelector(".media-item");D.dataset.mediaId=S.id;const q=S.mime_type&&S.mime_type.startsWith("image/");if(q){const L=D.querySelector(".media-image");L.src=S.url||S.preview_url,L.alt=S.file_name,L.style.display="block";const B=D.querySelector('[data-action="crop"]');B&&(B.style.display="flex")}else{const L=D.querySelector(".media-file-icon"),B=L.querySelector(".media-file-name");B.textContent=S.file_name,L.style.display="flex"}const M=D.querySelector('input[type="hidden"]');M.value=S.id;const F=D.querySelector(".media-item-footer");if(F){const L=F.querySelector(".media-filename");L&&(L.textContent=S.file_name);const B=F.querySelector(".media-size");B&&S.size&&(B.textContent=ss(S.size),S.size>1048576&&B.classList.add("media-large-file"));const H=F.querySelector(".media-title i");H&&S.title&&(H.textContent=S.title)}if(w?.appendChild(D),q){const L=D.querySelector(".media-image");L&&L.src&&(e.dataset.previewUrl=L.src)}xe.emit("dom:updated",D),Me()}function oe(S,x){if(!S){x?.remove(),Me();return}const D=r.replace("/upload",`/${S}`),q=document.querySelector('meta[name="csrf-token"]')?.content;fetch(D,{method:"DELETE",headers:{"X-CSRF-TOKEN":q,Accept:"application/json","Content-Type":"application/json"}}).then(M=>M.json()).then(M=>{M.success?(x?.remove(),Me()):console.error("Failed to delete file:",M.message)}).catch(M=>{console.error("Delete error:",M)})}async function Ae(S,x){const D=S?.querySelector(".media-filename")?.textContent||"this file";if(!await Xt(m("media.confirm_remove"),{title:m("common.delete"),variant:"error",bodyParams:[D],confirmText:m("common.delete"),cancelText:m("common.cancel")}))return;if(!x){S?.remove(),Me(),He(),A("success",m("media.remove_success"));return}const M=r.replace("/upload",`/${x}`),F=document.querySelector('meta[name="csrf-token"]')?.content;fetch(M,{method:"DELETE",headers:{"X-CSRF-TOKEN":F,Accept:"application/json","Content-Type":"application/json"}}).then(L=>L.json()).then(L=>{if(L.success){S?.remove(),Me();const B=parseInt(x,10),H=C.indexOf(B);H!==-1&&C.splice(H,1),O.includes(B)||O.push(B),He(),A("success",m("media.delete_success"))}else A("danger",m("media.delete_failed",{error:L.message||m("media.delete_failed_unknown")}))}).catch(L=>{console.error("Delete error:",L),A("danger",m("media.delete_failed_network"))})}function Ce(S,x){const D=S?.querySelector(".media-filename")?.textContent||"Media",q=S?.querySelector("img");if(!q){A("danger",m("media.crop_load_failed"));return}const M=q.src,F=`
                <div class="cropper-modal-content">
                    <div class="cropper-image-container">
                        <img id="cropper-image-${x}" src="${M}" alt="Crop image" class="cropper-image">
                    </div>
                    <div class="cropper-options">
                        <div class="row">
                            <div class="col-6">
                                <div class="form-field">
                                    <label>Aspect Ratio:</label>
                                    <select id="cropper-ratio-${x}" class="form-control">
                                        <option value="">Free</option>
                                        <option value="16/9">16:9 (landscape)</option>
                                        <option value="9/16">9:16 (portrait)</option>
                                        <option value="4/3">4:3 (landscape)</option>
                                        <option value="3/4">3:4 (portrait)</option>
                                        <option value="1/1">1:1 (square)</option>
                                        <option value="3/2">3:2 (landscape)</option>
                                        <option value="2/3">2:3 (portrait)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-field">
                                    <label>Max Size (px):</label>
                                    <input type="number" id="cropper-max-size-${x}" class="form-control" placeholder="No limit" min="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `,L=fe({title:`Crop: ${D}`,body:F,type:"form",confirmText:m("media.crop_button"),cancelText:m("common.cancel"),size:"large",autoClose:!1,onConfirm:B=>{Ze(B,x,S)}});setTimeout(()=>{const B=document.getElementById(`cropper-image-${x}`),H=document.getElementById(`cropper-ratio-${x}`);if(!B){console.error("Cropper image element not found");return}const ie=new Gr(B,{aspectRatio:NaN,viewMode:1,autoCropArea:1,responsive:!0,guides:!0,grid:!0,highlight:!0,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0});L.cropper=ie,H?.addEventListener("change",Ie=>{const Sn=Ie.target.value;if(Sn==="")ie.setAspectRatio(NaN);else{const[Tn,xn]=Sn.split("/").map(Number);ie.setAspectRatio(Tn/xn)}})},100)}function Ze(S,x,D){const q=S.cropper;if(!q){A("danger",m("media.cropper_not_initialized"));return}q.getCanvasData();const M=q.getData(!0);if(M.width<=0||M.height<=0){A("danger",m("media.invalid_crop_area"));return}const F=Math.round(M.x),L=Math.round(M.y),B=Math.round(M.width),H=Math.round(M.height),ie=document.getElementById(`cropper-max-size-${x}`),Ie=ie?.value?parseInt(ie.value,10):null,Tn=document.getElementById(`cropper-ratio-${x}`)?.value||"",xn=document.querySelector('meta[name="csrf-token"]')?.content,xi=r.replace("/upload",""),xa={x:F,y:L,width:B,height:H,aspectRatio:Tn};Ie&&(xa.maxSize=Ie),fetch(`${xi}/${x}/crop`,{method:"POST",headers:{"X-CSRF-TOKEN":xn,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(xa)}).then(Ee=>Ee.ok?Ee.json():Ee.json().then(jt=>{throw new Error(jt.message||`HTTP ${Ee.status}`)})).then(Ee=>{if(Ee.success){const jt=D.querySelector("img");if(jt){const zt=new Date().getTime();jt.src=Ee.media.url+"?t="+zt}if(Ee.media.size){const zt=D.querySelector(".media-size");if(zt){const Aa=["B","KB","MB","GB"];let An=Ee.media.size,Cn=0;for(;An>=1024&&Cn<Aa.length-1;)An/=1024,Cn++;const Ai=An.toFixed(1)+Aa[Cn];zt.textContent=Ai}}A("success",m("media.crop_success")),Be(S)}else throw new Error(Ee.message||"Crop failed")}).catch(Ee=>{A("danger",m("media.crop_failed",{error:Ee.message}))})}function Tt(S,x){const D=S?.querySelector(".media-filename")?.textContent||"Media",q=S.querySelector(`input[data-media-props="true"][data-props-id="${x}"]`),M=q?JSON.parse(q.value||"{}"):{},F=g.map(L=>{const B=L.charAt(0).toUpperCase()+L.slice(1).replace(/_/g," "),H=`media-prop-${L}`;return`
                    <div class="form-field">
                        <label for="${H}">${B}</label>
                        <input type="text" id="${H}" name="${L}" class="form-control" value="${M[L]||""}" placeholder="Enter ${B.toLowerCase()}">
                    </div>
                `}).join("");fe({title:`Edit: ${D}`,body:F,type:"form",confirmText:m("common.save"),cancelText:m("common.cancel"),size:"default",autoClose:!1,onConfirm:L=>{Qe(L,x,S)}})}function Qe(S,x,D){const q=document.querySelector('meta[name="csrf-token"]')?.content,M={};S.querySelectorAll("input[name], textarea[name]").forEach(L=>{const B=L.getAttribute("name");B&&(M[B]=L.value||"")});const F=r.replace("/upload","");fetch(`${F}/${x}/props`,{method:"POST",headers:{"X-CSRF-TOKEN":q,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(M)}).then(L=>L.ok?L.json():L.json().then(B=>{throw new Error(B.message||`HTTP ${L.status}`)})).then(L=>{if(L.success){if(L.media?.props?.title){const ie=D.querySelector(".media-title i");ie&&(ie.textContent=L.media.props.title)}const B=e.dataset.metaKey||h||oa(d);let H=D.querySelector(`input[data-media-props="true"][data-props-id="${x}"]`);H?(H.name=`__media_props[${B}][${x}]`,H.setAttribute("data-media-props","true"),H.setAttribute("data-props-id",x)):(H=document.createElement("input"),H.type="hidden",H.name=`__media_props[${B}][${x}]`,H.setAttribute("data-media-props","true"),H.setAttribute("data-props-id",x),D.appendChild(H)),H.value=JSON.stringify(L.media.props),A("success",L.message||m("media.properties_saved")),Be(S)}else throw new Error(L.message||"Save failed")}).catch(L=>{A("danger",m("media.save_failed",{error:L.message}))})}function He(){T&&(T.value=C.join(",")),y&&(y.value=O.join(",")),sa({fieldValueInput:p,container:e,collection:v,uploadedIds:C})}function Me(){w?.querySelectorAll(".media-item")?.forEach((x,D)=>{const q=x.querySelector(".media-order");q&&(q.textContent=D+1)})}function En(){const S=w.querySelectorAll(".media-item"),x=[];if(S.forEach((M,F)=>{const L=M.dataset.mediaId;L&&x.push({id:parseInt(L),order:F})}),x.length===0)return;const D=document.querySelector('meta[name="csrf-token"]')?.content,q=r.replace("/upload","/reorder");fetch(q,{method:"POST",headers:{"X-CSRF-TOKEN":D,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({media:x,collection:v})}).then(M=>M.json()).then(M=>{M.success?A("success",m("media.reorder_success")):(console.error("Order update failed:",M.message),A("danger",m("media.reorder_failed")))}).catch(M=>{console.error("Order update error:",M),A("danger",m("media.reorder_failed"))})}function lt(){const S=N.size;S>0?(k.style.display="block",k.querySelector(".selected-count").textContent=S):(k.style.display="none",N.clear())}function Ei(){w.querySelectorAll(".media-item").forEach(x=>{const D=x.dataset.mediaId;D&&(N.add(parseInt(D)),x.classList.add("selected"))}),lt()}function Si(){w.querySelectorAll(".media-item").forEach(x=>{x.classList.remove("selected")}),N.clear(),lt()}async function Ti(){const S=Array.from(N);if(S.length===0){A("warning",m("media.no_files_selected"));return}if(!await Xt(`You are going to remove ${S.length} file(s):`,{title:m("common.delete"),variant:"error",confirmText:m("common.delete"),cancelText:m("common.cancel")}))return;const D=document.querySelector('meta[name="csrf-token"]')?.content,q=r.replace("/upload","");fetch(`${q}/bulk-delete`,{method:"POST",headers:{"X-CSRF-TOKEN":D,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({ids:S})}).then(M=>M.ok?M.json():M.json().then(F=>{throw new Error(F.message||`HTTP ${M.status}`)})).then(M=>{if(M.success)S.forEach(F=>{const L=w.querySelector(`[data-media-id="${F}"]`);L&&L.remove();const B=parseInt(F,10),H=C.indexOf(B);H!==-1&&C.splice(H,1),O.includes(B)||O.push(B)}),N.clear(),lt(),Me(),He(),A("success",m("media.bulk_delete_success",{count:M.deleted}));else throw new Error(M.message||"Delete failed")}).catch(M=>{A("danger",m("media.bulk_delete_failed",{error:M.message}))})}xe.on("dom:updated",S=>{if(S.classList?.contains("media-field-container"))ar(S),vn(S);else{const x=S.querySelectorAll?.(".media-field-container")||[];x.forEach(D=>{ar(D)}),x.length>0&&vn(S)}})})}const cs="modulepreload",ds=function(t,e){return new URL(t,e).href},rr={},us=function(e,n,a){let i=Promise.resolve();if(n&&n.length>0){let c=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),l=s?.nonce||s?.getAttribute("nonce");i=c(n.map(u=>{if(u=ds(u,a),u in rr)return;rr[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(a)for(let g=o.length-1;g>=0;g--){const v=o[g];if(v.href===u&&(!d||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":cs,d||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((g,v)=>{h.addEventListener("load",g),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&r(s.reason);return e().catch(r)})};function Qr(t=document){t.querySelectorAll("[data-ave-chips]").forEach(e=>{const n=e.querySelector("input");e.addEventListener("click",()=>{n?.focus()}),e.addEventListener("keydown",a=>{if(!n||a.key!=="Enter")return;const i=n.value.trim();if(!i)return;a.preventDefault();const r=document.createElement("span");r.className="chip",r.innerHTML=`${i} <span class="chip-remove" data-ave-chip-remove>&times;</span>`,e.insertBefore(r,n),n.value=""}),e.addEventListener("click",a=>{const i=a.target.closest("[data-ave-chip-remove]");if(!i)return;a.preventDefault(),i.closest(".chip")?.remove()})})}let la=[],ir=!1;const yn=t=>{la.forEach(e=>{e!==t&&e.classList.remove("is-open")})},fs=(t,e,n,a,i)=>{const r=()=>{const o=i.filter(c=>c.querySelector("input")?.checked);if(!o.length){n.textContent=a,n.classList.add("select-dropdown__placeholder");return}const s=o.map(c=>c.getAttribute("data-label")||c.textContent.trim()),l=s.length>3?`${s.length} options selected`:s.join(", ");n.textContent=l,n.classList.remove("select-dropdown__placeholder")};i.forEach(o=>{const s=o.querySelector('input[type="checkbox"]');s&&(o.classList.toggle("is-selected",s.checked),s.addEventListener("change",()=>{o.classList.toggle("is-selected",s.checked),r()}),o.addEventListener("click",l=>{l.target!==s&&(s.checked=!s.checked,s.dispatchEvent(new Event("change",{bubbles:!0})))}))}),r(),e.addEventListener("click",o=>{o.preventDefault();const s=!t.classList.contains("is-open");yn(t),t.classList.toggle("is-open",s)})},hs=(t,e,n,a,i)=>{const r=()=>{const o=i.find(s=>s.querySelector("input")?.checked);o?(n.textContent=o.getAttribute("data-label")||o.textContent.trim(),n.classList.remove("select-dropdown__placeholder")):(n.textContent=a,n.classList.add("select-dropdown__placeholder")),i.forEach(s=>{const l=s.querySelector("input");s.classList.toggle("is-selected",!!l?.checked)})};i.forEach(o=>{const s=o.querySelector('input[type="radio"]');if(!s)return;o.classList.toggle("is-selected",s.checked);const l=()=>{s.checked&&(r(),t.classList.remove("is-open"))};s.addEventListener("change",l),o.addEventListener("click",c=>{c.target!==s&&(s.checked=!0,s.dispatchEvent(new Event("change",{bubbles:!0})))})}),r(),e.addEventListener("click",o=>{o.preventDefault();const s=!t.classList.contains("is-open");yn(t),t.classList.toggle("is-open",s)})},ps=(t,e)=>{const n=t.querySelector("[data-ave-select-dropdown-search]");n&&n.addEventListener("input",()=>{const a=n.value.trim().toLowerCase();e.forEach(i=>{const o=(i.getAttribute("data-label")||i.textContent||"").toLowerCase().includes(a);i.classList.toggle("is-hidden",!!a&&!o)})})};function ei(t=document){const e=Array.from(t.querySelectorAll("[data-ave-select-dropdown]"));e.length&&(e.forEach(n=>{la.includes(n)||la.push(n)}),e.forEach(n=>{const a=n.querySelector("[data-ave-select-toggle]"),i=n.querySelector("[data-ave-select-label]"),r=n.querySelector("[data-ave-select-menu]");if(!a||!i||!r)return;const o=a.getAttribute("data-placeholder")||i.textContent.trim();i.classList.add("select-dropdown__placeholder");const s=Array.from(r.querySelectorAll("[data-ave-select-option]")),l=n.getAttribute("data-ave-select-dropdown")||"single";l==="multi"?fs(n,a,i,o,s):hs(n,a,i,o,s),l==="search"&&ps(n,s)}),ir||(document.addEventListener("click",n=>{n.target.closest("[data-ave-select-dropdown]")||yn()}),document.addEventListener("keydown",n=>{n.key==="Escape"&&yn()}),ir=!0))}function ms(t){const n=t.closest(".slug-input-wrapper")?.querySelector(".slug-loader");n&&(n.style.display="block"),t.classList.add("is-loading")}function gs(t){const n=t.closest(".slug-input-wrapper")?.querySelector(".slug-loader");n&&(n.style.display="none"),t.classList.remove("is-loading")}async function vs(t,e,n,a){try{const i=document.querySelector('meta[name="csrf-token"]')?.content||"",r=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":i,Accept:"application/json"},body:JSON.stringify({text:t,separator:e,locale:n})});return r.ok?(await r.json()).slug||null:(console.error(`Slug API returned status ${r.status}`),null)}catch(i){return console.error("Failed to generate slug:",i),null}}function ys(t){const e=t.dataset.slugSource;if(!e){console.warn("Slug field missing data-slug-source:",t);return}const n=document.querySelector(`[name="${e}"]`);if(!n){console.warn(`Source field not found: ${e}`);return}const a=t.dataset.slugSeparator||"-",i=t.dataset.slugLocale||null,r=t.dataset.slugApiUrl;if(!r){console.error("Slug field missing data-slug-api-url");return}let o=null;t.addEventListener("focus",async function(){if(!this.value.trim()){const l=n.value.trim();if(l){o&&(o.abort(),o=null),ms(this);const c=new AbortController;o=c;try{const u=await vs(l,a,i,r);u!==null&&o===c&&(this.value=u)}finally{gs(this),o===c&&(o=null)}}}})}function ti(t=document){t.querySelectorAll("[data-slug-field]").forEach(ys)}function ni(t=document){t.querySelectorAll("[data-password-toggle]").forEach(n=>{n.addEventListener("click",function(a){a.preventDefault(),a.stopImmediatePropagation();const i=this.closest(".password-input-wrapper"),r=i?.querySelector("[data-password-input]"),o=this.querySelector(".icon-eye"),s=this.querySelector(".icon-eye-off");!i||!r||(r.type==="password"?(r.type="text",i.classList.add("password-shown"),o&&o.classList.add("hidden"),s&&s.classList.remove("hidden")):(r.type="password",i.classList.remove("password-shown"),o&&o.classList.remove("hidden"),s&&s.classList.add("hidden")))},!0)})}function ai(t=document){t.querySelectorAll("[data-ave-option-cards]").forEach(e=>{const n=e.querySelectorAll(".option-card"),a=()=>{n.forEach(i=>{const r=i.querySelector("input");i.classList.toggle("selected",!!r?.checked)})};n.forEach(i=>{const r=i.querySelector("input");r&&(r.addEventListener("change",()=>{if(r.type==="radio"){n.forEach(o=>{const s=o.querySelector("input");o.classList.toggle("selected",s===r)});return}i.classList.toggle("selected",r.checked)}),i.addEventListener("click",o=>{o.target!==r&&(r.type==="radio"?(r.checked=!0,r.dispatchEvent(new Event("change",{bubbles:!0}))):(r.checked=!r.checked,r.dispatchEvent(new Event("change",{bubbles:!0}))))}))}),a()})}function Xe(t,e=null,n=null){if(t){if(!e||!n){const a=t.querySelector(".fieldset-item-header, [data-head-title-field], [data-head-preview-field]");if(!a)return;e=e||a.dataset.headTitleField,n=n||a.dataset.headPreviewField}e&&bs(t,e),n&&ws(t,n)}}function bs(t,e){if(!t||!e)return;const n=t.querySelector("[data-item-title]");if(!n)return;let a=t.querySelector(`[name$="[${e}]"]`);a||(a=t.querySelector(`[name*="[${e}]"]`)),a&&a.value?(n.textContent=a.value,n.style.display="block"):n.style.display="none",ri(t)}function ri(t){const e=t.querySelector("[data-item-placeholder]");if(!e)return;const n=t.querySelector("[data-item-title]"),a=t.querySelector("[data-item-preview]"),i=n&&n.style.display!=="none"&&n.textContent.trim(),r=a&&a.style.display!=="none"&&a.style.backgroundImage;!i&&!r?e.style.display="flex":e.style.display="none"}function ws(t,e){if(!t||!e)return;const n=t.querySelector("[data-item-preview]");if(!n)return;const a=t.querySelector(`[data-field-name*="${e}"]`);if(!a){n.style.backgroundImage="",n.style.display="none";return}let i=null;if(i=a.dataset.previewUrl,!i){const r=a.querySelector(".media-preview img");r&&r.src&&(i=r.src)}i&&i.length>0?(n.style.backgroundImage=`url('${i}')`,n.style.display="block"):(n.style.backgroundImage="",n.style.display="none"),ri(t)}const ii=new WeakMap,ca=new Map;function Es(t,e,n){if(!t){console.error("Cannot register sortable: container is null");return}ii.set(t,n),ca.set(e,t)}function nn(t){const e=ca.get(t);return e?document.contains(e)?ii.get(e)||null:(ca.delete(t),null):null}let it=0;const oi="fieldset-editing";function Ss(t="default"){return it++,it===1&&document.body.classList.add(oi),it}function Xn(t="default"){return it>0&&it--,it===0&&document.body.classList.remove(oi),it}function si(t=document){t.querySelectorAll("[data-fieldset].fieldset-cards-view").forEach(e=>{if(e.dataset.cardsInitialized==="true")return;const n=e.querySelector("[data-fieldset-items]"),a=e.dataset.fieldName;e.dataset.cardsInitialized="true",e.addEventListener("input",i,!0),e.addEventListener("change",i,!0),e.addEventListener("mediaChanged",r,!0),e.addEventListener("click",o=>{const s=o.target.closest('[data-action="close-sidebar"]');if(s){const u=s.closest("[data-item-index]");if(u){o.stopPropagation(),u.classList.remove("is-editing"),Xn(),Xe(u);const d=nn(a);d&&d.option("disabled",!1),n.classList.remove("sortable-disabled")}return}if(o.target.closest('[data-action="delete"]'))return;const c=o.target.closest(".fieldset-card-header");if(c){const u=c.closest("[data-item-index]");if(u){u.classList.add("is-editing"),Ss();const d=nn(a);d&&d.option("disabled",!0),n.classList.add("sortable-disabled")}return}}),document.addEventListener("keydown",o=>{if(o.key==="Escape"){const s=e.querySelector(".fieldset-item.is-editing");if(s){Xe(s),s.classList.remove("is-editing"),Xn();const l=nn(a);l&&l.option("disabled",!1),n.classList.remove("sortable-disabled")}}}),document.addEventListener("click",o=>{if(o.target===document.body||o.target.tagName==="HTML"){const s=e.querySelector(".fieldset-item.is-editing");if(s){Xe(s),s.classList.remove("is-editing"),Xn();const l=nn(a);l&&l.option("disabled",!1),n.classList.remove("sortable-disabled")}}});function i(o){const s=o.target.closest("[data-item-index]");s&&Xe(s)}function r(o){const s=o.target.closest("[data-item-index]");s&&Xe(s)}})}let $n=null;async function Ts(){return $n||($n=us(()=>import("./editors.js"),[],import.meta.url)),$n}function li(t){wr(t),Qr(t),ai(t),ei(t),ni(t),ti(t),vn(t),si(t)}async function ci(t){let e=null;try{e=await Ts()}catch(i){console.error("Failed to load editors bundle",i);return}const{initCodeEditor:n,initRichEditor:a}=e;typeof n=="function"&&n(t),typeof a=="function"&&a(t)}function xs(){xe.on("dom:updated",t=>{li(t),ci(t)})}function As(t=document){t.querySelectorAll("[data-fieldset]").forEach(e=>{const n=e.dataset.fieldName,a=e.querySelector("[data-fieldset-items]"),i=document.getElementById(`fieldset-template-${n}`),r=e.querySelector('[data-action="add"]'),o=e.dataset.sortable==="true",s=e.dataset.collapsible==="true",l=parseInt(e.dataset.minItems)||0,c=parseInt(e.dataset.maxItems)||null;if(!i){console.error(`FieldSet template not found: fieldset-template-${n}`);return}let u=null;const d=()=>Array.from(a.querySelectorAll("[data-field-id]")).map(T=>parseInt(T.value,10)).filter(Number.isInteger),f=()=>{const T=new Set(d());let y=0;for(;T.has(y);)y++;return y},h=(T,y)=>T.replace(/__INDEX__/g,y).replace(/__index__/g,y).replace(/__ITEM__/g,y).replace(/__item__/g,y).replace(/__TEMPLATE__/g,y).replace(/__template__/g,y),g=(T,y,p)=>{[T,...T.querySelectorAll("*")].forEach(O=>{Array.from(O.attributes||[]).forEach(N=>{const K=h(N.value,p);K!==N.value&&O.setAttribute(N.name,K)}),Object.entries(O.dataset||{}).forEach(([N,K])=>{const W=h(K,p);W!==K&&(O.dataset[N]=W)})}),T.dataset.itemIndex=y,T.dataset.itemId=p};if(o){const T=e.classList.contains("fieldset-cards-view"),y={animation:gn.SORTABLE,easing:Ea.SORTABLE,ghostClass:"sortable-ghost",dragClass:"sortable-drag",disabled:!T,onEnd:()=>{w()}};T||(y.handle=".fieldset-drag-handle"),u=I.create(a,y),Es(e,n,u)}r&&r.addEventListener("click",()=>{const T=a.querySelectorAll(".fieldset-item").length;if(c&&T>=c){alert(m("fieldset.max_items_reached",{count:c}));return}const y=i.content.cloneNode(!0);a.appendChild(y);const p=a.lastElementChild;if(!p){console.error("Failed to add fieldset item");return}const C=f();g(p,T,C);const O=p.querySelector("[data-field-id]");O&&(O.value=C),p.querySelectorAll(".media-field-container").forEach(N=>{N.dataset.initialized="false"}),li(p),ci(p),xe.emit("dom:updated",p),w(),Xe(p)}),a.addEventListener("click",async T=>{const y=T.target.closest('[data-action="delete"]');if(!y)return;const p=y.closest(".fieldset-item");if(!p)return;const C=a.querySelectorAll(".fieldset-item").length;if(l>0&&C<=l){as(m("fieldset.min_items_required",{count:l}),{title:m("fieldset.deletion_blocked"),variant:"warning",confirmText:m("fieldset.ok_button")});return}await Xt(m("fieldset.confirm_delete"),{title:m("fieldset.delete_item"),variant:"error",confirmText:m("fieldset.delete_button"),cancelText:m("fieldset.cancel_button")})&&(p.remove(),w())}),s&&a.addEventListener("click",T=>{const y=T.target.closest('[data-action="collapse"]');if(!y)return;const p=y.closest(".fieldset-item");if(!p)return;const C=p.querySelector(".fieldset-item-fields");if(!C)return;p.classList.contains("collapsed")?(p.classList.remove("collapsed"),C.style.maxHeight=C.scrollHeight+"px",setTimeout(()=>{C.style.maxHeight=""},gn.COLLAPSE)):(C.style.maxHeight=C.scrollHeight+"px",C.offsetHeight,C.style.maxHeight="0",p.classList.add("collapsed"))});const v=e.querySelector('[data-action="collapse-all"]');v&&v.addEventListener("click",()=>{a.querySelectorAll(".fieldset-item").forEach(y=>{if(!y.classList.contains("collapsed")){const p=y.querySelector(".fieldset-item-fields");p&&(p.style.maxHeight=p.scrollHeight+"px",p.offsetHeight,p.style.maxHeight="0",y.classList.add("collapsed"))}})});const b=e.querySelector('[data-action="expand-all"]');b&&b.addEventListener("click",()=>{a.querySelectorAll(".fieldset-item").forEach(y=>{if(y.classList.contains("collapsed")){const p=y.querySelector(".fieldset-item-fields");p&&(y.classList.remove("collapsed"),p.style.maxHeight=p.scrollHeight+"px",setTimeout(()=>{p.style.maxHeight=""},300))}})});const _=e.querySelector('[data-action="toggle-sort"]');if(_&&u){const T=y=>{[v,b].forEach(p=>{p&&(p.disabled=!y,p.classList.toggle("is-disabled",!y))})};T(!_.checked),_.addEventListener("change",y=>{y.target.checked?(e.classList.add("sort-mode"),u.option("disabled",!1),T(!1),a.querySelectorAll(".fieldset-item").forEach(O=>{const N=O.querySelector(".fieldset-item-fields");N&&(N.style.maxHeight="0",O.classList.add("collapsed"))})):(e.classList.remove("sort-mode"),u.option("disabled",!0),T(!0),a.querySelectorAll(".fieldset-item").forEach(O=>{const N=O.querySelector(".fieldset-item-fields");N&&(O.classList.remove("collapsed"),N.style.maxHeight="")}))})}function w(){a.querySelectorAll(".fieldset-item").forEach((y,p)=>{y.dataset.itemIndex=p;const C=y.querySelector(".fieldset-item-number");C&&(C.textContent=p+1);const O=y.querySelector(".fieldset-item-order");O&&(O.textContent=p+1)})}w(),k(),a.addEventListener("input",T=>{const y=T.target.closest(".fieldset-item");y&&Xe(y)}),a.addEventListener("mediaChanged",T=>{const y=T.target.closest(".fieldset-item");y&&Xe(y)});function k(){a.querySelectorAll(".fieldset-item").forEach(y=>Xe(y))}})}function Cs(t=document){t.querySelectorAll('.toggle[data-toggle="toggle"]').forEach(n=>{if(n.dataset.initialized==="true")return;n.dataset.initialized="true";const a=n.querySelector('input[type="checkbox"]'),i=n.querySelector(".toggle-on"),r=n.querySelector(".toggle-off");if(!a||!i||!r)return;const o=()=>{n.classList.toggle("off",!a.checked),i.classList.toggle("active",a.checked),r.classList.toggle("active",!a.checked)};o(),di(n),a.addEventListener("change",o),n.addEventListener("click",()=>{a.checked=!a.checked,a.dispatchEvent(new Event("change"))})}),_s()}function di(t){const e=t.querySelector(".toggle-on"),n=t.querySelector(".toggle-off");if(!e||!n)return;const a=e.offsetWidth,i=n.offsetWidth,r=Math.max(a,i);r>0&&(t.style.minWidth=r+5+"px",e.style.width=r+"px",e.style.minWidth=r+"px",n.style.width=r+"px",n.style.minWidth=r+"px")}let or=!1;function _s(){or||(or=!0,xe.on("tab:activated",({pane:t})=>{requestAnimationFrame(()=>{t.querySelectorAll('.toggle[data-toggle="toggle"]').forEach(n=>{di(n)})})}))}function Ls(t=document){t.querySelectorAll("[data-tags-field]").forEach(n=>{n.dataset.tagsField;const a=n.querySelector(".tags-input"),i=n.parentElement.querySelector(".tags-hidden-input"),r=a?.dataset.tagsSeparator||",";a&&(a.addEventListener("keydown",o=>{if(o.key==="Enter"||o.key===r){o.preventDefault();const s=a.value.trim();s&&(Yn(n,s,i,r),a.value="")}if(o.key==="Tab"){const s=a.value.trim();s&&(o.preventDefault(),Yn(n,s,i,r),a.value="")}}),a.addEventListener("blur",()=>{const o=a.value.trim();o&&(Yn(n,o,i,r),a.value="")}),n.addEventListener("click",o=>{o.target.classList.contains("chip-remove")&&(o.target.closest(".chip").remove(),ui(n,i,r))}))})}function Yn(t,e,n,a){const i=t.querySelectorAll(".chip-text"),r=e.toLowerCase();for(const l of i)if(l.textContent.toLowerCase()===r)return;const o=document.createElement("div");o.className="chip",o.tabIndex=0,o.innerHTML=`
        <span class="chip-text">${Ds(e)}</span>
        <span class="chip-remove" data-tag-remove>&times;</span>
    `;const s=t.querySelector(".tags-input");s.parentElement.insertBefore(o,s),ui(t,n,a)}function ui(t,e,n){const a=t.querySelectorAll(".chip-text"),i=Array.from(a).map(r=>r.textContent.trim());e.value=i.join(n.trim()+" ")}function Ds(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,n=>e[n])}function Ms(t=document){t.querySelectorAll("[data-file-field]").forEach(n=>{const a=n.dataset.fileField,i=n.dataset.customPath||"",r=n.dataset.pathPrefix||"",o=n.querySelector("[data-file-input]"),s=n.querySelector("[data-file-delete]"),l=n.querySelector(".file-path-input"),c=n.querySelector("[data-file-progress]"),u=n.querySelector("[data-file-input-area]"),d=n.querySelector(".file-preview");if(!o||!l){console.error("[Ave] File upload: missing required elements for field",a);return}o.addEventListener("change",f=>{const h=f.target.files[0];if(!h)return;c.style.display="block";const g=c.querySelector(".progress-fill");g.style.width="0%";const v=new FormData;v.append("file",h),v.append("field",a);const b=n.closest("form"),_=b?.dataset.modelType||"",w=b?.dataset.modelId||"";_&&v.append("model_type",_),w&&v.append("model_id",w),i&&v.append("customPath",i),r&&v.append("pathPrefix",r);const k=document.querySelector('meta[name="csrf-token"]')?.content,T=new XMLHttpRequest;T.upload.addEventListener("progress",y=>{if(y.lengthComputable){const p=y.loaded/y.total*100;g.style.width=p+"%"}}),T.addEventListener("load",()=>{if(c.style.display="none",T.status===200)try{const y=JSON.parse(T.responseText);y.success&&y.path?(l.value=y.path,Is(n,h.name,y.path),u.classList.add("hidden"),o.value=""):alert(m("upload.upload_failed_with_error",{error:y.message||m("media.upload_failed_unknown")}))}catch(y){console.error("[Ave] Error parsing upload response:",y),alert(m("upload.upload_processing_error"))}else console.error("[Ave] Upload failed with status:",T.status),alert(m("upload.upload_failed_with_status",{status:T.status}))}),T.addEventListener("error",()=>{c.style.display="none",console.error("[Ave] Upload error occurred"),alert(m("upload.upload_error"))}),T.open("POST","/admin/api/file-upload"),T.setRequestHeader("X-Requested-With","XMLHttpRequest"),k&&T.setRequestHeader("X-CSRF-TOKEN",k),T.send(v)}),s&&s.addEventListener("click",f=>{f.preventDefault(),f.stopPropagation(),l.value="",d&&d.remove(),u.classList.remove("hidden"),o.value=""})})}function Is(t,e,n){const a=t.querySelector(".file-preview");a&&a.remove();const i=document.createElement("div");i.className="file-preview",i.innerHTML=`
        <div class="file-item">
            <div class="file-info">
                <span class="file-name">${sr(e)}</span>
                <span class="file-size" data-file-path="${sr(n)}"></span>
            </div>
            <button type="button" class="file-delete-btn" data-file-delete style="cursor: pointer;">
                <i class="voyager-trash"></i> Remove
            </button>
        </div>
    `;const r=t.querySelector("[data-file-input-area]");r.parentElement.insertBefore(i,r);const o=i.querySelector("[data-file-delete]");o&&o.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();const l=t.querySelector(".file-path-input");l.value="",i.remove(),t.querySelector("[data-file-input-area]").classList.remove("hidden");const u=t.querySelector("[data-file-input]");u.value=""})}function sr(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,n=>e[n])}function Os(t=document){wr(t),Qr(t),ai(t),ei(t),ni(t),Cs(t),ti(t),Ls(t),Ms(t),vn(t),As(t),si(t),t.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",()=>{ls()})})}function ks(){document.querySelectorAll('[data-ave-tabs="nav"]').forEach(e=>{const n=e.closest("[data-ave-tabs-root]"),a=n?Array.from(n.querySelectorAll("[data-ave-tab-pane]")):[],i=Array.from(e.querySelectorAll("[data-ave-tab-target]"));i.length===0||a.length===0||(Ns(i,a,n),i.forEach(r=>{r.addEventListener("click",o=>{o.preventDefault();const s=r.getAttribute("data-ave-tab-target");if(!s)return;const l=a.find(c=>c.matches(s));l&&fi(i,a,r,l,n)})}))})}function fi(t,e,n,a,i){t.forEach(r=>{r.classList.toggle("active",r===n);const o=r.querySelector("a");o&&o.setAttribute("aria-selected",String(r===n))}),e.forEach(r=>{r.classList.toggle("active",r===a)}),xe.emit("tab:activated",{pane:a,tabsRoot:i})}function Ns(t,e,n){const a=document.querySelector(".form-field.has-error");if(!a)return;const i=e.find(s=>s.contains(a));if(!i)return;const r=i.getAttribute("id"),o=t.find(s=>s.getAttribute("data-ave-tab-target")===`#${r}`);o&&fi(t,e,o,i,n)}function Ps(){document.querySelectorAll(".alert-dismissible .close").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const n=t.closest(".alert");n&&n.remove()})})}function qs(){document.querySelectorAll("[data-ave-accordion-toggle]").forEach(t=>{const e=t.getAttribute("data-ave-accordion-toggle");if(!e)return;const n=e.startsWith("#")?e:`#${e}`,a=document.querySelector(n);a&&t.addEventListener("click",i=>{i.preventDefault();const o=!(t.getAttribute("aria-expanded")==="true");t.setAttribute("aria-expanded",String(o)),a.classList.toggle("show",o)})})}const Rs=t=>{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select();let n=!1;try{n=document.execCommand("copy")}catch{n=!1}return document.body.removeChild(e),n};function Bs(){document.querySelectorAll("[data-ave-copy]").forEach(t=>{t.addEventListener("click",async e=>{e.preventDefault();const n=t.getAttribute("data-ave-copy");if(!n)return;const a=document.querySelector(n);if(!a)return;const i=a.value??a.textContent??"";try{await navigator.clipboard.writeText(i),A("success",m("common.copied_to_clipboard"))}catch{Rs(i)?A("success",m("common.copied_to_clipboard")):A("danger",m("common.copy_failed"))}})})}function Hs(){is(),ks(),Ps(),rs(),qs(),Bs()}function Xs(){if(!document.body.classList.contains("ave-login"))return;const t=document.forms[0],e=t?.querySelector('button[type="submit"]'),n=t?.querySelector('[name="email"]'),a=t?.querySelector('[name="password"]');if(!t||!e||!n||!a)return;e.addEventListener("click",r=>{if(t.checkValidity()){const o=e.querySelector(".signingin"),s=e.querySelector(".signin");o&&s&&(o.classList.remove("hidden"),s.classList.add("hidden"))}else r.preventDefault()}),n.focus();const i=document.getElementById("emailGroup");i&&i.classList.add("focused")}function $s(t){const{title:e,fetchUrl:n,saveUrl:a,fetchParams:i={},onSuccess:r=null,onError:o=null,confirmText:s=m("common.save"),cancelText:l=m("common.cancel"),size:c="default"}=t,u=fe({title:m("common.loading"),body:`<div class="spinner">${m("common.loading_form")}</div>`,type:"alert",size:"small"});Ys(n,i).then(({formHtml:d,currentData:f})=>{ke(u);const h=fe({title:e,body:d,type:"form",size:c,confirmText:s,cancelText:l,onConfirm:g=>{Ws(g,a,r,o)}});xe.emit("dom:updated",h)}).catch(d=>{ke(u),A("danger",m("common.failed_to_load_form",{error:d.message})),o&&o(d)})}function Ys(t,e={}){const n=document.querySelector('meta[name="csrf-token"]')?.content,a=new URLSearchParams(e).toString(),i=a?`${t}?${a}`:t;return fetch(i,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":n}}).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()}).then(r=>{if(!r.success)throw new Error(r.message||"Failed to load form");return{formHtml:r.formHtml||"",currentData:r.currentData||{}}})}function Ws(t,e,n=null,a=null){const i=document.querySelector('meta[name="csrf-token"]')?.content,r=new FormData;t.querySelectorAll("input, textarea, select").forEach(o=>{o.name&&(o.type==="checkbox"?r.append(o.name,o.checked?"1":"0"):o.type==="radio"?o.checked&&r.append(o.name,o.value):r.append(o.name,o.value))}),fetch(e,{method:"POST",headers:{"X-CSRF-TOKEN":i,Accept:"application/json"},body:r}).then(o=>o.ok?o.json():o.json().then(s=>{throw new Error(s.message||`HTTP ${o.status}`)})).then(o=>{if(o.success)A("success",o.message||m("common.saved_successfully")),n&&n(o),ke(t);else throw new Error(o.message||"Save failed")}).catch(o=>{A("danger",m("common.failed_to_save",{error:o.message})),a&&a(o)})}const Fs="[data-ave-action]",lr=document.querySelector('meta[name="csrf-token"]'),Wn=lr?lr.content:"";function js(t){t.dataset.actionLoading="true",t.classList.add("is-loading"),t.setAttribute("aria-busy","true"),(t.tagName==="BUTTON"||t.tagName==="INPUT")&&(t.disabled=!0)}function zs(t){t.dataset.actionLoading="false",t.classList.remove("is-loading"),t.removeAttribute("aria-busy"),(t.tagName==="BUTTON"||t.tagName==="INPUT")&&(t.disabled=!1)}function Us(){rl(),document.addEventListener("click",Ks,!0)}function Ks(t){const e=t.target.closest(Fs);if(!e||(t.preventDefault(),e.dataset.actionLoading==="true"))return;const n=e.dataset.aveAction,a=e.dataset.actionEndpoint;if(!a){console.warn("Ave action missing endpoint",e);return}if(n==="bulk"&&pi().length===0){A("warning",m("actions.no_selection"));return}const i=Gs(e.dataset.actionConfig),r=e.dataset.actionConfirmMessage,o=async(s={},l={})=>{js(e);try{await Vs(e,a,s,l)}finally{zs(e)}};if(Array.isArray(i.form)&&i.form.length>0){il(e,i,o);return}if(e.dataset.actionConfirm==="true"){fe({title:i.label||m("actions.confirm"),body:r||m("actions.confirm"),type:"confirm",variant:e.dataset.variant||"primary",confirmText:i.label||m("common.confirm"),onConfirm:()=>o()});return}o()}async function Vs(t,e,n={},a={}){const i=t.dataset.aveAction,r=new FormData,o=t.dataset.actionMethod||"POST",s=t.dataset.actionAccept||"application/json";Wn&&!r.has("_token")&&r.append("_token",Wn),r.append("_action",t.dataset.aveActionKey||""),i==="bulk"&&pi().forEach(d=>r.append("ids[]",d)),i==="form"&&Js(r,t.dataset.actionFormSelector||"#ave-resource-form"),i==="global"&&new URLSearchParams(window.location.search).forEach((f,h)=>{r.append(h,f)}),Zs(r,n);const l=await fetch(e,{method:o,headers:{"X-Requested-With":"XMLHttpRequest",Accept:s,"X-CSRF-TOKEN":Wn},body:r}),c=await Qs(l);if(!l.ok){const d=el(l,c);throw a&&a.modal&&nl(a.modal,c?.errors??{},d),A("danger",d),new Error(d)}if(a&&a.modal&&hi(a.modal),c.modal_form===!0){$s({title:c.title||"Form",fetchUrl:c.fetch_url,saveUrl:c.save_url,size:c.size||"large",onSuccess:d=>{d.reload&&setTimeout(()=>{window.location.reload()},500)}});return}c.message&&A("success",c.message);const u=c.redirect??null;if(u){window.location.href=u;return}c.reload!==!1&&(window.dispatchEvent(new CustomEvent("ave:action:completed",{detail:{type:i,key:t.dataset.aveActionKey,result:c.result??null}})),setTimeout(()=>{window.location.reload()},500))}function Gs(t){if(!t)return{};try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse action config",e),{}}}function Js(t,e){const n=document.querySelector(e);if(!n)return;new FormData(n).forEach((i,r)=>{t.append(r,i)})}function Zs(t,e){!e||typeof e!="object"||Object.entries(e).forEach(([n,a])=>{if(a!=null){if(Array.isArray(a)){a.forEach(i=>t.append(`${n}[]`,i));return}t.append(n,a)}})}async function Qs(t){const e=t.headers.get("content-type");return e&&e.includes("application/json")?t.json():{message:await t.text()}}function el(t,e){return t.status===422&&e?.errors?tl(e.errors):e&&typeof e.message=="string"&&e.message.trim()!==""?e.message:t.statusText||FALLBACK_VALIDATION_MESSAGE}function tl(t){if(!t||typeof t!="object")return FALLBACK_VALIDATION_MESSAGE;const e=Object.values(t).flatMap(a=>Array.isArray(a)?a:[a]).map(a=>(a??"").toString().trim()).filter(a=>a.length>0);if(e.length===0)return FALLBACK_VALIDATION_MESSAGE;const n=e.slice(0,3);return e.length>n.length&&n.push(` +${e.length-n.length} `),n.join(`
`)}function hi(t){const e=t.querySelector("[data-ave-action-form]");e&&(e.querySelectorAll(".form-error").forEach(n=>n.remove()),e.querySelectorAll(".form-group.has-error").forEach(n=>{n.classList.remove("has-error")}))}function nl(t,e={},n=""){const a=t.querySelector("[data-ave-action-form]");if(!a)return;hi(t);const i=Object.entries(e);if(i.length===0){if(n){const o=document.createElement("div");o.className="form-error text-danger small",o.textContent=n,a.prepend(o)}return}i.forEach(([o,s])=>{const l=`[name="${al(o)}"]`,c=a.querySelectorAll(l);if(c.length===0)return;const d=(Array.isArray(s)?s:[s]).map(f=>(f??"").toString().trim()).filter(Boolean).join(" ")||FALLBACK_VALIDATION_MESSAGE;c.forEach(f=>{const h=f.closest(".form-group")||f.parentElement;if(!h)return;h.classList.add("has-error");const g=document.createElement("div");g.className="form-error text-danger small",g.textContent=d,h.appendChild(g)})});const r=a.querySelector(".form-group.has-error input, .form-group.has-error select, .form-group.has-error textarea");r&&r.focus()}function al(t){return window.CSS&&typeof window.CSS.escape=="function"?window.CSS.escape(t):t.replace(/([ !"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\\\$1")}function rl(){const t=document.getElementById("bulk-actions-toolbar"),e=document.getElementById("select-all"),n=Array.from(document.querySelectorAll(".row-selector")),a=document.getElementById("selected-count");if(!t||n.length===0)return;const i=()=>{const r=n.filter(o=>o.checked);if(a&&(a.textContent=r.length),t.classList.toggle("is-visible",r.length>0),e){const o=r.length===n.length;e.checked=o,e.indeterminate=r.length>0&&!o}};e&&e.addEventListener("change",r=>{n.forEach(o=>{o.checked=r.target.checked,Fn(o)}),i()}),n.forEach(r=>{r.addEventListener("change",()=>{Fn(r),i()}),Fn(r)}),i()}function pi(){return Array.from(document.querySelectorAll(".row-selector:checked")).map(t=>t.value)}function Fn(t){const e=t.closest(".resource-row");e&&e.classList.toggle("is-selected",t.checked)}function il(t,e,n){const a=Array.isArray(e.form)?e.form:[],i=fe({title:e.label||m("actions.confirm"),body:ol(a),type:"form",variant:t.dataset.variant||"primary",confirmText:e.label||m("common.confirm"),autoClose:!1,onConfirm:async()=>{const r=i.querySelector("[data-ave-action-form]"),o=sl(r);try{await n(o,{modal:i}),Be(i)}catch(s){console.warn("Ave action failed",s)}},onCancel:()=>Be(i)});return i}function ol(t){return`
        <form data-ave-action-form>
            ${t.map(n=>{const a=n.name||n.key||"";if(!a)return"";const i=n.label||a,r=(n.type||"text").toLowerCase(),o=n.required?"required":"",s=n.placeholder||"",l=n.help?`<small class="help-block">${n.help}</small>`:"";if(r==="textarea")return`
                    <div class="form-group">
                        <label class="control-label">${i}</label>
                        <textarea class="form-control" name="${a}" ${o} placeholder="${s}"></textarea>
                        ${l}
                    </div>
                `;if(r==="select"&&Array.isArray(n.options)){const c=n.options.map(u=>`<option value="${u.value}">${u.label}</option>`).join("");return`
                    <div class="form-group">
                        <label class="control-label">${i}</label>
                        <select class="form-control" name="${a}" ${o}>
                            ${c}
                        </select>
                        ${l}
                    </div>
                `}return r==="checkbox"?`
                    <div class="form-group">
                        <label class="control-label">
                            <input type="checkbox" name="${a}" value="1" />
                            ${i}
                        </label>
                        ${l}
                    </div>
                `:`
                <div class="form-group">
                    <label class="control-label">${i}</label>
                    <input type="${r}" class="form-control" name="${a}" ${o} placeholder="${s}" />
                    ${l}
                </div>
            `}).join("")}
        </form>
    `}function sl(t){if(!t)return{};const e=new FormData(t),n={};return e.forEach((a,i)=>{n[i]!==void 0?(Array.isArray(n[i])||(n[i]=[n[i]]),n[i].push(a)):n[i]=a}),n}const cr=document.querySelector('meta[name="csrf-token"]'),ll=cr?cr.content:"";let dr=!1;function cl(){ur(),window.Ave?.events&&!window.Ave.inlineEditingBound&&(window.Ave.events.on("dom:updated",ur),window.Ave.inlineEditingBound=!0)}function ur(){dr||(document.addEventListener("click",dl,!0),dr=!0)}function dl(t){const e=t.target.closest("[data-ave-inline-toggle]");if(!e||(t.preventDefault(),e.dataset.loading==="true"))return;const n=e.dataset.endpoint,a=e.dataset.field;if(!n||!a){console.warn("Inline toggle missing endpoint or field",e);return}const i=e.dataset.trueValue??"1",r=e.dataset.falseValue??"0",s=(e.dataset.currentValue??r)===String(i)?r:i;fr(e,!0),ul(n,a,s).then(l=>{const c=l.canonical??l.value,u=String(c)===String(i);e.dataset.currentValue=String(c),e.classList.toggle("is-on",u),e.classList.toggle("is-off",!u);const d=e.querySelector(".toggle-dot"),f=u?e.dataset.onColor||"#16a34a":e.dataset.offColor||"#d1d5db";d&&(d.style.backgroundColor=f),A("success",m("inline.saved"))}).catch(l=>{console.error("Inline toggle failed",l),A("danger",l.message||m("inline.error"))}).finally(()=>fr(e,!1))}async function ul(t,e,n){const a=await fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":ll,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({field:e,value:n})});if(!a.ok){const i=await a.json().catch(()=>({}));throw new Error(i.message||m("common.error"))}return a.json()}function fr(t,e){t.dataset.loading=e?"true":"false",t.classList.toggle("is-loading",e),t.setAttribute("aria-busy",e?"true":"false")}function fl(){hl(),pl()}function hl(){document.querySelectorAll(".per-page-select").forEach(e=>{e.addEventListener("change",function(){const n=parseInt(this.value,10);if(!n||n<1)return;const a=new URL(window.location.href);a.searchParams.set("per_page",n.toString()),a.searchParams.delete("page"),window.location.href=a.toString()})})}function pl(){document.querySelectorAll(".pagination-jump-input").forEach(e=>{e.addEventListener("keypress",function(n){n.key==="Enter"&&(n.preventDefault(),ml(this))}),e.addEventListener("blur",function(){const n=da();(this.value===""||parseInt(this.value,10)<1)&&(this.value=n)})})}function ml(t){const e=parseInt(t.value,10),n=parseInt(t.dataset.lastPage,10),a=t.dataset.baseUrl;if(!e||e<1||e>n){t.value=da();return}if(e===da())return;const i=new URL(window.location.href);new URL(a,window.location.origin),e===1?i.searchParams.delete("page"):i.searchParams.set("page",e),window.location.href=i.toString()}function da(){const t=new URLSearchParams(window.location.search);return parseInt(t.get("page")||"1",10)}const hr=document.querySelector('meta[name="csrf-token"]'),gl=hr?hr.content:"";function vl(t=document){t.querySelectorAll('[data-tree="true"]').forEach(e=>{yl(e)})}function yl(t){const e=t.dataset.slug,n=t.dataset.parentColumn,a=t.dataset.orderColumn,i=parseInt(t.dataset.maxDepth||"5"),r=t.dataset.updateEndpoint;bl(t),mi(t,i,e,n,a,r)}function bl(t){const e=document.querySelector(".tree-expand-all"),n=document.querySelector(".tree-collapse-all");e&&e.addEventListener("click",()=>{t.querySelectorAll(".tree-list").forEach(a=>{a.style.display=""}),t.querySelectorAll('[data-action="collapse"]').forEach(a=>{a.classList.remove("hidden")}),t.querySelectorAll('[data-action="expand"]').forEach(a=>{a.classList.add("hidden")})}),n&&n.addEventListener("click",()=>{t.querySelectorAll(".tree-item > .tree-list").forEach(a=>{a.style.display="none"}),t.querySelectorAll('[data-action="collapse"]').forEach(a=>{a.classList.add("hidden")}),t.querySelectorAll('[data-action="expand"]').forEach(a=>{a.classList.remove("hidden")})}),t.querySelectorAll(".dd-item-btns button").forEach(a=>{a.addEventListener("click",i=>{i.preventDefault();const r=a.dataset.action,o=a.closest(".tree-item"),s=o.querySelector(":scope > .tree-list");s&&(r==="collapse"?(s.style.display="none",a.classList.add("hidden"),o.querySelector('[data-action="expand"]')?.classList.remove("hidden")):(s.style.display="",a.classList.add("hidden"),o.querySelector('[data-action="collapse"]')?.classList.remove("hidden")))})})}let pr=new Map;function mi(t,e,n,a,i,r){t.querySelectorAll(".tree-list").forEach(s=>{if(pr.has(s))return;const l=I.create(s,{group:{name:"tree-nested",pull:!0,put:!0},animation:gn.SORTABLE,easing:Ea.SORTABLE,handle:".tree-drag-handle",fallbackOnBody:!0,swapThreshold:5,direction:"vertical",emptyInsertThreshold:1,ghostClass:"sortable-ghost",dragClass:"sortable-drag",onMove:c=>{const u=c.dragged,d=c.to,f=El(d),h=gi(u);if(f+h>e)return!1},onEnd:c=>{wl(t),setTimeout(()=>{mi(t,e,n,a,i,r)},50),Tl(t,n,a,i,r)}});pr.set(s,l)})}function wl(t){t.querySelectorAll(".tree-item").forEach(e=>{const n=e.querySelector(":scope > .tree-list"),a=e.querySelector(".dd-item-btns");if(n&&n.querySelectorAll(":scope > .tree-item").length>0)if(n&&n.classList.remove("tree-list-empty"),a)a.style.display="";else{const r=e.querySelector(".dd-handle");if(r){const o=document.createElement("div");o.className="dd-item-btns",o.innerHTML=`
                        <button type="button" data-action="expand" class="hidden" aria-label="Expand">
                            <i class="voyager-angle-down"></i>
                        </button>
                        <button type="button" data-action="collapse" aria-label="Collapse">
                            <i class="voyager-angle-up"></i>
                        </button>
                    `,r.insertBefore(o,r.querySelector(".dd-content")),o.querySelectorAll("button").forEach(s=>{s.addEventListener("click",l=>{l.preventDefault();const c=s.dataset.action,u=s.closest(".tree-item"),d=u.querySelector(":scope > .tree-list");d&&(c==="collapse"?(d.style.display="none",s.classList.add("hidden"),u.querySelector('[data-action="expand"]')?.classList.remove("hidden")):(d.style.display="",s.classList.add("hidden"),u.querySelector('[data-action="collapse"]')?.classList.remove("hidden")))})})}}else n&&n.classList.add("tree-list-empty"),a&&(a.style.display="none")})}function El(t){let e=0,n=t;for(;n&&!n.matches('[data-tree="true"]');)n.matches(".tree-list")&&e++,n=n.parentElement;return e}function gi(t){let e=1;const n=t.querySelector(":scope > .tree-list");return n&&n.querySelectorAll(":scope > .tree-item").forEach(i=>{const r=gi(i);e=Math.max(e,1+r)}),e}function Sl(t){const e=t.querySelector(":scope > .tree-list");return e?vi(e):[]}function vi(t){const e=[];return t.querySelectorAll(":scope > .tree-item").forEach(a=>{const i=parseInt(a.dataset.id),r=a.querySelector(":scope > .tree-list"),o={id:i};if(r){const s=vi(r);s.length>0&&(o.children=s)}e.push(o)}),e}function Tl(t,e,n,a,i){const r=Sl(t);fetch(i,{method:"POST",headers:{"X-CSRF-TOKEN":gl,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({tree:r,parent_column:n,order_column:a})}).then(o=>o.json()).then(o=>{o.success?A("success",o.message||m("tree.updated")):A("danger",o.message||m("tree.update_failed"))}).catch(o=>{console.error("Tree update error:",o),A("danger",m("tree.structure_update_failed"))})}const mr=document.querySelector('meta[name="csrf-token"]'),xl=mr?mr.content:"";function Al(t=document){t.querySelectorAll('[data-sortable="true"]').forEach(e=>{Cl(e)})}function Cl(t){const e=t.dataset.slug,n=t.dataset.orderColumn||"order",a=t.dataset.updateEndpoint;if(t.sortableInstance)return;const i=I.create(t,{animation:150,handle:".sortable-drag-handle",ghostClass:"sortable-ghost",dragClass:"sortable-drag",onStart:function(r){console.log("Drag started:",r.item)},onEnd:function(r){console.log("Drag ended. Old index:",r.oldIndex,"New index:",r.newIndex),r.oldIndex!==r.newIndex&&Ll(t,e,n,a)}});t.sortableInstance=i}function _l(t,e){const n=t.querySelectorAll("tr[data-id]"),a=[];return n.forEach((i,r)=>{const o=parseInt(i.dataset.id);a.push({id:o,[e]:r})}),a}function Ll(t,e,n,a){const i=_l(t,n);fetch(a,{method:"POST",headers:{"X-CSRF-TOKEN":xl,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({items:i})}).then(r=>r.json()).then(r=>{r.success?A("success",r.message||m("sortable.order_updated")):(A("danger",r.message||m("sortable.order_update_failed")),window.location.reload())}).catch(r=>{console.error("Sortable table update error:",r),A("danger",m("sortable.table_order_failed")),setTimeout(()=>window.location.reload(),1500)})}async function yi(t,e){const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"},body:JSON.stringify(e)});if(!n.ok){const a=await n.json().catch(()=>({}));throw new Error(a.message||"Request failed")}return n.json()}function Dl(){const t=document.querySelectorAll("tbody.group-items-tbody[data-group-id]");t.length!==0&&t.forEach(e=>{const n={slug:e.dataset.slug,groupId:e.dataset.groupId,groupColumn:e.dataset.groupColumn,orderColumn:e.dataset.orderColumn,updateEndpoint:e.dataset.updateEndpoint,groupUpdateEndpoint:e.dataset.groupUpdateEndpoint};I.create(e,{animation:150,handle:".sortable-drag-handle",ghostClass:"sortable-ghost",dragClass:"sortable-drag",group:{name:"shared-groups",pull:!0,put:!0},onEnd:a=>Ml(a,n)})})}function Ml(t,e){const n=t.item.dataset.id,a=t.to,i=t.from,r=a.dataset.groupId,o=i.dataset.groupId;r!==o?Il(n,a,i,r,o,e,t):t.oldIndex!==t.newIndex&&Ol(a,r,e)}function Il(t,e,n,a,i,r,o){kl(t,a,r.groupColumn,r.groupUpdateEndpoint).then(()=>ua(e,a,r.orderColumn,r.updateEndpoint)).then(()=>{if(n.querySelectorAll(".sortable-row").length>0)return ua(n,i,r.orderColumn,r.updateEndpoint)}).then(()=>{A("success",m("sortable.item_moved"))}).catch(s=>{console.error("Error updating groups:",s),A("danger",m("sortable.item_move_error")),n.insertBefore(o.item,n.children[o.oldIndex])})}function Ol(t,e,n){ua(t,e,n.orderColumn,n.updateEndpoint).then(()=>{A("success",m("sortable.order_updated"))}).catch(a=>{console.error("Error saving order:",a),A("danger",m("sortable.order_error"))})}async function kl(t,e,n,a){return yi(a,{item_id:t,group_column:n,group_id:e})}async function ua(t,e,n,a){const i=t.querySelectorAll(".sortable-row"),r={};return i.forEach((o,s)=>{r[o.dataset.id]=s+1}),yi(a,{order:r,order_column:n,group_id:e})}function Nl(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}function Pl(t){t.hasAttribute("required")&&(t.dataset.hadRequired="true",t.removeAttribute("required")),t.hasAttribute("minlength")&&(t.dataset.hadMinlength=t.getAttribute("minlength"),t.removeAttribute("minlength")),t.hasAttribute("maxlength")&&(t.dataset.hadMaxlength=t.getAttribute("maxlength"),t.removeAttribute("maxlength")),t.hasAttribute("pattern")&&(t.dataset.hadPattern=t.getAttribute("pattern"),t.removeAttribute("pattern")),t.hasAttribute("min")&&(t.dataset.hadMin=t.getAttribute("min"),t.removeAttribute("min")),t.hasAttribute("max")&&(t.dataset.hadMax=t.getAttribute("max"),t.removeAttribute("max")),t.hasAttribute("step")&&(t.dataset.hadStep=t.getAttribute("step"),t.removeAttribute("step"))}function ql(){jn(),new MutationObserver(()=>{jn()}).observe(document.documentElement,{attributes:!0,attributeFilter:["style","class"],subtree:!0,characterData:!1}),document.addEventListener("submit",e=>{const n=e.target;n&&n.tagName==="FORM"&&jn(n)})}function jn(t=document){const e=t.querySelectorAll("input[required], input[minlength], input[maxlength], input[pattern], input[min], input[max], input[step], textarea[required], textarea[minlength], textarea[maxlength], textarea[pattern], select[required]");Array.from(e).forEach(n=>{Nl(n)||Pl(n)})}function Rl(){const t=document.querySelector('meta[name="ave-route-prefix"]')?.getAttribute("content")||"admin";document.querySelectorAll('a[href^="#cache-clear-"]').forEach(e=>{e.addEventListener("click",async n=>{n.preventDefault(),n.stopPropagation();const a=e.getAttribute("href").replace("#cache-clear-","");try{const i=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),o=await(await fetch(`/${t}/cache/clear/${a}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":i,Accept:"application/json"}})).json();o.success?A("success",o.message):A("danger",o.message||m("cache.error"))}catch(i){console.error("Cache clear error:",i),A("danger",m("cache.error"))}})})}let Sa="",st={},ce=null;function Bl(){if(!document.getElementById("fm-file-list"))return;const e=document.getElementById("fm-routes");e&&(st={list:e.dataset.list,read:e.dataset.read,save:e.dataset.save,directory:e.dataset.directory,upload:e.dataset.upload,delete:e.dataset.delete,rename:e.dataset.rename});const n=document.getElementById("fm-current-path-input");n&&(Sa=n.value),Hl(),Xl()}function Hl(){document.addEventListener("click",async t=>{const e=t.target.closest(".fm-navigate");if(!e)return;t.preventDefault();const n=e.dataset.fmPath??"";await $l(n)})}function Xl(){document.addEventListener("click",async n=>{const a=n.target.closest(".fm-edit");if(!a)return;n.preventDefault();const i=a.dataset.fmPath;await Yl(i)}),document.addEventListener("click",async n=>{const a=n.target.closest(".fm-delete");if(!a)return;n.preventDefault();const i=a.dataset.fmPath;await Kl(i)}),document.addEventListener("click",n=>{const a=n.target.closest(".fm-rename-btn");if(!a)return;n.preventDefault();const i=a.dataset.fmPath,r=a.dataset.fmName;Gl(i,r)});const t=document.getElementById("fm-upload-btn");t&&t.addEventListener("click",zl);const e=document.getElementById("fm-new-folder-btn");e&&e.addEventListener("click",Fl)}async function $l(t){window.location.href=`${window.location.pathname}?path=${encodeURIComponent(t)}`}async function Yl(t){try{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(`${st.read}?path=${encodeURIComponent(t)}`,{headers:{Accept:"application/json","X-CSRF-TOKEN":e}})).json();if(a.error){A("danger",a.error);return}ce=fe({title:a.name,body:`<div class="form-group">
                <textarea id="fm-editor-content" class="form-control" rows="20" style="font-family: monospace; width: 100%;">${bi(a.content)}</textarea>
            </div>`,type:"form",size:"large",confirmText:m("common.save"),cancelText:m("common.cancel"),autoClose:!1,onConfirm:async i=>{const r=i.querySelector("#fm-editor-content").value;await Wl(t,r)}})}catch(e){console.error("Read error:",e),A("danger",m("file_manager.error"))}}async function Wl(t,e){try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),i=await(await fetch(st.save,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({path:t,content:e})})).json();i.success?(A("success",m("file_manager.file_saved")),ce&&(Be(ce),ce=null)):A("danger",i.error||m("file_manager.error"))}catch(n){console.error("Save error:",n),A("danger",m("file_manager.error"))}}function Fl(){ce=fe({title:m("file_manager.new_folder"),body:`<div class="form-group">
            <label>${m("file_manager.folder_name")}</label>
            <input type="text" class="form-control" id="fm-folder-name" placeholder="${m("file_manager.folder_name_placeholder")}">
        </div>`,type:"form",confirmText:m("common.create"),cancelText:m("common.cancel"),autoClose:!1,onConfirm:async t=>{const e=t.querySelector("#fm-folder-name").value.trim();e&&await jl(e)}})}async function jl(t){try{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(st.directory,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":e},body:JSON.stringify({path:Sa,name:t})})).json();a.success?(A("success",m("file_manager.folder_created")),ce&&(Be(ce),ce=null),window.location.reload()):A("danger",a.error||m("file_manager.error"))}catch(e){console.error("Create folder error:",e),A("danger",m("file_manager.error"))}}function zl(){ce=fe({title:m("file_manager.upload_file"),body:`<div class="form-group">
            <input type="file" class="form-control" id="fm-upload-input">
        </div>`,type:"form",confirmText:m("file_manager.upload"),cancelText:m("common.cancel"),autoClose:!1,onConfirm:async t=>{const e=t.querySelector("#fm-upload-input");e&&e.files.length&&await Ul(e.files[0])}})}async function Ul(t){const e=new FormData;e.append("path",Sa),e.append("file",t);try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),i=await(await fetch(st.upload,{method:"POST",headers:{Accept:"application/json","X-CSRF-TOKEN":n},body:e})).json();i.success?(A("success",m("file_manager.file_uploaded")),ce&&(Be(ce),ce=null),window.location.reload()):A("danger",i.error||m("file_manager.error"))}catch(n){console.error("Upload error:",n),A("danger",m("file_manager.error"))}}async function Kl(t){ce=fe({title:m("modals.delete_confirm"),body:m("file_manager.confirm_delete"),type:"confirm",variant:"warning",confirmText:m("common.delete"),cancelText:m("common.cancel"),onConfirm:async()=>{await Vl(t)}})}async function Vl(t){try{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),a=await(await fetch(st.delete,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":e},body:JSON.stringify({path:t})})).json();a.success?(A("success",m("file_manager.deleted")),window.location.reload()):A("danger",a.error||m("file_manager.error"))}catch(e){console.error("Delete error:",e),A("danger",m("file_manager.error"))}}function Gl(t,e){ce=fe({title:m("file_manager.rename"),body:`<div class="form-group">
            <label>${m("file_manager.new_name")}</label>
            <input type="text" class="form-control" id="fm-rename-input" value="${bi(e)}">
        </div>`,type:"form",confirmText:m("common.save"),cancelText:m("common.cancel"),autoClose:!1,onConfirm:async n=>{const a=n.querySelector("#fm-rename-input").value.trim();a&&await Jl(t,a)}})}async function Jl(t,e){try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),i=await(await fetch(st.rename,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({path:t,name:e})})).json();i.success?(A("success",m("file_manager.renamed")),ce&&(Be(ce),ce=null),window.location.reload()):A("danger",i.error||m("file_manager.error"))}catch(n){console.error("Rename error:",n),A("danger",m("file_manager.error"))}}function bi(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}function Zl(){const t=document.getElementById("ave-storage-link-data");if(t)try{const e=JSON.parse(t.textContent);e.missing&&Ql(e)}catch(e){console.error("Failed to parse storage link data:",e)}}function Ql(t){fe({title:t.title,body:t.message,type:"alert",variant:"warning",confirmText:t.createButton,size:"small",autoClose:!1,onConfirm:async e=>{const n=e.querySelector("[data-modal-confirm]");n&&(n.disabled=!0,n.textContent="...");try{const i=await(await fetch(t.createUrl,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json"}})).json();i.success?(A("success",i.message),e.classList.remove("is-active"),setTimeout(()=>e.remove(),300)):(A("error",i.message),n&&(n.disabled=!1,n.textContent=t.createButton))}catch(a){console.error("Failed to create storage link:",a),A("error","Failed to create storage link"),n&&(n.disabled=!1,n.textContent=t.createButton)}}})}class wi{constructor(e={}){this.subscribers=new Map,this.computedCache=new Map,this.computedDeps=new Map,this.state=this.createReactive(e,[])}createReactive(e,n=[]){return this.isObject(e)?Array.isArray(e)?this.createReactiveArray(e,n):new Proxy(e,{get:(a,i)=>{this.trackDependency(n.concat(i));const r=a[i];return this.isObject(r)?this.createReactive(r,n.concat(i)):r},set:(a,i,r)=>(a[i]===r||(a[i]=r,this.notify(n.concat(i))),!0),deleteProperty:(a,i)=>(i in a&&(delete a[i],this.notify(n.concat(i))),!0)}):e}createReactiveArray(e,n){const a=this,i=["push","pop","shift","unshift","splice","sort","reverse"];return new Proxy(e,{get(o,s){if(a.trackDependency(n.concat(s)),i.includes(s))return function(...c){const u=Array.prototype[s].apply(o,c);return a.notify(n),u};const l=o[s];return a.isObject(l)?a.createReactive(l,n.concat(s)):l},set(o,s,l){return o[s]===l||(o[s]=l,a.notify(n.concat(s))),!0},deleteProperty(o,s){return s in o&&(delete o[s],a.notify(n)),!0}})}watch(e,n=null){typeof e=="function"&&(n=e,e=[]);const a=Array.isArray(e)?e:e.split("."),i=this.pathToKey(a);return this.subscribers.has(i)||this.subscribers.set(i,new Set),this.subscribers.get(i).add(n),()=>{const r=this.subscribers.get(i);r&&r.delete(n)}}computed(e){const n=Symbol("computed");return()=>{if(this.computedCache.has(n))return this.computedCache.get(n);this.currentComputed=n;const a=e();return this.currentComputed=null,this.computedCache.set(n,a),a}}trackDependency(e){this.currentComputed&&(this.computedDeps.has(this.currentComputed)||this.computedDeps.set(this.currentComputed,new Set),this.computedDeps.get(this.currentComputed).add(this.pathToKey(e)))}notify(e){const n=this.pathToKey(e),a=this.subscribers.get(n);a&&a.forEach(r=>r(this.getByPath(e),e));for(let r=e.length-1;r>=0;r--){const o=e.slice(0,r),s=this.pathToKey(o),l=this.subscribers.get(s);l&&l.forEach(c=>c(this.getByPath(o),o))}const i=this.subscribers.get("");i&&i.forEach(r=>r(this.state,[])),this.invalidateComputed(n)}invalidateComputed(e){this.computedDeps.forEach((n,a)=>{n.has(e)&&this.computedCache.delete(a)})}getByPath(e){return e.reduce((n,a)=>n?.[a],this.state)}setByPath(e,n){if(e.length===0){this.state=this.createReactive(n,[]);return}const a=e[e.length-1],i=e.slice(0,-1).reduce((r,o)=>r[o],this.state);i&&(i[a]=n)}pathToKey(e){return Array.isArray(e)?e.join("."):e}isObject(e){return e!==null&&(typeof e=="object"||Array.isArray(e))}batch(e){this.batching=!0,this.batchedPaths=new Set,e(),this.batching=!1,this.batchedPaths.forEach(n=>{this.notify(n.split("."))}),this.batchedPaths.clear()}}class Ta{static create(e,n={},...a){const i=document.createElement(e);return Object.keys(n).forEach(r=>{if(r==="className")i.className=n[r];else if(r==="style"&&typeof n[r]=="object")Object.assign(i.style,n[r]);else if(r.startsWith("on")&&typeof n[r]=="function"){const o=r.substring(2).toLowerCase();i.addEventListener(o,n[r])}else r==="dataset"&&typeof n[r]=="object"?Object.assign(i.dataset,n[r]):i.setAttribute(r,n[r])}),a.flat(1/0).forEach(r=>{r!=null&&r!==!1&&(typeof r=="string"||typeof r=="number"?i.appendChild(document.createTextNode(r)):i.appendChild(r))}),i}static render(e,n){if(typeof e=="string"&&(e=document.querySelector(e)),!e){console.error("Container not found");return}e.innerHTML="",Array.isArray(n)?n.forEach(a=>e.appendChild(a)):e.appendChild(n)}static update(e,n){if(e.tagName!==n.tagName){e.replaceWith(n);return}Array.from(e.attributes).forEach(r=>{n.hasAttribute(r.name)||e.removeAttribute(r.name)}),Array.from(n.attributes).forEach(r=>{e.setAttribute(r.name,r.value)});const a=Array.from(e.childNodes),i=Array.from(n.childNodes);a.slice(i.length).forEach(r=>r.remove()),i.forEach((r,o)=>{if(o>=a.length)e.appendChild(r.cloneNode(!0));else{const s=a[o];s.nodeType===Node.TEXT_NODE&&r.nodeType===Node.TEXT_NODE?s.textContent!==r.textContent&&(s.textContent=r.textContent):s.nodeType===Node.ELEMENT_NODE&&r.nodeType===Node.ELEMENT_NODE?Ta.update(s,r):s.replaceWith(r.cloneNode(!0))}})}}window.Reactive=wi;window.DOM=Ta;class ec{constructor(e){this.config=e,this.translations=e.translations;const n=e.oldTable||e.table;this.emptyIndex={type:"",name:"",columns:[]},this.state=new wi({table:n,errors:{},isDirty:!1}),this.structuralChangesOnly=!1,this.state.watch("table",()=>{this.structuralChangesOnly||(this.state.state.isDirty=!0,this.validateTable(),this.render())}),window.dbConfig.table=this.state.state.table,this.init()}init(){this.render(),this.attachEventListeners(),this.validateTable()}attachEventListeners(){const e=document.getElementById("table-name");e&&e.addEventListener("input",n=>{this.structuralChangesOnly=!0,this.state.state.table.name=n.target.value,this.structuralChangesOnly=!1}),document.getElementById("btn-add-column")?.addEventListener("click",()=>{this.addColumn()}),document.getElementById("btn-add-timestamps")?.addEventListener("click",()=>{this.addTimestamps()}),document.getElementById("btn-add-softdeletes")?.addEventListener("click",()=>{this.addSoftDeletes()}),document.getElementById("database-form")?.addEventListener("submit",n=>{if(!this.validateTable())return n.preventDefault(),toastr.error("Please fix validation errors before saving"),!1;const a=JSON.stringify(this.state.state.table);document.getElementById("table-data").value=a,window.dbConfig.table=this.state.state.table})}render(){const e=document.getElementById("columns-container"),n=document.getElementById("columns-table"),a=document.getElementById("no-columns-message");if(!e)return;const i=this.state.state.table.columns||[];if(i.length===0){a.style.display="block",n&&(n.style.display="none");return}a.style.display="none",n&&(n.style.display="table"),e.innerHTML="",i.forEach((r,o)=>{const s=this.renderColumn(r,o);e.appendChild(s)})}renderColumn(e,n){const a=document.createElement("tr");a.dataset.index=n,a.className="dbm-row";const i=this.state.state.errors[`columns.${n}`]||{};Object.keys(i).length>0&&a.classList.add("has-error");const r=this.renderTextInput(e.name||"",o=>this.updateColumn(n,"name",o),{required:!0,pattern:this.config.identifierRegex,maxlength:"63"});if(e.composite){const o=document.createElement("div");o.className="dbm-index-warning",o.innerHTML=`<i class="voyager-warning"></i> ${this.translations.compositeWarning}`,r.appendChild(o)}return a.appendChild(r),a.appendChild(this.renderTypeSelect(e,n)),a.appendChild(this.renderTextInput(e.length??"",o=>this.updateColumn(n,"length",o&&parseInt(o,10)||null),{type:"number",min:"1"})),a.appendChild(this.renderCheckbox(!!e.notnull,o=>this.updateColumn(n,"notnull",o))),a.appendChild(this.renderCheckbox(!!e.unsigned,o=>this.updateColumn(n,"unsigned",o))),a.appendChild(this.renderCheckbox(!!e.autoincrement,o=>this.updateColumn(n,"autoincrement",o))),a.appendChild(this.createIndexSelectSimple(e,n)),a.appendChild(this.renderTextInput(e.default??"",o=>this.updateColumn(n,"default",o))),a.appendChild(this.renderRemoveButton(n)),a}renderTextInput(e,n,a={}){const i=a.type||"text",r=Object.entries(a).filter(([s])=>s!=="type").map(([s,l])=>`${s}="${l}"`).join(" "),o=document.createElement("td");return o.innerHTML=`<input class="form-control" type="${i}" value="${e??""}" ${r}>`,o.querySelector("input").addEventListener("input",s=>n(s.target.value)),o}renderCheckbox(e,n){const a=document.createElement("td");a.className="checkbox-column";const i=`checkbox-${Math.random().toString(36).substr(2,9)}`;return a.innerHTML=`
            <label class="checkbox-label checkbox-label--compact" for="${i}">
                <input type="checkbox" id="${i}" class="checkbox-input" ${e?"checked":""}>
                <span class="checkbox-custom checkbox-custom--sm"></span>
            </label>
        `,a.querySelector("input").addEventListener("change",r=>n(r.target.checked)),a}renderTypeSelect(e,n){const a=document.createElement("td"),i=document.createElement("select");i.className="form-control";const r=typeof e.type=="object"?e.type.name:e.type;return Object.entries(this.config.types||{}).forEach(([o,s])=>{const l=document.createElement("optgroup");l.label=o,s.forEach(c=>{const u=document.createElement("option");u.value=c.name,u.textContent=c.name,u.selected=r===c.name,c.supported||(u.disabled=!0,u.textContent+=` (${this.translations.typeNotSupported})`),l.appendChild(u)}),i.appendChild(l)}),i.addEventListener("change",o=>this.updateColumn(n,"type",o.target.value)),a.appendChild(i),a}createIndexSelectSimple(e,n){const a=typeof e.type=="object"?e.type.name:e.type,i=this.getTypeSupportsIndex(a),r=this.getColumnsIndex(e.name),o=r!==this.emptyIndex?r.type.toLowerCase():"",s=[{value:"",label:""},{value:"index",label:"INDEX"},{value:"unique",label:"UNIQUE"},{value:"primary",label:"PRIMARY"}];return this.createSelect(s,o,l=>this.updateColumnIndex(n,l.target.value),!i)}renderRemoveButton(e){const n=document.createElement("td"),a=document.createElement("div");return a.className="btn btn-danger btn-sm btn-square delete-row",a.innerHTML='<i class="voyager-trash"></i>',a.addEventListener("click",()=>this.removeColumn(e)),n.appendChild(a),n}getColumnsIndex(e){const n=Array.isArray(e)?e:[e],a=this.state.state.table.indexes||[];for(let i=0;i<a.length;i++){const r=a[i].columns||[];if(r.length===n.length&&r.every(o=>n.includes(o)))return a[i]}return this.emptyIndex}getTypeSupportsIndex(e){for(const n in this.config.types){const a=this.config.types[n].find(i=>i.name===e);if(a)return!a.notSupportIndex}return!0}createSelect(e,n,a,i=!1){const r=document.createElement("td"),o=document.createElement("select");return o.className="form-control",o.disabled=i,e.forEach(s=>{const l=document.createElement("option");l.value=s.value,l.textContent=s.label,l.selected=s.value===n,s.disabled&&(l.disabled=!0),o.appendChild(l)}),o.addEventListener("change",a),r.appendChild(o),r}updateColumnIndex(e,n){const i=this.state.state.table.columns[e],r=i.name,o=n?n.toUpperCase():"";this.state.state.table.indexes||(this.state.state.table.indexes=[]);const s=this.state.state.table.indexes.find(l=>l.columns&&l.columns.length===1&&l.columns[0]===r);if(!o||o===""){if(s){const l=this.state.state.table.indexes.findIndex(c=>c.columns&&c.columns.length===1&&c.columns[0]===r);l!==-1&&this.state.state.table.indexes.splice(l,1)}i.index=null}else if(s)s.type=o,s.name=o==="PRIMARY"?"primary":"",i.index=o;else{const l=o==="PRIMARY"?"primary":"";this.state.state.table.indexes.push({name:l,type:o,columns:[r]}),i.index=o}this.state.notify(["table","columns",e,"index"])}addColumn(){const e=this.state.state.table.columns||[],n={name:`column_${e.length+1}`,type:"string",length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null};e.push(n),this.state.notify(["table","columns"])}removeColumn(e){this.state.state.table.columns.splice(e,1),this.state.notify(["table","columns"])}addTimestamps(){const e=this.state.state.table.columns||[],n=e.some(i=>i.name==="created_at"),a=e.some(i=>i.name==="updated_at");if(n&&a){toastr.info("Timestamps already exist");return}n||e.push({name:"created_at",type:{name:"datetime",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null}),a||e.push({name:"updated_at",type:{name:"datetime",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null}),this.state.notify(["table","columns"]),toastr.success("Timestamps added")}addSoftDeletes(){const e=this.state.state.table.columns||[];if(e.some(a=>a.name==="deleted_at")){toastr.info("Soft deletes already exist");return}e.push({name:"deleted_at",type:{name:"datetime",notSupported:!1,notSupportIndex:!1},length:null,default:null,notnull:!1,unsigned:!1,autoincrement:!1,index:null}),this.state.notify(["table","columns"]),toastr.success("Soft deletes added")}updateColumn(e,n,a){const i=this.state.state.table.columns;if(i[e]){if(n==="index"){this.updateColumnIndex(e,a);return}this.structuralChangesOnly=!0,i[e][n]=a,this.state.state.isDirty=!0,this.structuralChangesOnly=!1,n==="type"&&(!this.getTypeSupportsIndex(a)&&i[e].index&&this.updateColumnIndex(e,""),this.state.notify(["table","columns"])),this.validateTable(),window.dbConfig.table=this.state.state.table}}updateRowErrors(){const e=document.getElementById("columns-container");if(!e)return;e.querySelectorAll(".dbm-row").forEach((a,i)=>{const r=this.state.state.errors[`columns.${i}`]||{};Object.keys(r).length>0?a.classList.add("has-error"):a.classList.remove("has-error")})}validateTable(){const e={},n=this.state.state.table.columns||[],a={};n.forEach((r,o)=>{(!r.name||r.name.trim()==="")&&(e[`columns.${o}`]=e[`columns.${o}`]||{},e[`columns.${o}`].name=this.translations.nameWarning),a[r.name]&&(e[`columns.${o}`]=e[`columns.${o}`]||{},e[`columns.${o}`].duplicate=this.translations.columnAlreadyExists.replace(":column",r.name)),a[r.name]=!0});const i=n.filter(r=>r.index==="primary");return i.length>1&&i.forEach((r,o)=>{if(o>0){const s=n.indexOf(r);e[`columns.${s}`]=e[`columns.${s}`]||{},e[`columns.${s}`].primary=this.translations.tableHasIndex}}),this.structuralChangesOnly=!0,this.state.state.errors=e,this.structuralChangesOnly=!1,this.updateRowErrors(),Object.keys(e).length===0}}document.addEventListener("DOMContentLoaded",()=>{window.dbConfig&&(window.dbEditor=new ec(window.dbConfig))});window.aveEvents=xe;window.Ave=window.Ave||{};window.Ave.events=xe;document.addEventListener("DOMContentLoaded",()=>{ql(),xs(),Xi(),$i(),Hs(),Os(),Xs(),Us(),cl(),fl(),Dl(),vl(),Al(),Rl(),Bl(),Zl(),xe.emit("dom:updated",document);const t={confirm:Xt,createModal:fe,closeModal:ke,destroyModal:Be};xe.emit("ave:loaded",t),window.Ave=window.Ave||{},Object.assign(window.Ave,t)});window.addEventListener("load",()=>{const t=document.getElementById("ave-loader");t&&setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.style.display="none"},300)},200)});
